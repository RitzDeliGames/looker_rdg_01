#https://gist.github.com/adamawolf/3048717
constant: device_model_mapping {
  value: "CASE
          when ${TABLE}.hardware = 'iPhone6,1' THEN 'iPhone 5S'
          when ${TABLE}.hardware = 'iPhone6,2' THEN 'iPhone 5S'
          when ${TABLE}.hardware = 'iPhone7,1' THEN 'iPhone 6 Plus'
          when ${TABLE}.hardware = 'iPhone7,2' THEN 'iPhone 6'
          when ${TABLE}.hardware = 'iPhone8,1' THEN 'iPhone 6s'
          when ${TABLE}.hardware = 'iPhone8,2' THEN 'iPhone 6s Plus'
          when ${TABLE}.hardware = 'iPhone8,4' THEN 'iPhone SE'
          when ${TABLE}.hardware = 'iPhone9,1' THEN 'iPhone 7'
          when ${TABLE}.hardware = 'iPhone9,2' THEN 'iPhone 7 Plus'
          when ${TABLE}.hardware = 'iPhone9,3' THEN 'iPhone 7'
          when ${TABLE}.hardware = 'iPhone9,4' THEN 'iPhone 7 Plus'
          when ${TABLE}.hardware = 'iPhone10,1' THEN 'iPhone 8'
          when ${TABLE}.hardware = 'iPhone10,2' THEN 'iPhone 8 Plus'
          when ${TABLE}.hardware = 'iPhone10,3' THEN 'iPhone X'
          when ${TABLE}.hardware = 'iPhone10,4' THEN 'iPhone 8'
          when ${TABLE}.hardware = 'iPhone10,5' THEN 'iPhone 8 Plus'
          when ${TABLE}.hardware = 'iPhone10,6' THEN 'iPhone X'
          when ${TABLE}.hardware = 'iPhone11,2' THEN 'iPhone XS'
          when ${TABLE}.hardware = 'iPhone11,4' THEN 'iPhone XS Max'
          when ${TABLE}.hardware = 'iPhone11,6' THEN 'iPhone XS Max'
          when ${TABLE}.hardware = 'iPhone11,8' THEN 'iPhone XR'
          when ${TABLE}.hardware = 'iPhone12,1' THEN 'iPhone 11'
          when ${TABLE}.hardware = 'iPhone12,3' THEN 'iPhone 11 Pro'
          when ${TABLE}.hardware = 'iPhone12,5' THEN 'iPhone 11 Pro Max'
          when ${TABLE}.hardware = 'iPhone12,8' THEN 'iPhone SE - 2nd Gen'
          when ${TABLE}.hardware = 'iPad4,1' THEN 'iPad Air - 1st Gen'
          when ${TABLE}.hardware = 'iPad5,3' THEN 'iPad Air - 2nd Gen'
          when ${TABLE}.hardware = 'iPad11,3' THEN 'iPad Air - 3rd Gen'
          when ${TABLE}.hardware = 'iPad6,3' THEN 'iPad Pro'
          when ${TABLE}.hardware = 'iPad6,7' THEN 'iPad Pro'
          when ${TABLE}.hardware = 'iPad7,3' THEN 'iPad Pro - 3rd Gen'
          when ${TABLE}.hardware = 'iPad8,11' THEN 'iPad Pro - 4th Gen'
          when ${TABLE}.hardware = 'iPad6,11' THEN 'iPad - 5th Gen'
          when ${TABLE}.hardware = 'iPad7,5' THEN 'iPad - 6th Gen'
          when ${TABLE}.hardware = 'iPad7,11' THEN 'iPad - 7th Gen'
          when ${TABLE}.hardware = 'iPad5,1' THEN 'iPad Mini - 4th Gen'
          ELSE ${TABLE}.hardware
        END"
}

constant: device_manufacturer_mapping{
  value: "case
            when ${TABLE}.hardware like '%iPhone%' THEN 'Apple'
            when ${TABLE}.hardware like '%iPad%' THEN 'Apple'
            when ${TABLE}.hardware like '%Pixel%' THEN 'Google'
            when ${TABLE}.hardware like '%samsung%' THEN 'Samsung'
            when ${TABLE}.hardware like '%LG%' THEN 'LG'
            when ${TABLE}.hardware like '%moto%' THEN 'Motorola'
            when ${TABLE}.hardware like '%Huawei%' THEN 'Huawei'
            when ${TABLE}.hardware like '%HUAWEI%' THEN 'Huawei'
            when ${TABLE}.hardware like '%Lenovo%' THEN 'Lenovo'
            when ${TABLE}.hardware like '%Xiaomi%' THEN 'Xiaomi'
            when ${TABLE}.hardware like '%ZTE%' THEN 'ZTE'
            when ${TABLE}.hardware like '%zte%' THEN 'ZTE'
            when ${TABLE}.hardware like '%ZUUM%' THEN 'ZUUM'
            when ${TABLE}.hardware like '%Asus%' THEN 'Asus'
            when ${TABLE}.hardware like '%asus%' THEN 'Asus'
            when ${TABLE}.hardware like '%Acer%' THEN 'Acer'
            when ${TABLE}.hardware like '%Sony%' THEN 'Sony'
            when ${TABLE}.hardware like '%Amazon%' THEN 'Amazon Shit Device'
            when ${TABLE}.hardware like '%TCL%' THEN 'TCL'
            when ${TABLE}.hardware like '%onn%' THEN 'OnePlus'
            when ${TABLE}.hardware like '%OnePlus%' THEN 'OnePlus'
            when ${TABLE}.hardware like '%OPPO%' THEN 'OPPO'
            when ${TABLE}.hardware like '%Alco%' THEN 'Alco'
            when ${TABLE}.hardware like '%BLU%' THEN 'BLU'
            when ${TABLE}.hardware like '%HMD%' THEN 'Nokia'
            when ${TABLE}.hardware like '%Nokia%' THEN 'Nokia'
            when ${TABLE}.hardware like '%Hisense%' THEN 'Hisense'
            when ${TABLE}.hardware like '%HTC%' THEN 'HTC'
            else ${TABLE}.hardware
          end"
}

constant: device_os_version_mapping {
  value: "CASE
          when ${TABLE}.platform like '%iOS 16%' THEN 'iOS 16'
          when ${TABLE}.platform like '%iOS 15%' THEN 'iOS 15'
          when ${TABLE}.platform like '%iOS 14%' THEN 'iOS 14'
          when ${TABLE}.platform like '%iOS 13%' THEN 'iOS 13'
          when ${TABLE}.platform like '%iOS 12%' THEN 'iOS 12'
          when ${TABLE}.platform like '%iOS 11%' THEN 'iOS 11'
          when ${TABLE}.platform like '%iOS 10%' THEN 'iOS 10'
          when ${TABLE}.platform like '%Android OS 12%' THEN 'Android 12'
          when ${TABLE}.platform like '%Android OS 11%' THEN 'Android 11'
          when ${TABLE}.platform like '%Android OS 10%' THEN 'Android 10'
          when ${TABLE}.platform like '%Android OS 9%' THEN 'Android 9'
          when ${TABLE}.platform like '%Android OS 8%' THEN 'Android 8'
          when ${TABLE}.platform like '%Android OS 7%' THEN 'Android 7'
          when ${TABLE}.platform like '%Android OS 6%' THEN 'Android 6'
          when ${TABLE}.platform like '%Android OS 5%' THEN 'Android 5'
          when ${TABLE}.platform like '%Android OS 4%' THEN 'Android 4'
        END"
  }

constant: device_platform_mapping {
  value: "case
            when ${TABLE}.platform like '%iOS%' then 'Apple'
            when ${TABLE}.platform like '%Android%' then 'Google'
            else 'Other'
          end"

}

constant: device_platform_mapping_os {
  value: "case
  when ${TABLE}.platform like '%iOS%' then 'iOS'
  when ${TABLE}.platform like '%Android%' then 'Android'
  else 'Other'
  end"

}

constant: release_version_minor {
  value: "case
            when ${TABLE}.version = '1579' then'1.0.100'
            when ${TABLE}.version = '2047' then'1.1.001'
            when ${TABLE}.version = '2100' then'1.1.100'
            when ${TABLE}.version = '3028' then'1.2.028'
            when ${TABLE}.version = '3043' then'1.2.043'
            when ${TABLE}.version = '3100' then'1.2.100'
            when ${TABLE}.version = '4017' then'1.3.017'
            when ${TABLE}.version = '4100' then'1.3.100'
            when ${TABLE}.version = '5006' then'1.5.006'
            when ${TABLE}.version = '5100' then'1.5.100'
            when ${TABLE}.version = '6100' then'1.6.100'
            when ${TABLE}.version = '6200' then'1.6.200'
            when ${TABLE}.version = '6300' then'1.6.300'
            when ${TABLE}.version = '6400' then'1.6.400'
            when ${TABLE}.version = '7100' then'1.7.100'
            when ${TABLE}.version = '7200' then'1.7.200'
            when ${TABLE}.version = '7300' then'1.7.300'
            when ${TABLE}.version = '7400' then'1.7.400'
            when ${TABLE}.version = '7500' then'1.7.500'
            when ${TABLE}.version = '7600' then'1.7.600'
            when ${TABLE}.version = '8000' then'1.8.000'
            when ${TABLE}.version = '8100' then'1.8.100'
            when ${TABLE}.version = '8200' then'1.8.200'
            when ${TABLE}.version = '8300' then'1.8.300'
            when ${TABLE}.version = '8400' then'1.8.400'
            when ${TABLE}.version = '9100' then'1.9.100'
            when ${TABLE}.version = '9200' then'1.9.200'
            when ${TABLE}.version = '9300' then'1.9.300'
            when ${TABLE}.version = '9400' then'1.9.400'
            when ${TABLE}.version = '9500' then'1.9.500'
            when ${TABLE}.version = '10100' then'1.10.100'
            when ${TABLE}.version = '10200' then'1.10.200'
            when ${TABLE}.version = '10300' then'1.10.300'
            when ${TABLE}.version = '10400' then'1.10.400'
            when ${TABLE}.version = '10500' then'1.10.500'
            when ${TABLE}.version = '10600' then'1.10.600'
            when ${TABLE}.version = '10800' then'1.10.800'
            when ${TABLE}.version = '10900' then'1.10.900'
            when ${TABLE}.version = '10950' then'1.10.950'
            when ${TABLE}.version = '11100' then'1.11.100'
            when ${TABLE}.version = '11200' then'1.11.200'
            when ${TABLE}.version = '11300' then'1.11.300'
            when ${TABLE}.version = '11400' then'1.11.400'
            when ${TABLE}.version = '11500' then'1.11.500'
            when ${TABLE}.version = '11600' then'1.11.600'
            when ${TABLE}.version = '11800' then'1.11.800'
            when ${TABLE}.version = '11860' then'1.11.860'
            when ${TABLE}.version = '11870' then'1.11.870'
            when ${TABLE}.version = '12200' then'1.12.200'
            when ${TABLE}.version = '12300' then'1.12.300'
            when ${TABLE}.version = '12400' then'1.12.400'
            when ${TABLE}.version = '12500' then'1.12.500'
            when ${TABLE}.version = '12700' then'1.12.700'
            when ${TABLE}.version = '12840' then'1.12.840'
            when ${TABLE}.version = '12850' then'1.12.850'
            when ${TABLE}.version = '12870' then'1.12.870'
            when ${TABLE}.version = '12906' then'1.12.906'
            when ${TABLE}.version = '12911' then'1.12.911'
            when ${TABLE}.version = '12920' then'1.12.920'
            when ${TABLE}.version = '12934' then'1.12.934'
            when ${TABLE}.version = '12940' then'1.12.940'
            when ${TABLE}.version = '12952' then'1.12.952'
            when ${TABLE}.version = '12956' then'1.12.956'
            when ${TABLE}.version = '12961' then'1.12.961'
            when ${TABLE}.version = '12971' then'1.12.971'
            when ${TABLE}.version = '13002' then'1.13.002'
            when ${TABLE}.version = '13012' then'1.13.012'
            when ${TABLE}.version = '13021' then'1.13.021'
            when ${TABLE}.version = '13030' then'1.13.030'
            when ${TABLE}.version = '13031' then'1.13.031'
            when ${TABLE}.version = '13044' then'1.13.044'
            when ${TABLE}.version = '13050' then'1.13.050'
            when ${TABLE}.version = '13052' then'1.13.052'
            when ${TABLE}.version = '13053' then'1.13.053'
            when ${TABLE}.version = '13075' then'1.13.075'
            when ${TABLE}.version = '13083' then'1.13.083'
            when ${TABLE}.version = '13084' then'1.13.084'
            when ${TABLE}.version = '13092' then'1.13.092'
            when ${TABLE}.version = '13093' then'1.13.093'
            when ${TABLE}.version = '13101' then'1.13.101'
            when ${TABLE}.version = '13114' then'1.13.114'
            when ${TABLE}.version = '13115' then'1.13.115'
            when ${TABLE}.version = '13116' then'1.13.116'
            when ${TABLE}.version = '13117' then'1.13.117'
            when ${TABLE}.version = '13131' then'1.13.131'
            else ''
          end"
}

constant: install_release_version_minor {
  value: "case
            when coalesce(${TABLE}.install_version,${TABLE}.version) = '1579' then'1.0.100'
            when coalesce(${TABLE}.install_version,${TABLE}.version) = '2047' then'1.1.001'
            when coalesce(${TABLE}.install_version,${TABLE}.version) = '2100' then'1.1.100'
            when coalesce(${TABLE}.install_version,${TABLE}.version) = '3028' then'1.2.028'
            when coalesce(${TABLE}.install_version,${TABLE}.version) = '3043' then'1.2.043'
            when coalesce(${TABLE}.install_version,${TABLE}.version) = '3100' then'1.2.100'
            when coalesce(${TABLE}.install_version,${TABLE}.version) = '4017' then'1.3.017'
            when coalesce(${TABLE}.install_version,${TABLE}.version) = '4100' then'1.3.100'
            when ${TABLE}.install_version = '5006' then'1.5.006'
            when ${TABLE}.install_version = '5100' then'1.5.100'
            when ${TABLE}.install_version = '6100' then'1.6.100'
            when ${TABLE}.install_version = '6200' then'1.6.200'
            when ${TABLE}.install_version = '6300' then'1.6.300'
            when ${TABLE}.install_version = '6400' then'1.6.400'
            when ${TABLE}.install_version = '7100' then'1.7.100'
            when ${TABLE}.install_version = '7200' then'1.7.200'
            when ${TABLE}.install_version = '7300' then'1.7.300'
            when ${TABLE}.install_version = '7400' then'1.7.400'
            when ${TABLE}.install_version = '7500' then'1.7.500'
            when ${TABLE}.install_version = '7600' then'1.7.600'
            when ${TABLE}.install_version = '8000' then'1.8.000'
            when ${TABLE}.install_version = '8100' then'1.8.100'
            when ${TABLE}.install_version = '8200' then'1.8.200'
            when ${TABLE}.install_version = '8300' then'1.8.300'
            when ${TABLE}.install_version = '8400' then'1.8.400'
            when ${TABLE}.install_version = '9100' then'1.9.100'
            when ${TABLE}.install_version = '9200' then'1.9.200'
            when ${TABLE}.install_version = '9300' then'1.9.300'
            when ${TABLE}.install_version = '9400' then'1.9.400'
            when ${TABLE}.install_version = '9500' then'1.9.500'
            when ${TABLE}.install_version = '10100' then'1.10.100'
            when ${TABLE}.install_version = '10200' then'1.10.200'
            when ${TABLE}.install_version = '10300' then'1.10.300'
            when ${TABLE}.install_version = '10400' then'1.10.400'
            when ${TABLE}.install_version = '10500' then'1.10.500'
            when ${TABLE}.install_version = '10600' then'1.10.600'
            when ${TABLE}.install_version = '10800' then'1.10.800'
            when ${TABLE}.install_version = '10900' then'1.10.900'
            when ${TABLE}.install_version = '10950' then'1.10.950'
            when ${TABLE}.install_version = '11100' then'1.11.100'
            when ${TABLE}.install_version = '11200' then'1.11.200'
            when ${TABLE}.install_version = '11300' then'1.11.300'
            when ${TABLE}.install_version = '11400' then'1.11.400'
            when ${TABLE}.install_version = '11500' then'1.11.500'
            when ${TABLE}.install_version = '11600' then'1.11.600'
            when ${TABLE}.install_version = '11800' then'1.11.800'
            when ${TABLE}.install_version = '11860' then'1.11.860'
            when ${TABLE}.install_version = '11870' then'1.11.870'
            when ${TABLE}.install_version = '12200' then'1.12.200'
            when ${TABLE}.install_version = '12300' then'1.12.300'
            when ${TABLE}.install_version = '12400' then'1.12.400'
            when ${TABLE}.install_version = '12500' then'1.12.500'
            when ${TABLE}.install_version = '12700' then'1.12.700'
            when ${TABLE}.install_version = '12840' then'1.12.840'
            when ${TABLE}.install_version = '12850' then'1.12.850'
            when ${TABLE}.install_version = '12870' then'1.12.870'
            when ${TABLE}.install_version = '12906' then'1.12.906'
            when ${TABLE}.install_version = '12911' then'1.12.911'
            when ${TABLE}.install_version = '12920' then'1.12.920'
            when ${TABLE}.install_version = '12934' then'1.12.934'
            when ${TABLE}.install_version = '12940' then'1.12.940'
            when ${TABLE}.install_version = '12952' then'1.12.952'
            when ${TABLE}.install_version = '12956' then'1.12.956'
            when ${TABLE}.install_version = '12961' then'1.12.961'
            when ${TABLE}.install_version = '12971' then'1.12.971'
            when ${TABLE}.install_version = '13002' then'1.13.002'
            when ${TABLE}.install_version = '13012' then'1.13.012'
            when ${TABLE}.install_version = '13021' then'1.13.021'
            when ${TABLE}.install_version = '13030' then'1.13.030'
            when ${TABLE}.install_version = '13031' then'1.13.031'
            when ${TABLE}.install_version = '13044' then'1.13.044'
            when ${TABLE}.install_version = '13050' then'1.13.050'
            when ${TABLE}.install_version = '13052' then'1.13.052'
            when ${TABLE}.install_version = '13053' then'1.13.053'
            when ${TABLE}.install_version = '13075' then'1.13.075'
            when ${TABLE}.install_version = '13083' then'1.13.083'
            when ${TABLE}.install_version = '13084' then'1.13.084'
            when ${TABLE}.install_version = '13092' then'1.13.092'
            when ${TABLE}.install_version = '13093' then'1.13.093'
            when ${TABLE}.install_version = '13101' then'1.13.101'
            when ${TABLE}.install_version = '13114' then'1.13.114'
            when ${TABLE}.install_version = '13115' then'1.13.115'
            when ${TABLE}.install_version = '13116' then'1.13.116'
            when ${TABLE}.install_version = '13117' then'1.13.117'
            when ${TABLE}.install_version = '13131' then'1.13.131'
            else ''
          end"
}

constant: country_region {
  value: "case
            when ${TABLE}.country in ('AR','BO','BZ','CL','CO','CR','EC','SV','GT','HN','MX','NI','PA','PY', 'PE', 'UY', 'VE') then 'LATAM-ES'
            when ${TABLE}.country = 'BR' then 'LATAM-BR'
            when ${TABLE}.country in ('SE','DK','FI','IS','NO','SE') then 'Scandinavia'
            when ${TABLE}.country in ('GB','AT','BE','BG','CH','CY','CZ','ES','EE','FR','DE','GR','HR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','TR') then 'UK-EU'
            when ${TABLE}.country in ('US','CA') then 'USA & Canada'
            when ${TABLE}.country in ('JP','HK','KR','TW') then 'East Asia xChina'
            when ${TABLE}.country in ('ID','IN','MY','PH','SG','TH','VN') then 'SE Asia & India'
            when ${TABLE}.country in ('AU', 'NZ') then 'AU-NZ'
            else 'OTHER'
          end"
}

constant: iap_id_strings {
  value: "case
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_001' then 'Free Ticket Machine'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_017' then 'Free Coin Machine'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_018' then 'Free Boost Machine'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_004' then 'Peewee Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_005' then 'Small Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_006' then 'Medium Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_007' then 'Large Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_020' then 'Huge Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_021' then 'Jumbo Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_008' then 'Peewee Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_026' then 'Peewee Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_009' then 'Small Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_010' then 'Medium Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_011' then 'Large Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_012' then 'Huge Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_013' then 'Jumbo Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_023' then 'Peewee Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_014' then 'Small Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_015' then 'Medium Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_016' then 'Large Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_024' then 'Huge Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_025' then 'Jumbo Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') like 'item_028' then '24h Infinite Lives'
            when json_extract_scalar(extra_json,'$.iap_id') = 'COLOR_BALL' then 'Color Ball Boost'
            when json_extract_scalar(extra_json,'$.iap_id') = 'BOMB' then 'Bomb Boost'
            when json_extract_scalar(extra_json,'$.iap_id') = 'ROCKET' then 'Rocket Boost'
            when json_extract_scalar(extra_json,'$.iap_id') = 'clear_cell' then 'Clear Cell Skill'
            when json_extract_scalar(extra_json,'$.iap_id') = 'clear_vertical' then '1x Clear Vertical Skill'
            when json_extract_scalar(extra_json,'$.iap_id') = 'clear_horizontal' then '1x Clear Horizontal Skill'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_clear_cell' then '1x Clear Cell Skill'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_clear_cell_bulk' then '5x Clear Cell Skill'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_clear_horizontal' then '1x Clear Horizontal Skill'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_clear_horizontal_bulk' then '5x Clear Horizontal Skill'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_clear_vertical' then '1x Clear Vertical Skill'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_clear_vertical_bulk' then '5x Clear Vertical Skill'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_rocket' then '1x Rocket Boost'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_rocket_bulk' then '8x Rocket Boost'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_color_ball' then '1x Color Ball Boost'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_color_ball_bulk' then '5x Color Ball Boost'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_bomb' then '1x Bomb Boost'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_bomb_bulk' then '6x Bomb Boost'
            when json_extract_scalar(extra_json,'$.iap_id') = 'extra_moves_5' then '5x Extra Moves'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_051' then 'Giant Power Up Pack!'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_052' then 'Hammer Chum Chums & Coins Special!'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_054' then 'Vertical Chum Chums & Coins Special!'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_055' then 'Few More Coins'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_056' then 'More Coins'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_057' then 'A Lot of Coins!'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_058' then 'Few More Lives'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_059' then 'More Lives'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_060' then 'A Lot of Lives!'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_063' then 'Treasure Trove (XS)'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_066' then 'Treasure Trove (S)'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_069' then 'Treasure Trove (M)'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_072' then 'Treasure Trove (L)'
            else json_extract_scalar(extra_json,'$.iap_id')
          end"
}

constant: iap_id_strings_grouped {
  value: "case
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_001' then 'Free Machine'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_017' then 'Free Machine'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_018' then 'Free Machine'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_004' then 'Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_005' then 'Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_006' then 'Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_007' then 'Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_020' then 'Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_021' then 'Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_057' then 'Coin Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_008' then 'Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_026' then 'Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_009' then 'Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_010' then 'Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_011' then 'Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_012' then 'Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_013' then 'Gem Capsule'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_023' then 'Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_014' then 'Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_015' then 'Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_016' then 'Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_024' then 'Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_025' then 'Life Pack'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_028' then '24h Infinite Lives'
            when json_extract_scalar(extra_json,'$.iap_id') = 'item_037' then 'Lives & Coins Bundle'
            when json_extract_scalar(extra_json,'$.iap_id') = 'boost_001' then 'Boosts'
            when json_extract_scalar(extra_json,'$.iap_id') = 'boost_002' then 'Boosts'
            when json_extract_scalar(extra_json,'$.iap_id') = 'boost_003' then 'Boosts'
            when json_extract_scalar(extra_json,'$.iap_id') = 'boost_004' then 'Boosts'
            when json_extract_scalar(extra_json,'$.iap_id') = 'boost_005' then 'Boosts'
            when json_extract_scalar(extra_json,'$.iap_id') = 'boost_006' then 'Boosts'
            when json_extract_scalar(extra_json,'$.iap_id') = 'box_000' then 'Free Machine'
            when json_extract_scalar(extra_json,'$.iap_id') = 'box_004' then 'Free Machine'
            when json_extract_scalar(extra_json,'$.iap_id') = 'box_005' then 'Free Machine'
            when json_extract_scalar(extra_json,'$.iap_id') like '%clear_cell%' then 'Chum Chum Skills'
            when json_extract_scalar(extra_json,'$.iap_id') like '%clear_horizontal%' then 'Chum Chum Skills'
            when json_extract_scalar(extra_json,'$.iap_id') like '%clear_vertical%' then 'Chum Chum Skills'
            when json_extract_scalar(extra_json,'$.iap_id') like '%bomb%' then 'Pre-Game Boosts'
            when json_extract_scalar(extra_json,'$.iap_id') like '%rocket%' then 'Pre-Game Boosts'
            when json_extract_scalar(extra_json,'$.iap_id') like '%color_ball%' then 'Pre-Game Boosts'
            when json_extract_scalar(extra_json,'$.iap_id') like '%zone%' then 'Zone Restoration'
            when json_extract_scalar(extra_json,'$.iap_id') like '%extra_moves%' then 'Extra Moves'
            else json_extract_scalar(extra_json,'$.iap_id')
          end"
          }

constant:  iam_ui_actions {
  value: "case
            when json_extract_scalar(extra_json,'$.ui_action') like '%Conectar%' then 'Connect'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Conecte%' then 'Connect'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Conéctate%' then 'Connect'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Connect%' then 'Connect'
            when json_extract_scalar(extra_json,'$.ui_action') like '%MISSING%' then 'Connect'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Califícanos%' then 'Rate Us'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Avalie-nos%' then 'Rate Us'
            when json_extract_scalar(extra_json,'$.ui_action') = 'btn_positive' then 'Rate Us'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Rate Us%' then 'Rate Us'
            when json_extract_scalar(extra_json,'$.ui_action') like '%tarde%' then 'Later'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Luego%' then 'Later'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Depois%' then 'Later'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Permitir%' then 'Enable'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Habilitar%' then 'Enable'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Si%' then 'Yes'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Sí%' then 'Yes'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Sim%' then 'Yes'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Não%' then 'No'
            when json_extract_scalar(extra_json,'$.ui_action') like '%No%' then 'No'
            when json_extract_scalar(extra_json,'$.ui_action') = 'Ok' then 'Yes'
            when json_extract_scalar(extra_json,'$.ui_action') like '%Yes%' then 'Yes'
            when json_extract_scalar(extra_json,'$.ui_action') = '¡Juega ahora!' then 'Play Now'
            when json_extract_scalar(extra_json,'$.ui_action') = 'Jogue agora!' then 'Play Now'
            when json_extract_scalar(extra_json,'$.ui_action') = 'item_035' then 'Purchase - 24 Hours Infinite Lives'
            when json_extract_scalar(extra_json,'$.ui_action') = 'item_037' then 'Purchase - CE 202109_a - Lives & Coins Bundle'
            when json_extract_scalar(extra_json,'$.ui_action') = 'Actualizar' then 'Update'
            when json_extract_scalar(extra_json,'$.ui_action') = 'Atualizar' then 'Update'
            when json_extract_scalar(extra_json,'$.ui_action') = 'close' then 'Close'
            when json_extract_scalar(extra_json,'$.ui_action') = 'OverlayClose' then 'Close'
            else json_extract_scalar(extra_json,'$.ui_action')
          end"
}

constant: button_tags {
  value: "case
            when json_extract_scalar(extra_json,'$.button_tag') = 'Panel_ZoneHome.Tasks' then 'Zones Home - Open'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Panel_ZoneHome.Play' then 'Zones Home - Play'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Panel_ZoneHome.NewZone' then 'Zones Home - New Zone'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_Tasks_Zones.Restore' then 'Zone Task List - Restore'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_Tasks_Zones.Close' then 'Zone Task List - Close'
            when json_extract_scalar(extra_json,'$.button_tag') like '%Panel_ZoneExplorer.Zone.%' then 'Zone Explorer'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndOfRound_Success.Collect' then 'Mini-Game - EoR - Collect'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndOfRound_Failure.TryAgain' then 'Mini-Game - EoR - Try Again'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndOfRound_Success.WatchAd' then 'Mini-Game - EoR - Watch Ad'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndOfRound_BuyExtra.Continue' then 'Mini-Game - Extra Moves - Continue'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndOfRound_BuyExtra.Close' then 'Mini-Game - Extra Moves - Close'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_FirstComboPowerup.Continue' then 'Mini-Game - FUE - First Combo'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_StreakBonusInfo.PlayFromQuest' then 'Mini-Game - EoR - Streak Bonus - Continue'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_PreGame.Close' then 'Mini-Game - Pre-Game - Close'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_PreGame.Play' then 'Mini-Game - Pre-Game - Play'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_PreGame.Bomb' then 'Mini-Game - Pre-Game - Boost'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_PreGame.Rocket' then 'Mini-Game - Pre-Game - Boost'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_PreGame.ColorBall' then 'Mini-Game - Pre-Game - Boost'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_PreGame.PlayFromQuest' then 'Zone Task List - Play'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_Pause.' then 'Mini-Game - Pause'
            when json_extract_scalar(extra_json,'$.button_tag') = 'EndlessTreasure.' then 'Treasure Trove - Open'
            when json_extract_scalar(extra_json,'$.button_tag') like 'EndlessTreasure.et%' then 'Treasure Trove - Open'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndlessTreasure.endless_treasure' then 'Treasure Trove - Free'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndlessTreasure.Close' then 'Treasure Trove - Close'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_RewardClaim.Collect.endless_treasure' then 'Treasure Trove - Collect'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndlessTreasure.endless_treasure.item_061' then 'Treasure Trove - #1 (Free)'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndlessTreasure.endless_treasure.item_062' then 'Treasure Trove - #2 (Free)'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndlessTreasure.endless_treasure.item_063' then 'Treasure Trove - #3 (Paid)'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndlessTreasure.endless_treasure.item_064' then 'Treasure Trove - #4 (Free)'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndlessTreasure.endless_treasure.item_065' then 'Treasure Trove - #5 (Free)'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_EndlessTreasure.endless_treasure.item_066' then 'Treasure Trove - #6 (Paid)'
            when json_extract_scalar(extra_json,'$.button_tag') = 'DailyRewards' then 'Daily Rewards - Open'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Panel_DailyRewards.Claim' then 'Daily Rewards - Claim'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Panel_DailyRewards.ClaimDailyReward' then 'Daily Rewards - Claim'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Panel_DailyRewards.Close' then 'Daily Rewards - Close'
            when json_extract_scalar(extra_json,'$.button_tag') like 'FlourFrenzy.ff_event%' then 'Flour Frenzy - Preview'
            when json_extract_scalar(extra_json,'$.button_tag') like 'Sheet_FlourFrenzy_Preview%' then 'Flour Frenzy - Start'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_FlourFrenzy_Leaderboard.PlayFromFeature' then 'Flour Frenzy - Play'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_FlourFrenzy_Leaderboard.CloseInfo' then 'Flour Frenzy - Info - Close'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_FlourFrenzy_Leaderboard.Close' then 'Flour Frenzy - Leaderboard - Close'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_CharacterUnlock.Continue' then 'Collection - Character Unlock - Continue'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_PreGame.EditCollection' then 'Collection - Edit Collection'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_Collection.CharacterCard.shuffle' then 'Collection - Edit Collection - Use'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_Collection.Try' then 'Collection - Edit Collection - Try'
            when json_extract_scalar(extra_json,'$.button_tag') like 'MovesChallenge.mc_event_id_%' then 'Moves Master - Open'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_MovesChallenge_Preview.Continue' then 'Moves Master - Start'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_MovesChallenge_Leaderboard.' then 'Moves Master - Play'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_MovesChallenge_Leaderboard.Close' then 'Moves Master - Close'
            when json_extract_scalar(extra_json,'$.button_tag') = 'Sheet_MovesChallenge_Leaderboard.MovesMasterInfo' then 'Moves Master - Info'
            else json_extract_scalar(extra_json,'$.button_tag')
          end"
}

constant: reward_types {
  value: "case
            when ${TABLE}.reward_type = 'CURRENCY_02' then 'Gems'
            when ${TABLE}.reward_type = 'CURRENCY_03' then 'Coins'
            when ${TABLE}.reward_type = 'CURRENCY_04' then 'Lives'
          end"
}

constant: campaign_name_clean_update {
  value: "case
            when
              ${TABLE}.campaign_name = 'Android_AAA_Events_15_Minutes_Women&Men_LATAM/ES_N/A'
              and date(${TABLE}.singular_install_date) between '2023-04-11' and '2023-04-13'
              then '20230413 - AAA - LATAM/ES - 15 Min'

            when ${TABLE}.campaign_name = 'CHUM|Facebook|Android|US|AA+|Jan24' then '20240103 - AA+ - USA - Purchase'

            when ${TABLE}.campaign_name = 'Android_AAA+_30_Minutes_MX_20231214' then '20231214 - AAA+ - MX - 30 Min'

            when ${TABLE}.campaign_name = 'Android_AAA+_30_Minutes_MX_20231129' then '20231129 - AAA+ - MX - 30 Min'

            when ${TABLE}.campaign_name = 'Android_AAA+_MAI_US_20231110' then '20231110 - AAA+ - USA - Install'
            when ${TABLE}.campaign_name = 'Android_AAA+TutorialComplete_US_20231030' then '20231030 - AAA+ - USA - Tutorial Complete'

            when ${TABLE}.campaign_name = 'Android_AAA+_30_Minutes_LATAM/ES_20231019' then '20231019 - AAA+ - LATAM/ES - 30 Min'
            when ${TABLE}.campaign_name = 'iOS_AAA+_Install_LATAM/ES_20231019' then '20231019 - AAA+ - LATAM/ES - 30 Min'

            when ${TABLE}.campaign_name = 'Android_AAA+_30_Minutes_US_20230828' then '20230828 - AAA+ - USA - 30 Min'
            when ${TABLE}.campaign_name = 'Android_AAA+_60_Minutes_US_20230825' then '20230825 - AAA+ - USA - 60 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_MAI_US_20230705' then '20230705 - AAA - USA - Install'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_US_N/A' then '20230131 - AAA - USA - Purchase'
            when ${TABLE}.campaign_name = 'Android_AAA_Purchase_US_20230523' then '20230523 - AAA - USA - Purchase'
            when ${TABLE}.campaign_name = 'Android_AAA+_Purchase_US_20230808' then '20230808 - AAA+ - USA - Purchase'
            when ${TABLE}.campaign_name = 'Android_AAA+_Purchase_US_20230809' then '20230808 - AAA+ - USA - Purchase'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_15_Minutes_Women&Men_US_N/A' then '20230308 - AAA - USA - 15 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_US_20230427' then '20230427 - AAA - USA - 15 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_30_Minutes_US_20230710' then '20230710 - AAA - USA - 30 Min'
            when ${TABLE}.campaign_name = 'Android_AAA+_30_Minutes_US_20230721' then '20230721 - AAA+ - USA - 30 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_Installs_No_Event_Women&Men_LATAM/ES_N/A' then 'AAA - LATAM/ES - No Event'
            when ${TABLE}.campaign_name = 'Android_AAA_Installs_No_Event_Women&Men_LATAM/ES_N/A v2' then 'AAA - LATAM/ES - No Event'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_5_Minutes_Women&Men_LATAM/ES_N/A' then 'AAA - LATAM/ES - 5 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_15_Minutes_Women&Men_LATAM/ES_N/A' then 'AAA - LATAM/ES - 15 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_LATAM/ES_20230413' then '20230413 - AAA - LATAM/ES - 15 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_LATAM/ES_20230510' then '20230510 - AAA - LATAM/ES - 15 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_LATAM/ES_20230523' then '20230523 - AAA - LATAM/ES - 15 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_LATAM/ES_20230607' then '20230607 - AAA - LATAM/ES - 15 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_LATAM/ES_20230807' then '20230807 - AAA - LATAM/ES - 15 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_30_Minutes_LATAM/ES_20230717' then '20230717 - AAA - LATAM/ES - 30 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_15_Minutes_Women&Men_LATAM/PTBR_N/A' then 'AAA - LATAM/BR - 15 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_Installs_No_Event_Women&Men_Scan_N/A' then'AAA - Scandinavia - No Event'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_15_Minutes_Women&Men_Scan_N/A' then'AAA - Scandinavia - 15 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchases_Women&Men_Scandinavia_N/A' then 'AAA - Scandinavia - Purchase'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_30_Minutes_Women&Men_LATAM/ES_N/A' then 'AAA - LATAM/ES - 30 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_30_Minutes_Women&Men_LATAM/BR_N/A' then 'AAA - LATAM/BR - 30 Min'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_LATAM/PTBR_N/A' then 'AAA - LATAM/BR - Purchase'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_LATAM/PTBR_N/A_v2' then 'AAA - LATAM/BR - Purchase'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_LATAM/ES_N/A' then 'AAA - LATAM/ES - Purchase'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_LATAM/ES_N/A_v2' then 'AAA - LATAM/ES - Purchase'
            when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_Chile_N/A' then 'AAA - Chile - Purchase'
            when ${TABLE}.campaign_name = 'Art_Test_Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Puzzle Games' then 'MAI - No Event - Puzzle Games'
            when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Puzzle Games' then 'MAI - No Event - Puzzle Games'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Puzzle Games' then 'MAI - 5 Min - Puzzle Games'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Puzzle Games' then 'MAI - 15 Min - Puzzle Games'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_30_Minutes_Women&Men_LATAM/ES_Puzzle Games' then 'MAI - 30 Min - Puzzle Games'
            when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Candy Crush' then 'MAI - No Event - Candy Crush'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Candy Crush' then 'MAI - 5 Min - Candy Crush'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Candy Crush' then 'MAI - 15 Min - Candy Crush'
            when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Puzzle & Decorate' then 'MAI - No Event - Puzzle & Decorate'
            when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Puzzle&Decorate' then 'MAI - No Event - Puzzle & Decorate'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Puzzle & Decorate' then 'MAI - 5 Min - Puzzle & Decorate'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Puzzle & Decorate' then 'MAI - 15 Min - Puzzle & Decorate'
            when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Coin_Master' then 'MAI - No Event - Coin Master'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Coin Master' then 'MAI - 5 Min - Coin Master'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Coin Master' then 'MAI - 15 Min - Coin Master'
            when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_LATAM/MX - LAL - 1% - L7D_4+' then 'MAI - No Event - 4 of 7 Days'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_LATAM/MX - LAL - 1% - L7D_4+' then 'MAI - 5 Min - 4 of 7 Days'
            when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_LATAM/ES - LAL - 1% - Initiate Checkout' then 'MAI - No Event - Start Checkout'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES - LAL - 1% - Like Page' then 'MAI - 5 Min - Like Page'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_LATAM/ES - LAL - 1% - Initiate Checkout' then 'MAI - 5 Min - Start Checkout'
            when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Bubble Shooter' then 'MAI - No Event - Bubble Shooter'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Bubble Shooter' then 'MAI - 5 Min - Bubble Shooter'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Bubble Shooter' then 'MAI - 15 Min - Bubble Shooter'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_30_Minutes_Women&Men_LATAM/ES_Bubble Shooter' then 'MAI - 30 Min - Bubble Shooter'
            when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Tile Blast' then 'MAI - No Event - Tile Blast'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Tile Blast' then 'MAI - 5 Min - Tile Blast'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Tile Blast' then 'MAI - 15 Min - Tile Blast'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_30_Minutes_Women&Men_LATAM/ES_Tile Blast' then 'MAI - 30 Min - Tile Blast'
            when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Blitz' then 'MAI - No Event - Blitz'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Blitz' then 'MAI - 5 Min - Blitz'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Blitz' then 'MAI - 15 Min - Blitz'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Walmart' then 'MAI - 5 Min - Walmart'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Walmart' then 'MAI - 15 Min - Walmart'
            when ${TABLE}.campaign_name = 'Android_Manual_Events_30_Minutes_Women&Men_LATAM/ES_Walmart' then 'MAI - 30 Min - Walmart'
            else ${TABLE}.campaign_name
          end"
}

constant: campaign_with_organics_estimate {
  value: "case
    when
      ${TABLE}.country = 'US'
      and date(${TABLE}.created_date) between '2024-01-03' and '2024-01-24'
      then '20240103 - AA+ - USA - Purchase - With Organics'
    when
      ${TABLE}.country = 'US'
      and date(${TABLE}.created_date) between '2023-08-09' and '2023-08-22'
      then '20230808 - AAA+ - USA - Purchase - With Organics'
    when
      ${TABLE}.country = 'US'
      and date(${TABLE}.created_date) between '2023-05-24' and '2023-06-02'
      then '20230523 - AAA - USA - Purchase - With Organics'
    when
      ${TABLE}.country = 'US'
      and date(${TABLE}.created_date) between '2023-01-31' and '2023-02-15'
      then '20230131 - AAA - USA - Purchase - With Organics'
  end"
}

constant: campaign_name_clean_update_backup {
  value: "case
  when
  ${TABLE}.campaign_name = 'Android_AAA_Events_15_Minutes_Women&Men_LATAM/ES_N/A'
  and date(${TABLE}.singular_install_date) between '2023-04-11' and '2023-04-13'
  then 'AAA - LATAM/ES - 15 Min - 20230413'
  when ${TABLE}.campaign_name = 'Android_AAA+_30_Minutes_MX_20231129' then 'AAA - MX - 30 Min - 20231129'
  when ${TABLE}.campaign_name = 'Android_AAA_MAI_US_20230705' then 'AAA - USA - Install - 20230705'
  when ${TABLE}.campaign_name = 'Android_AAA+_MAI_US_20231110' then '20231110 - AAA+ - USA - Install'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_US_N/A' then 'AAA - USA - Purchase - 20230131'
  when ${TABLE}.campaign_name = 'Android_AAA_Purchase_US_20230523' then 'AAA - USA - Purchase - 20230523'
  when ${TABLE}.campaign_name = 'Android_AAA+_Purchase_US_20230808' then 'AAA+ - USA - Purchase - 20230808'
  when ${TABLE}.campaign_name = 'Android_AAA+_Purchase_US_20230809' then 'AAA+ - USA - Purchase - 20230808'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_15_Minutes_Women&Men_US_N/A' then 'AAA - USA - 15 Min - 20230308'
  when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_US_20230427' then 'AAA - USA - 15 Min - 20230427'
  when ${TABLE}.campaign_name = 'Android_AAA_30_Minutes_US_20230710' then 'AAA - USA - 30 Min - 20230710'
  when ${TABLE}.campaign_name = 'Android_AAA+_30_Minutes_US_20230721' then 'AAA+ - USA - 30 Min - 20230721'
  when ${TABLE}.campaign_name = 'Android_AAA_Installs_No_Event_Women&Men_LATAM/ES_N/A' then 'AAA - LATAM/ES - No Event'
  when ${TABLE}.campaign_name = 'Android_AAA_Installs_No_Event_Women&Men_LATAM/ES_N/A v2' then 'AAA - LATAM/ES - No Event'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_5_Minutes_Women&Men_LATAM/ES_N/A' then 'AAA - LATAM/ES - 5 Min'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_15_Minutes_Women&Men_LATAM/ES_N/A' then 'AAA - LATAM/ES - 15 Min'
  when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_LATAM/ES_20230413' then 'AAA - LATAM/ES - 15 Min - 20230413'
  when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_LATAM/ES_20230510' then 'AAA - LATAM/ES - 15 Min - 20230510'
  when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_LATAM/ES_20230523' then 'AAA - LATAM/ES - 15 Min - 20230523'
  when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_LATAM/ES_20230607' then 'AAA - LATAM/ES - 15 Min - 20230607'
  when ${TABLE}.campaign_name = 'Android_AAA_15_Minutes_LATAM/ES_20230807' then 'AAA - LATAM/ES - 15 Min - 20230807'
  when ${TABLE}.campaign_name = 'Android_AAA_30_Minutes_LATAM/ES_20230717' then 'AAA - LATAM/ES - 30 Min - 20230717'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_15_Minutes_Women&Men_LATAM/PTBR_N/A' then 'AAA - LATAM/BR - 15 Min'
  when ${TABLE}.campaign_name = 'Android_AAA_Installs_No_Event_Women&Men_Scan_N/A' then'AAA - Scandinavia - No Event'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_15_Minutes_Women&Men_Scan_N/A' then'AAA - Scandinavia - 15 Min'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchases_Women&Men_Scandinavia_N/A' then 'AAA - Scandinavia - Purchase'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_30_Minutes_Women&Men_LATAM/ES_N/A' then 'AAA - LATAM/ES - 30 Min'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_30_Minutes_Women&Men_LATAM/BR_N/A' then 'AAA - LATAM/BR - 30 Min'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_LATAM/PTBR_N/A' then 'AAA - LATAM/BR - Purchase'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_LATAM/PTBR_N/A_v2' then 'AAA - LATAM/BR - Purchase'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_LATAM/ES_N/A' then 'AAA - LATAM/ES - Purchase'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_LATAM/ES_N/A_v2' then 'AAA - LATAM/ES - Purchase'
  when ${TABLE}.campaign_name = 'Android_AAA_Events_Purchase_Women&Men_Chile_N/A' then 'AAA - Chile - Purchase'
  when ${TABLE}.campaign_name = 'Art_Test_Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Puzzle Games' then 'MAI - No Event - Puzzle Games'
  when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Puzzle Games' then 'MAI - No Event - Puzzle Games'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Puzzle Games' then 'MAI - 5 Min - Puzzle Games'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Puzzle Games' then 'MAI - 15 Min - Puzzle Games'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_30_Minutes_Women&Men_LATAM/ES_Puzzle Games' then 'MAI - 30 Min - Puzzle Games'
  when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Candy Crush' then 'MAI - No Event - Candy Crush'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Candy Crush' then 'MAI - 5 Min - Candy Crush'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Candy Crush' then 'MAI - 15 Min - Candy Crush'
  when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Puzzle & Decorate' then 'MAI - No Event - Puzzle & Decorate'
  when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Puzzle&Decorate' then 'MAI - No Event - Puzzle & Decorate'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Puzzle & Decorate' then 'MAI - 5 Min - Puzzle & Decorate'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Puzzle & Decorate' then 'MAI - 15 Min - Puzzle & Decorate'
  when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Coin_Master' then 'MAI - No Event - Coin Master'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Coin Master' then 'MAI - 5 Min - Coin Master'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Coin Master' then 'MAI - 15 Min - Coin Master'
  when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_LATAM/MX - LAL - 1% - L7D_4+' then 'MAI - No Event - 4 of 7 Days'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_LATAM/MX - LAL - 1% - L7D_4+' then 'MAI - 5 Min - 4 of 7 Days'
  when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_LATAM/ES - LAL - 1% - Initiate Checkout' then 'MAI - No Event - Start Checkout'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES - LAL - 1% - Like Page' then 'MAI - 5 Min - Like Page'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_LATAM/ES - LAL - 1% - Initiate Checkout' then 'MAI - 5 Min - Start Checkout'
  when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Bubble Shooter' then 'MAI - No Event - Bubble Shooter'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Bubble Shooter' then 'MAI - 5 Min - Bubble Shooter'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Bubble Shooter' then 'MAI - 15 Min - Bubble Shooter'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_30_Minutes_Women&Men_LATAM/ES_Bubble Shooter' then 'MAI - 30 Min - Bubble Shooter'
  when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Tile Blast' then 'MAI - No Event - Tile Blast'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Tile Blast' then 'MAI - 5 Min - Tile Blast'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Tile Blast' then 'MAI - 15 Min - Tile Blast'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_30_Minutes_Women&Men_LATAM/ES_Tile Blast' then 'MAI - 30 Min - Tile Blast'
  when ${TABLE}.campaign_name = 'Android_Manual_Installs_No_Event_Women&Men_LATAM/ES_Blitz' then 'MAI - No Event - Blitz'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Blitz' then 'MAI - 5 Min - Blitz'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Blitz' then 'MAI - 15 Min - Blitz'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_5_Minutes_Women&Men_LATAM/ES_Walmart' then 'MAI - 5 Min - Walmart'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_15_Minutes_Women&Men_LATAM/ES_Walmart' then 'MAI - 15 Min - Walmart'
  when ${TABLE}.campaign_name = 'Android_Manual_Events_30_Minutes_Women&Men_LATAM/ES_Walmart' then 'MAI - 30 Min - Walmart'
  else ${TABLE}.campaign_name
  end"
}


constant: singular_campaign_id_override {
  value: "
    case

      when
        ${TABLE}.singular_partner_name = 'Unattributed'
        and ${TABLE}.singular_campaign_id = ''
        and ${TABLE}.country = 'US'
        and date(${TABLE}.created_date) between '2023-11-10' and '2023-11-14'
        then '6451988225922'

      when
        ${TABLE}.singular_partner_name = 'Unattributed'
        and ${TABLE}.singular_campaign_id = ''
        and ${TABLE}.country = 'US'
        and date(${TABLE}.created_date) between '2023-10-30' and '2023-11-04'
        then '6448215765722'

      when
        ${TABLE}.singular_partner_name is null
        and ${TABLE}.country in ('AR','BO','BZ','CL','CO','CR','EC','SV','GT','HN','MX','NI','PA','PY', 'PE', 'UY', 'VE')
        and ${TABLE}.platform like '%iOS%'
        and date(${TABLE}.created_date) between '2023-10-19' and '2023-10-24'
        then '6442174773322'

      when
        ${TABLE}.singular_partner_name = 'Unattributed'
        and ${TABLE}.singular_campaign_id = ''
        and ${TABLE}.country = 'US'
        and date(${TABLE}.created_date) between '2023-01-30' and '2023-02-14'
        then '6289277953122'

      when
        ${TABLE}.singular_partner_name = 'Unattributed'
        and ${TABLE}.singular_campaign_id = ''
        and ${TABLE}.country in ('AR','BO','BZ','CL','CO','CR','EC','SV','GT','HN','MX','NI','PA','PY', 'PE', 'UY', 'VE')
        and date(${TABLE}.created_date) between '2023-04-11' and '2023-04-13'
        then '6250035906122'

      when
        ${TABLE}.singular_partner_name = 'Unattributed'
        and ${TABLE}.singular_campaign_id = ''
        and ${TABLE}.country in ('AR','BO','BZ','CL','CO','CR','EC','SV','GT','HN','MX','NI','PA','PY', 'PE', 'UY', 'VE')
        and date(${TABLE}.created_date) between '2023-04-14' and '2023-04-23'
        then '6299378813122'

      when
        ${TABLE}.singular_partner_name = 'Unattributed'
        and ${TABLE}.singular_campaign_id = ''
        and ${TABLE}.country in ('US','CA')
        and date(${TABLE}.created_date) between '2023-04-28' and '2023-05-04'
        then '6301194225922'

      when
        ${TABLE}.singular_partner_name = 'Unattributed'
        and ${TABLE}.singular_campaign_id = ''
        and ${TABLE}.country in ('US','CA')
        and date(${TABLE}.created_date) between '2023-05-24' and '2023-06-05'
        then '6302530846522'

      when
        ${TABLE}.singular_partner_name = 'Unattributed'
        and ${TABLE}.singular_campaign_id = ''
        and ${TABLE}.country in ('US','CA')
        and date(${TABLE}.created_date) between '2023-07-11' and '2023-07-12'
        then '6342654069322'

      when
        ${TABLE}.singular_partner_name = 'Unattributed'
        and ${TABLE}.singular_campaign_id = ''
        and ${TABLE}.country in ('US','CA')
        and date(${TABLE}.created_date) between '2023-07-21' and '2023-07-25'
        then '6353426252722'

      else ${TABLE}.singular_campaign_id
    end
  "
}

constant: singular_campaign_blended_window_override {
  value: "
  case
  when
    ${TABLE}.country in ('US','CA')
    and date(${TABLE}.created_date) between '2023-01-30' and '2023-02-18'
  then '20230131 - AAA - USA - Purchase'

  when
    ${TABLE}.country in ('US','CA')
    and date(${TABLE}.created_date) between '2023-05-24' and '2023-06-05'
  then '20230523 - AAA - USA - Purchase'

  when
    ${TABLE}.country in ('US','CA')
    and date(${TABLE}.created_date) between '2023-07-05' and '2023-07-07'
  then '20230705 - AAA - USA - Install'

  when
    ${TABLE}.country in ('US','CA')
    and date(${TABLE}.created_date) between '2023-07-10' and '2023-07-15'
  then '20230710 - AAA - USA - 30 Min'

  when
    ${TABLE}.country in ('US','CA')
    and date(${TABLE}.created_date) between '2023-07-20' and '2023-08-02'
  then '20230721 - AAA+ - USA - 30 Min'

  when
    ${TABLE}.country in ('US','CA')
    and date(${TABLE}.created_date) between '2023-08-09' and '2023-08-21'
  then '20230808 - AAA+ - USA - Purchase'

  when
    ${TABLE}.country in ('US','CA')
    and date(${TABLE}.created_date) between '2023-08-25' and '2023-08-28'
  then '20230825 - AAA+ - USA - 60 Min'

  when
    ${TABLE}.country in ('US','CA')
    and date(${TABLE}.created_date) between '2023-08-28' and '2023-09-04'
  then '20230825 - AAA+ - USA - 30 Min'

  else 'Unmapped'
  end
  "
}

constant: singular_created_date_override {
  value: "
  case
  when
    ${TABLE}.singular_campaign_id = '6250035906122'
    and date(${TABLE}.created_date) > '2023-04-13'
    then timestamp(date('2023-04-13'))

  when
    ${TABLE}.singular_campaign_id = '6299378813122'
    and date(${TABLE}.created_date) > '2023-04-17'
    then timestamp(date('2023-04-17'))

  when
    ${TABLE}.singular_partner_name = 'Unattributed'
    and ${TABLE}.singular_campaign_id = ''
    and ${TABLE}.country in ('AR','BO','BZ','CL','CO','CR','EC','SV','GT','HN','MX','NI','PA','PY', 'PE', 'UY', 'VE')
    and date(${TABLE}.created_date) > '2023-04-17'
    then timestamp(date('2023-04-17'))

  else ${TABLE}.created_date
  end
  "
}

constant: creative_name_clean {
    value: "case
            when ${TABLE}.creative_name like 'Art Test - Playrix Style%' then 'Cottage Scene (Playrix)'
            when ${TABLE}.creative_name like 'Art Test - Royal Match Style%' then 'Cottage Scene (Royal Match)'
            when ${TABLE}.creative_name like 'Art Test - Toy Style%' then 'Cottage Scene (Toy)'
            when ${TABLE}.creative_name like 'Art_Test_Toy_Style%' then 'Cottage Scene (Toy)'
            when ${TABLE}.creative_name like 'Art Test - Current Style%' then 'Cottage Scene (Current)'
            when ${TABLE}.creative_name like 'Art_Test_Current_Style%' then 'Cottage Scene (Current)'
            when ${TABLE}.creative_name like '%TTC%' then 'Tap-to-Collapse Gameplay v1'
            when ${TABLE}.creative_name like 'Zen%' then 'Tap-to-Collapse Zen Gameplay v1'
            when ${TABLE}.creative_name like '%Level Progression%' then 'Level Progression'
            when ${TABLE}.creative_name like '%Simulated Play%' then 'Simulated Play'
            when ${TABLE}.creative_name like '%Spiral Win (Grid Mode)%' then 'Spiral Win (Grid)'
            when ${TABLE}.creative_name like '%Spiral Win (Tap to Collapse)%' then 'Spiral Win (TTC)'
            else ${TABLE}.creative_name
          end"
}

constant: game_mode_consolidated {
  value: "case
            when ${TABLE}.game_mode = 'CAMPAIGN' then 'Campaign'
            when ${TABLE}.game_mode = 'campaign' then 'Campaign'
            when ${TABLE}.game_mode = 'challenge' then 'MovesMaster'
            when ${TABLE}.game_mode = 'movesMaster' then 'MovesMaster'
            else ${TABLE}.game_mode
          end"
}

constant: ad_placements_clean {
  value: "case
            when ${TABLE}.source_id like '%DailyReward' then 'Daily Reward'
            when ${TABLE}.source_id like '%Moves_Master%' then 'Moves Master'
            when ${TABLE}.source_id like '%Pizza%' then 'Pizza'
            when ${TABLE}.source_id like '%Lucky_Dice%' then 'Lucky Dice'
            when ${TABLE}.source_id like '%RequestHelp%' then 'Ask For Help'
            when ${TABLE}.source_id like '%Battle_Pass%' then 'Battle Pass'
            when ${TABLE}.source_id like '%Puzzles%' then 'Puzzles'
            when ${TABLE}.source_id like '%Go_Fish%' then 'Go Fish'


            when ${TABLE}.source_id like '%DefaultRewardedVideo' then 'Generic Reward'
            when ${TABLE}.source_id like '%Rewarded' then 'Generic Reward'

            else ${TABLE}.source_id
          end"
}

constant: ad_reward_id_strings {
  value: "
  case
  when ${TABLE}.ad_reward_source_id = 'quick_boost_rocket' then 'Rocket'
  when ${TABLE}.ad_reward_source_id = 'quick_lives' then 'Lives'
  when ${TABLE}.ad_reward_source_id = 'quick_magnifiers' then 'Magnifiers'
  when ${TABLE}.ad_reward_source_id = 'treasure_trove' then 'Treasure Trove'
  else ${TABLE}.ad_reward_source_id
  end"
}

constant: max_highest_last_level_serial_override {
  value:
    "case
      when ${TABLE}.version = '99999999999' THEN 0
      else ${TABLE}.max_highest_last_level_serial
      end"
}

constant: max_cumulative_star_spend_override {
  value:
  "case
    when ${TABLE}.version = '99999999999' THEN 0
    else ${TABLE}.max_cumulative_star_spend
    end"
}

###################################################################
# Ads Mapping
###################################################################

constant: ad_placements_clean {
  value: "case
  when ${TABLE}.source_id like '%DailyReward' then 'Daily Reward'
  when ${TABLE}.source_id like '%Moves_Master%' then 'Moves Master'
  when ${TABLE}.source_id like '%Pizza%' then 'Pizza'
  when ${TABLE}.source_id like '%Lucky_Dice%' then 'Lucky Dice'
  when ${TABLE}.source_id like '%RequestHelp%' then 'Ask For Help'
  when ${TABLE}.source_id like '%Battle_Pass%' then 'Battle Pass'
  when ${TABLE}.source_id like '%Puzzles%' then 'Puzzles'
  when ${TABLE}.source_id like '%Go_Fish%' then 'Go Fish'

  when ${TABLE}.source_id like '%DefaultRewardedVideo' then 'Generic Reward'
  when ${TABLE}.source_id like '%Rewarded' then 'Generic Reward'

  else ${TABLE}.source_id
  end"
}

constant: ad_reward_id_strings {
  value: "
  case
  when ${TABLE}.ad_reward_source_id = 'quick_boost_rocket' then 'Rocket'
  when ${TABLE}.ad_reward_source_id = 'quick_lives' then 'Lives'
  when ${TABLE}.ad_reward_source_id = 'quick_magnifiers' then 'Magnifiers'
  when ${TABLE}.ad_reward_source_id = 'treasure_trove' then 'Treasure Trove'
  else ${TABLE}.ad_reward_source_id
  end"
}

constant: ad_placements {
  value: "case
  when ${TABLE}.source_id like '%DailyReward' then 'Daily Reward'
  when ${TABLE}.source_id like '%Moves_Master%' then 'Moves Master'
  when ${TABLE}.source_id like '%Pizza%' then 'Pizza'
  when ${TABLE}.source_id like '%Lucky_Dice%' then 'Lucky Dice'
  when ${TABLE}.source_id like '%RequestHelp%' then 'Ask For Help'
  when ${TABLE}.source_id like '%Battle_Pass%' then 'Battle Pass'
  when ${TABLE}.source_id like '%Puzzles%' then 'Puzzles'
  when ${TABLE}.source_id like '%Go_Fish%' then 'Go Fish'

  when ${TABLE}.ad_reward_source_id = 'quick_boost_rocket' then 'Rocket'
  when ${TABLE}.ad_reward_source_id = 'quick_lives' then 'Lives'
  when ${TABLE}.ad_reward_source_id = 'quick_magnifiers' then 'Magnifiers'
  when ${TABLE}.ad_reward_source_id = 'treasure_trove' then 'Treasure Trove'

  else 'Unmapped'
  end"
}

###################################################################
# IAP Names
###################################################################

constant: iap_id_strings_new {
  value: "
  case
    when ${TABLE}.iap_id like 'item_001' then 'Free Ticket Machine'
    when ${TABLE}.iap_id like 'item_017' then 'Free Coin Machine'
    when ${TABLE}.iap_id like 'item_018' then 'Free Boost Machine'
    when ${TABLE}.iap_id like 'item_004' then 'Peewee Coin Capsule'
    when ${TABLE}.iap_id like 'item_005' then 'Small Coin Capsule'
    when ${TABLE}.iap_id like 'item_006' then 'Medium Coin Capsule'
    when ${TABLE}.iap_id like 'item_007' then 'Large Coin Capsule'
    when ${TABLE}.iap_id like 'item_020' then 'Huge Coin Capsule'
    when ${TABLE}.iap_id like 'item_021' then 'Jumbo Coin Capsule'
    when ${TABLE}.iap_id like 'item_008' then 'Peewee Gem Capsule'
    when ${TABLE}.iap_id like 'item_026' then 'Peewee Gem Capsule'
    when ${TABLE}.iap_id like 'item_009' then 'Small Gem Capsule'
    when ${TABLE}.iap_id like 'item_010' then 'Medium Gem Capsule'
    when ${TABLE}.iap_id like 'item_011' then 'Large Gem Capsule'
    when ${TABLE}.iap_id like 'item_012' then 'Huge Gem Capsule'
    when ${TABLE}.iap_id like 'item_013' then 'Jumbo Gem Capsule'
    when ${TABLE}.iap_id like 'item_023' then 'Peewee Life Pack'
    when ${TABLE}.iap_id like 'item_014' then 'Small Life Pack'
    when ${TABLE}.iap_id like 'item_015' then 'Medium Life Pack'
    when ${TABLE}.iap_id like 'item_016' then 'Large Life Pack'
    when ${TABLE}.iap_id like 'item_024' then 'Huge Life Pack'
    when ${TABLE}.iap_id like 'item_025' then 'Jumbo Life Pack'
    when ${TABLE}.iap_id like 'item_028' then '24h Infinite Lives'
    when ${TABLE}.iap_id = 'COLOR_BALL' then 'Color Ball Boost'
    when ${TABLE}.iap_id = 'BOMB' then 'Bomb Boost'
    when ${TABLE}.iap_id = 'ROCKET' then 'Rocket Boost'
    when ${TABLE}.iap_id = 'clear_cell' then 'Clear Cell Skill'
    when ${TABLE}.iap_id = 'clear_vertical' then '1x Clear Vertical Skill'
    when ${TABLE}.iap_id = 'clear_horizontal' then '1x Clear Horizontal Skill'

    when ${TABLE}.iap_id = 'item_clear_cell' then '1x Clear Cell Skill'
    when ${TABLE}.iap_id = 'item_clear_cell_bulk' then '5x Clear Cell Skill'
    when ${TABLE}.iap_id = 'item_clear_horizontal' then '1x Clear Horizontal Skill'
    when ${TABLE}.iap_id = 'item_clear_horizontal_bulk' then '5x Clear Horizontal Skill'
    when ${TABLE}.iap_id = 'item_clear_vertical' then '1x Clear Vertical Skill'
    when ${TABLE}.iap_id = 'item_clear_vertical_bulk' then '5x Clear Vertical Skill'
    when ${TABLE}.iap_id = 'item_shuffle' then '1x Shuffle Skill'
    when ${TABLE}.iap_id = 'item_shuffle_bulk' then '5x Shuffle Skill'



    when ${TABLE}.iap_id = 'item_rocket' then '1x Rocket Boost'
    when ${TABLE}.iap_id = 'item_rocket_bulk' then '8x Rocket Boost'
    when ${TABLE}.iap_id = 'item_color_ball' then '1x Color Ball Boost'
    when ${TABLE}.iap_id = 'item_color_ball_bulk' then '5x Color Ball Boost'
    when ${TABLE}.iap_id = 'item_bomb' then '1x Bomb Boost'
    when ${TABLE}.iap_id = 'item_bomb_bulk' then '6x Bomb Boost'
    when ${TABLE}.iap_id = 'extra_moves_5' then '5x Extra Moves'

    when ${TABLE}.iap_id = 'item_051' then 'Giant Power Up Pack!'

    when ${TABLE}.iap_id = 'item_052' then 'Hammer Chum Chums & Coins Special!'
    when ${TABLE}.iap_id = 'item_054' then 'Vertical Chum Chums & Coins Special!'
    when ${TABLE}.iap_id = 'item_053' then 'Horizontal Chum Chums & Coins Special!'
    when ${TABLE}.iap_id = 'item_075' then 'Shuffle Chum Chums & Coins Special!'

    when ${TABLE}.iap_id = 'item_055' then 'Coins (S)'
    when ${TABLE}.iap_id = 'item_056' then 'Coins (M)'
    when ${TABLE}.iap_id = 'item_057' then 'Coins (L)'

    when ${TABLE}.iap_id = 'item_058' then 'Lives (S)'
    when ${TABLE}.iap_id = 'item_059' then 'Lives (M)'
    when ${TABLE}.iap_id = 'item_060' then 'Lives (L)'

    when ${TABLE}.iap_id = 'item_063' then 'Treasure Trove (XS)'
    when ${TABLE}.iap_id = 'item_066' then 'Treasure Trove (S)'
    when ${TABLE}.iap_id = 'item_069' then 'Treasure Trove (M)'
    when ${TABLE}.iap_id = 'item_072' then 'Treasure Trove (L)'

    when ${TABLE}.iap_id = 'item_076' then 'Magnifiers (S)'
    when ${TABLE}.iap_id = 'item_077' then 'Magnifiers (M)'
    when ${TABLE}.iap_id = 'item_078' then 'Magnifiers (L)'

    when ${TABLE}.iap_id = 'item_089' then 'Level Bundle (100)'
    when ${TABLE}.iap_id = 'item_090' then 'Level Bundle (200)'
    when ${TABLE}.iap_id = 'item_091' then 'Level Bundle (300)'
    when ${TABLE}.iap_id = 'item_092' then 'Level Bundle (400)'

    when ${TABLE}.iap_id = 'battle_pass' then 'Premium Battle Pass'


    else ${TABLE}.iap_id
  end"
}

constant: iap_id_strings_grouped_new {
  value: "
    case
      when ${TABLE}.iap_id = 'item_001' then 'Free Machine'
      when ${TABLE}.iap_id = 'item_017' then 'Free Machine'
      when ${TABLE}.iap_id = 'item_018' then 'Free Machine'
      when ${TABLE}.iap_id = 'item_004' then 'Coins'
      when ${TABLE}.iap_id = 'item_005' then 'Coins'
      when ${TABLE}.iap_id = 'item_006' then 'Coins'
      when ${TABLE}.iap_id = 'item_007' then 'Coins'
      when ${TABLE}.iap_id = 'item_020' then 'Coins'
      when ${TABLE}.iap_id = 'item_021' then 'Coins'
      when ${TABLE}.iap_id = 'item_057' then 'Coins'
      when ${TABLE}.iap_id = 'item_008' then 'Gems'
      when ${TABLE}.iap_id = 'item_026' then 'Gems'
      when ${TABLE}.iap_id = 'item_009' then 'Gems'
      when ${TABLE}.iap_id = 'item_010' then 'Gems'
      when ${TABLE}.iap_id = 'item_011' then 'Gems'
      when ${TABLE}.iap_id = 'item_012' then 'Gems'
      when ${TABLE}.iap_id = 'item_013' then 'Gems'
      when ${TABLE}.iap_id = 'item_023' then 'Lives'
      when ${TABLE}.iap_id = 'item_014' then 'Lives'
      when ${TABLE}.iap_id = 'item_015' then 'Lives'
      when ${TABLE}.iap_id = 'item_016' then 'Lives'
      when ${TABLE}.iap_id = 'item_024' then 'Lives'
      when ${TABLE}.iap_id = 'item_025' then 'Lives'
      when ${TABLE}.iap_id = 'item_028' then 'Lives'
      when ${TABLE}.iap_id = 'item_037' then 'Lives & Coins Bundle'
      when ${TABLE}.iap_id = 'boost_001' then 'Boosts'
      when ${TABLE}.iap_id = 'boost_002' then 'Boosts'
      when ${TABLE}.iap_id = 'boost_003' then 'Boosts'
      when ${TABLE}.iap_id = 'boost_004' then 'Boosts'
      when ${TABLE}.iap_id = 'boost_005' then 'Boosts'
      when ${TABLE}.iap_id = 'boost_006' then 'Boosts'
      when ${TABLE}.iap_id = 'box_000' then 'Free Machine'
      when ${TABLE}.iap_id = 'box_004' then 'Free Machine'
      when ${TABLE}.iap_id = 'box_005' then 'Free Machine'

      when ${TABLE}.iap_id like '%clear_cell%' then 'Chum Chum Skills'
      when ${TABLE}.iap_id like '%clear_horizontal%' then 'Chum Chum Skills'
      when ${TABLE}.iap_id like '%clear_vertical%' then 'Chum Chum Skills'
      when ${TABLE}.iap_id = 'item_shuffle' then 'Chum Chum Skills'
      when ${TABLE}.iap_id = 'item_shuffle_bulk' then 'Chum Chum Skills'


      when ${TABLE}.iap_id like '%bomb%' then 'Pre-Game Boosts'
      when ${TABLE}.iap_id like '%rocket%' then 'Pre-Game Boosts'
      when ${TABLE}.iap_id like '%color_ball%' then 'Pre-Game Boosts'
      when ${TABLE}.iap_id like '%zone%' then 'Zone Restoration'
      when ${TABLE}.iap_id like '%extra_moves%' then 'Extra Moves'

      when ${TABLE}.iap_id = 'item_051' then 'Giant Power Up Pack!'

      when ${TABLE}.iap_id = 'item_052' then 'Chum Chums & Coins'
      when ${TABLE}.iap_id = 'item_054' then 'Chum Chums & Coins'
      when ${TABLE}.iap_id = 'item_053' then 'Chum Chums & Coins'
      when ${TABLE}.iap_id = 'item_075' then 'Chum Chums & Coins'


      when ${TABLE}.iap_id = 'item_055' then 'Coins'
      when ${TABLE}.iap_id = 'item_056' then 'Coins'
      when ${TABLE}.iap_id = 'item_057' then 'Coins'

      when ${TABLE}.iap_id = 'item_058' then 'Lives'
      when ${TABLE}.iap_id = 'item_059' then 'Lives'
      when ${TABLE}.iap_id = 'item_060' then 'Lives'

      when ${TABLE}.iap_id = 'item_063' then 'Treasure Trove'
      when ${TABLE}.iap_id = 'item_066' then 'Treasure Trove'
      when ${TABLE}.iap_id = 'item_069' then 'Treasure Trove'
      when ${TABLE}.iap_id = 'item_072' then 'Treasure Trove'

      when ${TABLE}.iap_id = 'item_076' then 'Magnifiers'
      when ${TABLE}.iap_id = 'item_077' then 'Magnifiers'
      when ${TABLE}.iap_id = 'item_078' then 'Magnifiers'

      when ${TABLE}.iap_id = 'item_089' then 'Level Bundle'
      when ${TABLE}.iap_id = 'item_090' then 'Level Bundle'
      when ${TABLE}.iap_id = 'item_091' then 'Level Bundle'
      when ${TABLE}.iap_id = 'item_092' then 'Level Bundle'

      when ${TABLE}.iap_id = 'battle_pass' then 'Premium Battle Pass'

      else ${TABLE}.iap_id
  end"
}



###################################################################
# In App Messenging
###################################################################

constant: iam_group {
  value: "
  case
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging.' then 'InAppMessage'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging.Close' then 'InAppMessage'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_CE.' then 'CE'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_Generic.' then 'Generic'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_MTXOffer.' then 'MTXOffer'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_MTXOffer.Close' then 'MTXOffer'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_NameChange.' then 'NameChange'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_Notifications.' then 'Notifications'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_Notifications.Close' then 'Notifications'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_RateUs.' then 'RateUs'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_RateUs.Close' then 'RateUs'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_RateUs.IAM' then 'RateUs'
    when ${TABLE}.button_tag = 'Sheet_InAppMessaging_TOTD.' then 'TOTD'
  else 'UnMapped'
  end"
}

constant: iam_conversion {
  value: "
  case
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging.' then 0
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging.Close' then 0
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_CE.' then 0
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_Generic.' then 0
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_MTXOffer.' then 1
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_MTXOffer.Close' then 0
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_NameChange.' then 0
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_Notifications.' then 1
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_Notifications.Close' then 0
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_RateUs.' then 1
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_RateUs.Close' then 0
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_RateUs.IAM' then 1
  when ${TABLE}.button_tag = 'Sheet_InAppMessaging_TOTD.' then 0
  else 0
  end"
}

###################################################################
# Coin Source Amounts and Naming
# Built here
# https://docs.google.com/spreadsheets/d/1cyAp3FG_nUTJ23NDNtqnv5zA_yR2zklUTLgMiOmozkc/edit?usp=sharing
# Ask Tal Kreuch for access
###################################################################

constant: coin_source_amount_override {
  value: "
    case
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_037' then 6000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_043' then 6000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_044' then 10000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_052' then 20000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_053' then 20000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_054' then 20000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_075' then 20000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_088' then 20000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_089' then 6000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_090' then 12000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_091' then 40000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_092' then 80000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_061' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_062' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_063' then 6000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_064' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_065' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_066' then 12000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_067' then 2000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_068' then 2000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_069' then 40000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_070' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_071' then 2000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_072' then 100000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_073' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_074' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_079' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_080' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_081' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_082' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_083' then 2000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_084' then 2000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_085' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_087' then 1000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_093' then 10000
       when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_094' then 40000
  else ${TABLE}.coin_source_amount
  end
  "
 }

constant: coin_source_name {
  value: "
  case

     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'zone_restore' then 'Zone Restore'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'initial_reward' then 'Initial Reward'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'lucky_dice' then 'Lucky Dice'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'incetivized_ads' then 'Pizza Time'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'daily_reward' then 'Daily Reward'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'global_leaderboard' then 'Legacy: Global Leaderboard'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_R2' then 'Legacy: Bingo'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_D1' then 'Legacy: Bingo'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'gacha_box_004' then 'Legacy: Gacha Box'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_D2' then 'Legacy: Bingo'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_R4' then 'Legacy: Bingo'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_C3' then 'Legacy: Bingo'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_R5' then 'Legacy: Bingo'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_C2' then 'Legacy: Bingo'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_C5' then 'Legacy: Bingo'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_R1' then 'Legacy: Bingo'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_R3' then 'Legacy: Bingo'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_C4' then 'Legacy: Bingo'

     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_campaign' then 'Campaign'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_movesMaster' then 'Moves Master'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_CAMPAIGN' then 'Campaign'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_puzzle' then 'Puzzle'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_challenge' then 'Challenge'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_showcase' then 'Showcase'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_helpRequest' then 'Help Request'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_LEADERBOARD' then 'Leaderboard'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_none' then 'None'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_cheat' then 'Cheat'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_CHEAT' then 'Cheat'

     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_057' then 'Coins (L)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_056' then 'Coins (M)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_055' then 'Coins (S)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_063' then 'Treasure Trove (XS)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_072' then 'Treasure Trove (L)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_066' then 'Treasure Trove (S)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_069' then 'Treasure Trove (M)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_092' then 'Level Bundle (400)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_053' then 'Horizontal Chum Chums & Coins Special!'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_054' then 'Vertical Chum Chums & Coins Special!'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_091' then 'Level Bundle (300)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_056' then 'Coins (M)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_052' then 'Hammer Chum Chums & Coins Special!'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_055' then 'Coins (S)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_075' then 'Shuffle Chum Chums & Coins Special!'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_066' then 'Treasure Trove (S)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_063' then 'Treasure Trove (XS)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_089' then 'Level Bundle (100)'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_090' then 'Level Bundle (200)'

     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'Daily Rewards' then 'Daily Reward'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_C1' then 'Legacy: Bingo'

    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'treasure_trove' then 'Treasure Trove (Free)'
    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'puzzle' then 'Puzzle (End)'
    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'flour_frenzy' then 'Flour Frenzy (End)'
    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'hotdog_contest' then 'Hotdog Contest (End)'
    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'moves_master' then 'Moves Master (End)'
    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'battle_pass' then 'Battle Pass'



    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source = 'round_end' then 'Round End'
    else 'Unmapped'
  end
  "
}

constant: coin_source_name_group {
  value: "
  case

     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'zone_restore' then 'Zone Restore'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'initial_reward' then 'Initial Reward'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'lucky_dice' then 'Live Ops'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'incetivized_ads' then 'Live Ops'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'daily_reward' then 'Live Ops'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'global_leaderboard' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_R2' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_D1' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'gacha_box_004' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_D2' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_R4' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_C3' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_R5' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_C2' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_C5' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_R1' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_R3' then 'Legacy'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_C4' then 'Legacy'

     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_campaign' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_movesMaster' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_CAMPAIGN' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_puzzle' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_challenge' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_showcase' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_helpRequest' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_LEADERBOARD' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_none' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_cheat' then 'Round End'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'round_end_CHEAT' then 'Round End'

     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_057' then 'Coins'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_056' then 'Coins'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_055' then 'Coins'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_063' then 'Treasure Trove'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_072' then 'Treasure Trove'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_066' then 'Treasure Trove'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_069' then 'Treasure Trove'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_092' then 'Level Bundle'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_053' then 'Chum Chums & Coins'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_054' then 'Chum Chums & Coins'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_091' then 'Level Bundle'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_056' then 'Coins'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_052' then 'Chum Chums & Coins'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_055' then 'Coins'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_075' then 'Chum Chums & Coins'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_066' then 'Treasure Trove'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_063' then 'Treasure Trove'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_089' then 'Level Bundle'
     when ${TABLE}.coin_source_type = 'transaction' and ${TABLE}.coin_source_iap_item = 'item_090' then 'Level Bundle'

     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'Daily Rewards' then 'Live Ops'
     when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'bingo_reward_C1' then 'Legacy'

    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'treasure_trove' then 'Treasure Trove'
    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'puzzle' then 'Live Ops'
    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'flour_frenzy' then 'Live Ops'
    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'hotdog_contest' then 'Live Ops'
    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'moves_master' then 'Live Ops'
    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source_iap_item = 'battle_pass' then 'Battle Pass'



    when ${TABLE}.coin_source_type = 'reward' and ${TABLE}.coin_source = 'round_end' then 'Round End'
  else 'Unmapped'
  end
  "
}

###################################################################
# Coin Spend Naming
# Built here
# https://docs.google.com/spreadsheets/d/1PPapHlIj-Nc9CQ0vhNCLJvQADUpXMmw8bWc0BTBhGJc/edit?usp=sharing
# Ask Tal Kreuch for access
###################################################################

constant: coin_spend_name {
  value: "
  case

    when ${TABLE}.source_id = 'extra_moves_7' and ${TABLE}.iap_id = 'extra_moves_7' then 'Extra Moves'
    when ${TABLE}.source_id = 'character' and ${TABLE}.iap_id = 'item_skillet_unlock' then 'Skillet'
    when ${TABLE}.source_id = 'extra_moves_10' and ${TABLE}.iap_id = 'extra_moves_10' then 'Extra Moves'
    when ${TABLE}.source_id = 'quick_skill_skillet' and ${TABLE}.iap_id = 'item_skillet_bulk' then 'Skillet'
    when ${TABLE}.source_id = 'quick_skill_chopsticks' and ${TABLE}.iap_id = 'item_chopsticks_bulk' then 'Chopsticks'
    when ${TABLE}.source_id = 'quick_skill_chopsticks' and ${TABLE}.iap_id = 'item_chopsticks' then 'Chopsticks'
    when ${TABLE}.source_id = 'request_help' and ${TABLE}.iap_id = 'request_help' then 'Request Help'
    when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'item_022' then 'Legacy'
    when ${TABLE}.source_id = 'quick_skill_skillet' and ${TABLE}.iap_id = 'item_skillet' then 'Skillet'
    when ${TABLE}.source_id = 'Panel_Store.Purchase.item_002' and ${TABLE}.iap_id = 'item_003' then 'Legacy'
    when ${TABLE}.source_id = 'Panel_Store.Purchase.item_002' and ${TABLE}.iap_id = 'item_002' then 'Legacy'
    when ${TABLE}.source_id = 'Panel_Store.Purchase.item_003' and ${TABLE}.iap_id = 'item_003' then 'Legacy'
    when ${TABLE}.source_id is null and ${TABLE}.iap_id = 'item_clear_cell' then 'Clear Cell'
    when ${TABLE}.source_id is null and ${TABLE}.iap_id = 'item_clear_horizontal' then 'Clear Horizontal'

   when ${TABLE}.source_id = 'extra_moves_5' and ${TABLE}.iap_id = 'extra_moves_5' then 'Extra Moves'
   when ${TABLE}.source_id = 'quick_lives' and ${TABLE}.iap_id = 'item_059' then 'Lives'
   when ${TABLE}.source_id = 'quick_lives' and ${TABLE}.iap_id = 'item_058' then 'Lives'
   when ${TABLE}.source_id = 'quick_lives' and ${TABLE}.iap_id = 'item_060' then 'Lives'
   when ${TABLE}.source_id = 'quick_skill_clear_cell' and ${TABLE}.iap_id = 'item_clear_cell' then 'Clear Cell'
   when ${TABLE}.source_id = 'quick_skill_clear_vertical' and ${TABLE}.iap_id = 'item_clear_vertical' then 'Clear Verticle'
   when ${TABLE}.source_id = 'quick_skill_clear_horizontal' and ${TABLE}.iap_id = 'item_clear_horizontal' then 'Clear Horizontal'
   when ${TABLE}.source_id = 'quick_skill_clear_vertical' and ${TABLE}.iap_id = 'item_clear_vertical_bulk' then 'Clear Verticle'
   when ${TABLE}.source_id = 'quick_magnifiers' and ${TABLE}.iap_id = 'item_077' then 'Magnifiers'
   when ${TABLE}.source_id = 'quick_skill_clear_horizontal' and ${TABLE}.iap_id = 'item_clear_horizontal_bulk' then 'Clear Horizontal'
   when ${TABLE}.source_id = 'quick_boost_color_ball' and ${TABLE}.iap_id = 'item_color_ball_bulk' then 'Color Ball'
   when ${TABLE}.source_id = 'quick_skill_clear_cell' and ${TABLE}.iap_id = 'item_clear_cell_bulk' then 'Clear Cell'
   when ${TABLE}.source_id = 'quick_boost_color_ball' and ${TABLE}.iap_id = 'item_color_ball' then 'Color Ball'
   when ${TABLE}.source_id = 'quick_boost_bomb' and ${TABLE}.iap_id = 'item_bomb' then 'Bomb'
   when ${TABLE}.source_id = 'quick_boost_bomb' and ${TABLE}.iap_id = 'item_bomb_bulk' then 'Bomb'
   when ${TABLE}.source_id = 'quick_magnifiers' and ${TABLE}.iap_id = 'item_078' then 'Magnifiers'
   when ${TABLE}.source_id = 'quick_boost_rocket' and ${TABLE}.iap_id = 'item_rocket' then 'Rocket'
   when ${TABLE}.source_id = 'quick_skill_shuffle' and ${TABLE}.iap_id = 'item_shuffle' then 'Shuffle'
   when ${TABLE}.source_id = 'quick_boost_rocket' and ${TABLE}.iap_id = 'item_rocket_bulk' then 'Rocket'
   when ${TABLE}.source_id = 'quick_skill_shuffle' and ${TABLE}.iap_id = 'item_shuffle_bulk' then 'Shuffle'
   when ${TABLE}.source_id = 'character' and ${TABLE}.iap_id = 'item_chopsticks_unlock' then 'Chopsticks'
   when ${TABLE}.source_id = 'quick_magnifiers' and ${TABLE}.iap_id = 'item_076' then 'Magnifiers'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_clear_vertical' then 'Clear Verticle'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_clear_horizontal' then 'Clear Horizontal'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_clear_cell' then 'Clear Cell'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_color_ball' then 'Color Ball'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_rocket' then 'Rocket'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_003' and ${TABLE}.iap_id = 'box_001' then 'Legacy'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_bomb' then 'Bomb'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_002' and ${TABLE}.iap_id = 'box_007' then 'Legacy'
   when ${TABLE}.source_id = 'COLOR_BALL' and ${TABLE}.iap_id = '' then 'Color Ball'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.FIVE_TO_FOUR' and ${TABLE}.iap_id = 'boost_006' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_019' and ${TABLE}.iap_id = 'box_002' then 'Legacy'
   when ${TABLE}.source_id = 'BOMB' and ${TABLE}.iap_id = '' then 'Bomb'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.BUBBLE' and ${TABLE}.iap_id = 'boost_005' then 'Legacy'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'clear_vertical' then 'Clear Verticle'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'clear_horizontal' then 'Clear Horizontal'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'box_006' then 'Legacy'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'COLOR_BALL' then 'Color Ball'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'clear_cell' then 'Clear Cell'
   when ${TABLE}.source_id = 'ROCKET' and ${TABLE}.iap_id = '' then 'Rocket'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.TIME' and ${TABLE}.iap_id = 'boost_004' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.EXP' and ${TABLE}.iap_id = 'boost_003' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.COIN' and ${TABLE}.iap_id = 'boost_002' then 'Legacy'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'ROCKET' then 'Rocket'
   when ${TABLE}.source_id = 'clear_cell' and ${TABLE}.iap_id = '' then 'Clear Cell'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.SCORE' and ${TABLE}.iap_id = 'boost_001' then 'Legacy'
   when ${TABLE}.source_id = 'clear_horizontal' and ${TABLE}.iap_id = '' then 'Clear Horizontal'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'BOMB' then 'Bomb'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'box_006' then 'Legacy'
   when ${TABLE}.source_id = 'clear_vertical' and ${TABLE}.iap_id = '' then 'Clear Verticle'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'box_002' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'box_002' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_002' and ${TABLE}.iap_id = 'box_006' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'item_019' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_002' and ${TABLE}.iap_id = 'box_002' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'box_007' then 'Legacy'
   when ${TABLE}.source_id = 'BUBBLE' and ${TABLE}.iap_id = '' then 'Legacy'
   when ${TABLE}.source_id = 'FIVE_TO_FOUR' and ${TABLE}.iap_id = '' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'box_001' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'box_007' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'item_003' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'item_003' then 'Legacy'
   when ${TABLE}.source_id = 'TIME' and ${TABLE}.iap_id = '' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'item_002' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_018' and ${TABLE}.iap_id = 'box_007' then 'Legacy'
   when ${TABLE}.source_id = 'FIVE_TO_FOUR' and ${TABLE}.iap_id = 'boost_006' then 'Legacy'
   when ${TABLE}.source_id = 'BUBBLE' and ${TABLE}.iap_id = 'boost_005' then 'Legacy'
   when ${TABLE}.source_id = 'TIME' and ${TABLE}.iap_id = 'boost_004' then 'Legacy'

  else 'Unmapped'
  end
  "
}

constant: coin_spend_name_group {
  value: "
  case

    when ${TABLE}.source_id = 'extra_moves_7' and ${TABLE}.iap_id = 'extra_moves_7' then 'Extra Moves'
    when ${TABLE}.source_id = 'character' and ${TABLE}.iap_id = 'item_skillet_unlock' then 'New Chum Chum'
    when ${TABLE}.source_id = 'extra_moves_10' and ${TABLE}.iap_id = 'extra_moves_10' then 'Extra Moves'
    when ${TABLE}.source_id = 'quick_skill_skillet' and ${TABLE}.iap_id = 'item_skillet_bulk' then 'Chum Chum Skill'
    when ${TABLE}.source_id = 'quick_skill_chopsticks' and ${TABLE}.iap_id = 'item_chopsticks_bulk' then 'Chum Chum Skill'
    when ${TABLE}.source_id = 'quick_skill_chopsticks' and ${TABLE}.iap_id = 'item_chopsticks' then 'Chum Chum Skill'
    when ${TABLE}.source_id = 'request_help' and ${TABLE}.iap_id = 'request_help' then 'Ask For Help'
    when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'item_022' then 'Legacy'
    when ${TABLE}.source_id = 'quick_skill_skillet' and ${TABLE}.iap_id = 'item_skillet' then 'Chum Chum Skill'
    when ${TABLE}.source_id = 'Panel_Store.Purchase.item_002' and ${TABLE}.iap_id = 'item_003' then 'Legacy'
    when ${TABLE}.source_id = 'Panel_Store.Purchase.item_002' and ${TABLE}.iap_id = 'item_002' then 'Legacy'
    when ${TABLE}.source_id = 'Panel_Store.Purchase.item_003' and ${TABLE}.iap_id = 'item_003' then 'Legacy'
    when ${TABLE}.source_id is null and ${TABLE}.iap_id = 'item_clear_cell' then 'Chum Chum Skill'
    when ${TABLE}.source_id is null and ${TABLE}.iap_id = 'item_clear_horizontal' then 'Chum Chum Skill'

   when ${TABLE}.source_id = 'extra_moves_5' and ${TABLE}.iap_id = 'extra_moves_5' then 'Extra Moves'
   when ${TABLE}.source_id = 'quick_lives' and ${TABLE}.iap_id = 'item_059' then 'Lives'
   when ${TABLE}.source_id = 'quick_lives' and ${TABLE}.iap_id = 'item_058' then 'Lives'
   when ${TABLE}.source_id = 'quick_lives' and ${TABLE}.iap_id = 'item_060' then 'Lives'
   when ${TABLE}.source_id = 'quick_skill_clear_cell' and ${TABLE}.iap_id = 'item_clear_cell' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'quick_skill_clear_vertical' and ${TABLE}.iap_id = 'item_clear_vertical' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'quick_skill_clear_horizontal' and ${TABLE}.iap_id = 'item_clear_horizontal' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'quick_skill_clear_vertical' and ${TABLE}.iap_id = 'item_clear_vertical_bulk' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'quick_magnifiers' and ${TABLE}.iap_id = 'item_077' then 'Magnifiers'
   when ${TABLE}.source_id = 'quick_skill_clear_horizontal' and ${TABLE}.iap_id = 'item_clear_horizontal_bulk' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'quick_boost_color_ball' and ${TABLE}.iap_id = 'item_color_ball_bulk' then 'Boost'
   when ${TABLE}.source_id = 'quick_skill_clear_cell' and ${TABLE}.iap_id = 'item_clear_cell_bulk' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'quick_boost_color_ball' and ${TABLE}.iap_id = 'item_color_ball' then 'Boost'
   when ${TABLE}.source_id = 'quick_boost_bomb' and ${TABLE}.iap_id = 'item_bomb' then 'Boost'
   when ${TABLE}.source_id = 'quick_boost_bomb' and ${TABLE}.iap_id = 'item_bomb_bulk' then 'Boost'
   when ${TABLE}.source_id = 'quick_magnifiers' and ${TABLE}.iap_id = 'item_078' then 'Magnifiers'
   when ${TABLE}.source_id = 'quick_boost_rocket' and ${TABLE}.iap_id = 'item_rocket' then 'Boost'
   when ${TABLE}.source_id = 'quick_skill_shuffle' and ${TABLE}.iap_id = 'item_shuffle' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'quick_boost_rocket' and ${TABLE}.iap_id = 'item_rocket_bulk' then 'Boost'
   when ${TABLE}.source_id = 'quick_skill_shuffle' and ${TABLE}.iap_id = 'item_shuffle_bulk' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'character' and ${TABLE}.iap_id = 'item_chopsticks_unlock' then 'New Chum Chum'
   when ${TABLE}.source_id = 'quick_magnifiers' and ${TABLE}.iap_id = 'item_076' then 'Magnifiers'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_clear_vertical' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_clear_horizontal' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_clear_cell' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_color_ball' then 'Boost'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_rocket' then 'Boost'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_003' and ${TABLE}.iap_id = 'box_001' then 'Legacy'
   when ${TABLE}.source_id = 'auto_purchase' and ${TABLE}.iap_id = 'item_bomb' then 'Boost'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_002' and ${TABLE}.iap_id = 'box_007' then 'Legacy'
   when ${TABLE}.source_id = 'COLOR_BALL' and ${TABLE}.iap_id = '' then 'Boost'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.FIVE_TO_FOUR' and ${TABLE}.iap_id = 'boost_006' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_019' and ${TABLE}.iap_id = 'box_002' then 'Legacy'
   when ${TABLE}.source_id = 'BOMB' and ${TABLE}.iap_id = '' then 'Boost'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.BUBBLE' and ${TABLE}.iap_id = 'boost_005' then 'Legacy'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'clear_vertical' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'clear_horizontal' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'box_006' then 'Legacy'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'COLOR_BALL' then 'Boost'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'clear_cell' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'ROCKET' and ${TABLE}.iap_id = '' then 'Boost'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.TIME' and ${TABLE}.iap_id = 'boost_004' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.EXP' and ${TABLE}.iap_id = 'boost_003' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.COIN' and ${TABLE}.iap_id = 'boost_002' then 'Legacy'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'ROCKET' then 'Boost'
   when ${TABLE}.source_id = 'clear_cell' and ${TABLE}.iap_id = '' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'Panel_Boosts_V3.BoostUI.SCORE' and ${TABLE}.iap_id = 'boost_001' then 'Legacy'
   when ${TABLE}.source_id = 'clear_horizontal' and ${TABLE}.iap_id = '' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'Sheet_Boost_Purchase' and ${TABLE}.iap_id = 'BOMB' then 'Boost'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'box_006' then 'Legacy'
   when ${TABLE}.source_id = 'clear_vertical' and ${TABLE}.iap_id = '' then 'Chum Chum Skill'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'box_002' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'box_002' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_002' and ${TABLE}.iap_id = 'box_006' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'item_019' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_002' and ${TABLE}.iap_id = 'box_002' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'box_007' then 'Legacy'
   when ${TABLE}.source_id = 'BUBBLE' and ${TABLE}.iap_id = '' then 'Legacy'
   when ${TABLE}.source_id = 'FIVE_TO_FOUR' and ${TABLE}.iap_id = '' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'box_001' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'box_007' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_001' and ${TABLE}.iap_id = 'item_003' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'item_003' then 'Legacy'
   when ${TABLE}.source_id = 'TIME' and ${TABLE}.iap_id = '' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_017' and ${TABLE}.iap_id = 'item_002' then 'Legacy'
   when ${TABLE}.source_id = 'Panel_Store.Purchase.item_018' and ${TABLE}.iap_id = 'box_007' then 'Legacy'
   when ${TABLE}.source_id = 'FIVE_TO_FOUR' and ${TABLE}.iap_id = 'boost_006' then 'Legacy'
   when ${TABLE}.source_id = 'BUBBLE' and ${TABLE}.iap_id = 'boost_005' then 'Legacy'
   when ${TABLE}.source_id = 'TIME' and ${TABLE}.iap_id = 'boost_004' then 'Legacy'


  else 'Unmapped'
  end
  "
}


###################################################################
# Singular Creative Mapping
# Simplified Ad Name
###################################################################

constant: singular_creative_simplified_ad_name {
  value: "
  case

    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_16x9_EN.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_16x9_ES.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_16x9_ptBR.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_3x4_EN.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_3x4_ES.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_3x4_ptBR.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_9x16_EN.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_9x16_ES.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_9x16_ptBR.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_9x19-5_EN.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_9x19-5_ES.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'ASOTrailer_30s_9x19-5_ptBR.mp4' then 'ASO Trailer'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-AsianBaby_25s_1x1_EN.mp4' then 'AsianBaby'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-AsianBaby_25s_9x16_EN.mp4' then 'AsianBaby'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-GirlWithCats_25s_1x1_EN.mp4' then 'GirlWithCats'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-GirlWithCats_25s_9x16_EN.mp4' then 'GirlWithCats'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-HandsomeMan-v01_25s_1x1_EN.mp4' then 'HansomeMan_001'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-HandsomeMan-v01_25s_9x16_EN.mp4' then 'HansomeMan_001'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-HandsomeMan-v02_25s_1x1_EN.mp4' then 'HansomeMan_002'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-HandsomeMan-v02_25s_9x16_EN.mp4' then 'HansomeMan_002'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-LadyBossWithCats_25s_1x1_EN.mp4' then 'LadyBossWithCats'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-LadyBossWithCats_25s_9x16_EN.mp4' then 'LadyBossWithCats'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-LadyBossWithDogs_25s_1x1_EN.mp4' then 'LadyBossWithDogs'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-LadyBossWithDogs_25s_9x16_EN.mp4' then 'LadyBossWithDogs'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-LoungingWithCats_25s_1x1_EN.mp4' then 'LoungingWithCats'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-LoungingWithCats_25s_9x16_EN.mp4' then 'LoungingWithCats'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-LoungingWithSheep_25s_1x1_EN.mp4' then 'LoungingWithSheep'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-LoungingWithSheep_25s_9x16_EN.mp4' then 'LoungingWithSheep'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-ManOnHorse_25s_1x1_EN.mp4' then 'ManOnHorse'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-ManOnHorse_25s_9x16_EN.mp4' then 'ManOnHorse'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-ManWithHorse_25s_1x1_EN.mp4' then 'ManWithHorse'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-ManWithHorse_25s_9x16_EN.mp4' then 'ManWithHorse'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-PunkAsianGrandma-v01_25s_9x16_EN.mp4' then 'PunkAsianGrandma_001'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-PunkAsianGrandma-v02_25s_9x16_EN.mp4' then 'PunkAsianGrandma_002'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-SpinWithKoala_25s_9x16_EN.mp4' then 'SpinWithKoala'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-SpinWithSloth_25s_1x1_EN.mp4' then 'SpinWithSloth'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-SpinWithSloth_25s_9x16_EN.mp4' then 'SpinWithSloth'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-YogaWithSloth-v01_25s_1x1_EN.mp4' then 'YogaWithSloth_001'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-YogaWithSloth-v01_25s_9x16_EN.mp4' then 'YogaWithSloth_001'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-YogaWithSloth-v02_25s_1x1_EN.mp4' then 'YogaWithSloth_002'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-YogaWithSloth-v02_25s_9x16_EN.mp4' then 'YogaWithSloth_002'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-v01_25s_1x1_EN.mp4' then 'TestimonialAI-v01'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI-v02_25s_1x1_EN.mp4' then 'TestimonialAI-v02'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_TestimonialAI_25s_1x1_EN.mp4' then 'Testimonial'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_Testimonial_30s_16x9_EN.mp4' then 'Testimonial'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_Testimonial_30s_16x9_ES.mp4' then 'Testimonial'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_Testimonial_30s_1x1_EN.mp4' then 'Testimonial'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_Testimonial_30s_1x1_ES.mp4' then 'Testimonial'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_Testimonial_30s_4x5_ES.mp4' then 'Testimonial'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_Testimonial_30s_9x16_EN.mp4' then 'Testimonial'
    when ${TABLE}.full_ad_name = 'CCB_Airtraffic_Testimonial_30s_9x16_ES.mp4' then 'Testimonial'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_APVUpdate_30s_16x9_EN.mp4' then 'APVUpdate'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_APVUpdate_30s_16x9_ES.mp4' then 'APVUpdate'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_APVUpdate_30s_3x4_EN.mp4' then 'APVUpdate'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_APVUpdate_30s_3x4_ES.mp4' then 'APVUpdate'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_APVUpdate_30s_9x16_EN.mp4' then 'APVUpdate'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_APVUpdate_30s_9x16_ES.mp4' then 'APVUpdate'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_APVUpdate_30s_9x19.5_ES.mp4' then 'APVUpdate'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_16x9_EN.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_16x9_ES.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_16x9_PTBR.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_1x1_EN.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_1x1_ES.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_1x1_PTBR.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_4x5_EN.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_4x5_ES.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_4x5_PTBR.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_9x16_EN.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_9x16_ES.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_Chef_26s_9x16_PTBR.mp4' then 'Chef'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_ElevatorDangerous_30s_16x9_EN.mp4' then 'ElevatorDangerous'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_ElevatorDangerous_30s_1x1_EN.mp4' then 'ElevatorDangerous'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_ElevatorDangerous_30s_9x16_EN.mp4' then 'ElevatorDangerous'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_16x9_EN.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_16x9_ES.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_16x9_PTBR.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_1x1_EN.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_1x1_ES.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_1x1_PTBR.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_4x5_EN.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_4x5_ES.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_4x5_PTBR.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_9x16_EN.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_9x16_ES.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_SassyDog_30s_9x16_PTBR.mp4' then 'SassyDog'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_TiltingTable_25s_16x9_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_TiltingTable_25s_1x1_EN.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_TiltingTable_25s_1x1_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_TiltingTable_25s_9x16_EN.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_Airtraffic_TiltingTable_25s_9x16_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_SimpleMatch_1080x1080_23s_ES.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'EB_SimpleMatch_1080x1080_23s_PTBR.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'EB_SimpleMatch_1080x1350_23s_ES.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'EB_SimpleMatch_1080x1350_23s_PTBR.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'EB_SimpleMatch_1080x1920_23s_ES.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'EB_SimpleMatch_1080x1920_23s_PTBR.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'EB_SimpleMatch_1920x1080_23s_ES.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'EB_SimpleMatch_1920x1080_23s_PTBR.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'EB_TTC_1080_1080.mp4' then 'TTC'
    when ${TABLE}.full_ad_name = 'EB_TTC_1080_1080_BR.mp4' then 'TTC'
    when ${TABLE}.full_ad_name = 'EB_TTC_1080_1350.mp4' then 'TTC'
    when ${TABLE}.full_ad_name = 'EB_TTC_1080_1350_BR.mp4' then 'TTC'
    when ${TABLE}.full_ad_name = 'EB_TTC_1080_1920.mp4' then 'TTC'
    when ${TABLE}.full_ad_name = 'EB_TTC_1080_1920_BR.mp4' then 'TTC'
    when ${TABLE}.full_ad_name = 'EB_TTC_1920_1080.mp4' then 'TTC'
    when ${TABLE}.full_ad_name = 'EB_TTC_1920_1080_BR.mp4' then 'TTC'
    when ${TABLE}.full_ad_name = 'EB_TiltingTable_25s_16x9_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_TiltingTable_25s_16x9_PT-BR.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_TiltingTable_25s_1x1_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_TiltingTable_25s_1x1_PT-BR.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_TiltingTable_25s_4x5_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_TiltingTable_25s_4x5_PT-BR.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_TiltingTable_25s_9x16_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_TiltingTable_25s_9x16_PT-BR.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'EB_Zen_1080_1080_30.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'EB_Zen_1080_1080_BR.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'EB_Zen_1080_1350_30.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'EB_Zen_1080_1350_BR.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'EB_Zen_1080_1920_30.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'EB_Zen_1080_1920_BR.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'EB_Zen_1920_1080_30.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'EB_Zen_1920_1080_BR.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Elevator_30s_16x9_EN.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_16x9_ES.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_16x9_ptBR.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_1x1_EN.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_1x1_ES.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_1x1_ptBR.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_4x5_EN.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_4x5_ES.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_4x5_ptBR.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_9x16_EN.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_9x16_ES.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Elevator_30s_9x16_ptBR.mp4' then 'Elevator'
    when ${TABLE}.full_ad_name = 'Match3_1080_1080_BR.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1080_1080_EN.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1080_1080_ES.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1080_1350_BR.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1080_1350_EN.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1080_1350_ES.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1080_1920_BR.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1080_1920_EN.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1080_1920_ES.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1920_1080_BR.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1920_1080_EN.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'Match3_1920_1080_ES.mp4' then 'Match3'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_16x9_EN.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_16x9_ES.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_16x9_ptBR.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_1x1_EN.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_1x1_ES.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_1x1_ptBR.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_4x5_EN.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_4x5_ES.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_4x5_ptBR.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_9x16_EN.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_9x16_ES.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleBlast_30s_9x16_ptBR.mp4' then 'SimpleBlast'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_16x9_EN.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_16x9_ES.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_16x9_ptBR.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_1x1_EN.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_1x1_ES.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_1x1_ptBR.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_4x5_EN.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_4x5_ES.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_4x5_ptBR.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_9x16_EN.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_9x16_ES.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'SimpleMatch_23s_9x16_ptBR.mp4' then 'SimpleMatch'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_16x9_EN.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_16x9_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_16x9_ptBR.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_1x1_EN.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_1x1_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_1x1_ptBR.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_4x5_EN.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_4x5_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_4x5_ptBR.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_9x16_EN.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_9x16_ES.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'TiltingTable_25s_9x16_ptBR.mp4' then 'TiltingTable'
    when ${TABLE}.full_ad_name = 'WeirdTeddyBear_EN.mp4' then 'WeirdTeddyBear'
    when ${TABLE}.full_ad_name = 'WeirdTeddyBear_ES.mp4' then 'WeirdTeddyBear'
    when ${TABLE}.full_ad_name = 'WeirdTeddyDog_ES.mp4' then 'WeirdTeddyDog'
    when ${TABLE}.full_ad_name = 'WeirdTreats_ES.mp4' then 'WeirdTreats'
    when ${TABLE}.full_ad_name = 'Zen_1080_1080_BR.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1080_1080_EN.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1080_1080_ES.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1080_1350_BR.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1080_1350_EN.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1080_1350_ES.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1080_1920_BR.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1080_1920_EN.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1080_1920_ES.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1920_1080_BR.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1920_1080_EN.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'Zen_1920_1080_ES.mp4' then 'Zen'
    when ${TABLE}.full_ad_name = 'cropped_1X1_(x, y)_(0, 342)_width_2048px_height_2048px_EB_Airtraffic_APVUpdate_30s_3x4_ES.mp4' then 'APVUpdate'



  else 'Unmapped'
  end
  "
}

###################################################################
# Battle Pass Number
###################################################################

# Created using this file
# Ask Tal Kreuch for access
# https://docs.google.com/spreadsheets/d/1IkAchnFFhkoxvtLkTmTVN023P6P0pUcNPOcToNBZVHU/edit?usp=sharing

constant: battle_pass_number {
  value: "
  case

    when date(${TABLE}.rdg_date) >= '2023-08-03' and date(${TABLE}.rdg_date) < '2023-09-01' then 'bp_2023_08'
    when date(${TABLE}.rdg_date) >= '2023-09-03' and date(${TABLE}.rdg_date) < '2023-10-01' then 'bp_2023_09'
    when date(${TABLE}.rdg_date) >= '2023-10-02' and date(${TABLE}.rdg_date) < '2023-11-01' then 'bp_2023_10'
    when date(${TABLE}.rdg_date) >= '2023-11-02' and date(${TABLE}.rdg_date) < '2023-12-01' then 'bp_2023_11'
    when date(${TABLE}.rdg_date) >= '2023-12-02' and date(${TABLE}.rdg_date) < '2024-01-01' then 'bp_2023_12'
    when date(${TABLE}.rdg_date) >= '2024-01-02' and date(${TABLE}.rdg_date) < '2024-02-01' then 'bp_2024_01'
    when date(${TABLE}.rdg_date) >= '2024-02-02' and date(${TABLE}.rdg_date) < '2024-03-01' then 'bp_2024_02'
    when date(${TABLE}.rdg_date) >= '2024-03-02' and date(${TABLE}.rdg_date) < '2024-04-01' then 'bp_2024_03'
    when date(${TABLE}.rdg_date) >= '2024-04-02' and date(${TABLE}.rdg_date) < '2024-05-01' then 'bp_2024_04'
    when date(${TABLE}.rdg_date) >= '2024-05-02' and date(${TABLE}.rdg_date) < '2024-06-01' then 'bp_2024_05'
    when date(${TABLE}.rdg_date) >= '2024-06-02' and date(${TABLE}.rdg_date) < '2024-07-01' then 'bp_2024_06'
    when date(${TABLE}.rdg_date) >= '2024-07-02' and date(${TABLE}.rdg_date) < '2024-08-01' then 'bp_2024_07'
    when date(${TABLE}.rdg_date) >= '2024-08-02' and date(${TABLE}.rdg_date) < '2024-09-01' then 'bp_2024_08'
    when date(${TABLE}.rdg_date) >= '2024-09-02' and date(${TABLE}.rdg_date) < '2024-10-01' then 'bp_2024_09'
    when date(${TABLE}.rdg_date) >= '2024-10-02' and date(${TABLE}.rdg_date) < '2024-11-01' then 'bp_2024_10'
    when date(${TABLE}.rdg_date) >= '2024-11-02' and date(${TABLE}.rdg_date) < '2024-12-01' then 'bp_2024_11'
    when date(${TABLE}.rdg_date) >= '2024-12-02' and date(${TABLE}.rdg_date) < '2025-01-01' then 'bp_2024_12'
    when date(${TABLE}.rdg_date) >= '2025-01-02' and date(${TABLE}.rdg_date) < '2025-02-01' then 'bp_2025_01'
    when date(${TABLE}.rdg_date) >= '2025-02-02' and date(${TABLE}.rdg_date) < '2025-03-01' then 'bp_2025_02'
    when date(${TABLE}.rdg_date) >= '2025-03-02' and date(${TABLE}.rdg_date) < '2025-04-01' then 'bp_2025_03'
    when date(${TABLE}.rdg_date) >= '2025-04-02' and date(${TABLE}.rdg_date) < '2025-05-01' then 'bp_2025_04'
    when date(${TABLE}.rdg_date) >= '2025-05-02' and date(${TABLE}.rdg_date) < '2025-06-01' then 'bp_2025_05'
    when date(${TABLE}.rdg_date) >= '2025-06-02' and date(${TABLE}.rdg_date) < '2025-07-01' then 'bp_2025_06'
    when date(${TABLE}.rdg_date) >= '2025-07-02' and date(${TABLE}.rdg_date) < '2025-08-01' then 'bp_2025_07'
    when date(${TABLE}.rdg_date) >= '2025-08-02' and date(${TABLE}.rdg_date) < '2025-09-01' then 'bp_2025_08'
    when date(${TABLE}.rdg_date) >= '2025-09-02' and date(${TABLE}.rdg_date) < '2025-10-01' then 'bp_2025_09'
    when date(${TABLE}.rdg_date) >= '2025-10-02' and date(${TABLE}.rdg_date) < '2025-11-01' then 'bp_2025_10'
    when date(${TABLE}.rdg_date) >= '2025-11-02' and date(${TABLE}.rdg_date) < '2025-12-01' then 'bp_2025_11'
    when date(${TABLE}.rdg_date) >= '2025-12-02' and date(${TABLE}.rdg_date) < '2026-01-01' then 'bp_2025_12'
    when date(${TABLE}.rdg_date) >= '2026-01-02' and date(${TABLE}.rdg_date) < '2026-02-01' then 'bp_2026_01'
    when date(${TABLE}.rdg_date) >= '2026-02-02' and date(${TABLE}.rdg_date) < '2026-03-01' then 'bp_2026_02'
    when date(${TABLE}.rdg_date) >= '2026-03-02' and date(${TABLE}.rdg_date) < '2026-04-01' then 'bp_2026_03'
    when date(${TABLE}.rdg_date) >= '2026-04-02' and date(${TABLE}.rdg_date) < '2026-05-01' then 'bp_2026_04'
    when date(${TABLE}.rdg_date) >= '2026-05-02' and date(${TABLE}.rdg_date) < '2026-06-01' then 'bp_2026_05'
    when date(${TABLE}.rdg_date) >= '2026-06-02' and date(${TABLE}.rdg_date) < '2026-07-01' then 'bp_2026_06'
    when date(${TABLE}.rdg_date) >= '2026-07-02' and date(${TABLE}.rdg_date) < '2026-08-01' then 'bp_2026_07'
    when date(${TABLE}.rdg_date) >= '2026-08-02' and date(${TABLE}.rdg_date) < '2026-09-01' then 'bp_2026_08'
    when date(${TABLE}.rdg_date) >= '2026-09-02' and date(${TABLE}.rdg_date) < '2026-10-01' then 'bp_2026_09'
    when date(${TABLE}.rdg_date) >= '2026-10-02' and date(${TABLE}.rdg_date) < '2026-11-01' then 'bp_2026_10'
    when date(${TABLE}.rdg_date) >= '2026-11-02' and date(${TABLE}.rdg_date) < '2026-12-01' then 'bp_2026_11'
    when date(${TABLE}.rdg_date) >= '2026-12-02' and date(${TABLE}.rdg_date) < '2027-01-01' then 'bp_2026_12'
    when date(${TABLE}.rdg_date) >= '2027-01-02' and date(${TABLE}.rdg_date) < '2027-02-01' then 'bp_2027_01'
    when date(${TABLE}.rdg_date) >= '2027-02-02' and date(${TABLE}.rdg_date) < '2027-03-01' then 'bp_2027_02'
    when date(${TABLE}.rdg_date) >= '2027-03-02' and date(${TABLE}.rdg_date) < '2027-04-01' then 'bp_2027_03'
    when date(${TABLE}.rdg_date) >= '2027-04-02' and date(${TABLE}.rdg_date) < '2027-05-01' then 'bp_2027_04'
    when date(${TABLE}.rdg_date) >= '2027-05-02' and date(${TABLE}.rdg_date) < '2027-06-01' then 'bp_2027_05'
    when date(${TABLE}.rdg_date) >= '2027-06-02' and date(${TABLE}.rdg_date) < '2027-07-01' then 'bp_2027_06'
    when date(${TABLE}.rdg_date) >= '2027-07-02' and date(${TABLE}.rdg_date) < '2027-08-01' then 'bp_2027_07'
    when date(${TABLE}.rdg_date) >= '2027-08-02' and date(${TABLE}.rdg_date) < '2027-09-01' then 'bp_2027_08'
    when date(${TABLE}.rdg_date) >= '2027-09-02' and date(${TABLE}.rdg_date) < '2027-10-01' then 'bp_2027_09'
    when date(${TABLE}.rdg_date) >= '2027-10-02' and date(${TABLE}.rdg_date) < '2027-11-01' then 'bp_2027_10'
    when date(${TABLE}.rdg_date) >= '2027-11-02' and date(${TABLE}.rdg_date) < '2027-12-01' then 'bp_2027_11'
    when date(${TABLE}.rdg_date) >= '2027-12-02' and date(${TABLE}.rdg_date) < '2028-01-01' then 'bp_2027_12'
    when date(${TABLE}.rdg_date) >= '2028-01-02' and date(${TABLE}.rdg_date) < '2028-02-01' then 'bp_2028_01'
    when date(${TABLE}.rdg_date) >= '2028-02-02' and date(${TABLE}.rdg_date) < '2028-03-01' then 'bp_2028_02'
    when date(${TABLE}.rdg_date) >= '2028-03-02' and date(${TABLE}.rdg_date) < '2028-04-01' then 'bp_2028_03'
    when date(${TABLE}.rdg_date) >= '2028-04-02' and date(${TABLE}.rdg_date) < '2028-05-01' then 'bp_2028_04'
    when date(${TABLE}.rdg_date) >= '2028-05-02' and date(${TABLE}.rdg_date) < '2028-06-01' then 'bp_2028_05'
    when date(${TABLE}.rdg_date) >= '2028-06-02' and date(${TABLE}.rdg_date) < '2028-07-01' then 'bp_2028_06'
    when date(${TABLE}.rdg_date) >= '2028-07-02' and date(${TABLE}.rdg_date) < '2028-08-01' then 'bp_2028_07'
    when date(${TABLE}.rdg_date) >= '2028-08-02' and date(${TABLE}.rdg_date) < '2028-09-01' then 'bp_2028_08'
    when date(${TABLE}.rdg_date) >= '2028-09-02' and date(${TABLE}.rdg_date) < '2028-10-01' then 'bp_2028_09'
    when date(${TABLE}.rdg_date) >= '2028-10-02' and date(${TABLE}.rdg_date) < '2028-11-01' then 'bp_2028_10'
    when date(${TABLE}.rdg_date) >= '2028-11-02' and date(${TABLE}.rdg_date) < '2028-12-01' then 'bp_2028_11'
    when date(${TABLE}.rdg_date) >= '2028-12-02' and date(${TABLE}.rdg_date) < '2029-01-01' then 'bp_2028_12'
    when date(${TABLE}.rdg_date) >= '2029-01-02' and date(${TABLE}.rdg_date) < '2029-02-01' then 'bp_2029_01'
    when date(${TABLE}.rdg_date) >= '2029-02-02' and date(${TABLE}.rdg_date) < '2029-03-01' then 'bp_2029_02'
    when date(${TABLE}.rdg_date) >= '2029-03-02' and date(${TABLE}.rdg_date) < '2029-04-01' then 'bp_2029_03'
    when date(${TABLE}.rdg_date) >= '2029-04-02' and date(${TABLE}.rdg_date) < '2029-05-01' then 'bp_2029_04'
    when date(${TABLE}.rdg_date) >= '2029-05-02' and date(${TABLE}.rdg_date) < '2029-06-01' then 'bp_2029_05'
    when date(${TABLE}.rdg_date) >= '2029-06-02' and date(${TABLE}.rdg_date) < '2029-07-01' then 'bp_2029_06'
    when date(${TABLE}.rdg_date) >= '2029-07-02' and date(${TABLE}.rdg_date) < '2029-08-01' then 'bp_2029_07'
    when date(${TABLE}.rdg_date) >= '2029-08-02' and date(${TABLE}.rdg_date) < '2029-09-01' then 'bp_2029_08'
    when date(${TABLE}.rdg_date) >= '2029-09-02' and date(${TABLE}.rdg_date) < '2029-10-01' then 'bp_2029_09'
    when date(${TABLE}.rdg_date) >= '2029-10-02' and date(${TABLE}.rdg_date) < '2029-11-01' then 'bp_2029_10'
    when date(${TABLE}.rdg_date) >= '2029-11-02' and date(${TABLE}.rdg_date) < '2029-12-01' then 'bp_2029_11'
    when date(${TABLE}.rdg_date) >= '2029-12-02' and date(${TABLE}.rdg_date) < '2030-01-01' then 'bp_2029_12'

  else 'Unmapped'
  end
  "
}


###################################################################
# Singular Ad Mapping
# Built here
# https://docs.google.com/spreadsheets/d/1E7LtLtz_SzYiBrCzsT-lNvjPMI9RC_r5FybUTVk2GVo/edit?usp=sharing
# Ask Tal Kreuch for access
###################################################################

constant: singular_full_ad_name {
  value: "
  case

    when
      ${TABLE}.full_ad_name is not null
      and ${TABLE}.full_ad_name <> ''
      then ${TABLE}.full_ad_name

     when ${TABLE}.singular_creative_id = '6301194227322' then 'AppStoreTrailer_EN.mp4'
     when ${TABLE}.singular_creative_id = '6350278560322' then 'Tilting Table 001 (ES)'
     when ${TABLE}.singular_creative_id = '6353426254522' then 'Spin Girl 001'
     when ${TABLE}.singular_creative_id = '6289278657922' then 'ASOTrailer_30s_9x19-5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6442181207722' then 'TiltingTableDangerous'
     when ${TABLE}.singular_creative_id = '6294267214122' then 'ASOTrailer_30s_9x19-5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6460902469922' then 'SpinWithSloth'
     when ${TABLE}.singular_creative_id = '6444529394922' then 'TiltingTable'
     when ${TABLE}.singular_creative_id = '6442222790122' then 'HandsomeMan 002'
     when ${TABLE}.singular_creative_id = '6334482486722' then 'Testimonial 001'
     when ${TABLE}.singular_creative_id = '6442174775522' then 'Testimonial 001 (ES)'
     when ${TABLE}.singular_creative_id = '6350253635722' then 'Simple Blast 001 (ES)'
     when ${TABLE}.singular_creative_id = '6442177688922' then 'ManWithHorse'
     when ${TABLE}.singular_creative_id = '6366321673122' then 'Spin Girl 001'
     when ${TABLE}.singular_creative_id = '6460902468722' then 'HandsomeMan 002'
     when ${TABLE}.singular_creative_id = '6302530847122' then 'AppStoreTrailer_EN.mp4'
     when ${TABLE}.singular_creative_id = '6460902470922' then 'HandsomeMan 001'
     when ${TABLE}.singular_creative_id = '6350258071722' then 'App Store Trailer 001 (ES)'
     when ${TABLE}.singular_creative_id = '6451988225122' then 'Handsome Man w/Horse 001'
     when ${TABLE}.singular_creative_id = '6460902468522' then 'TiltingTableDangerous'
     when ${TABLE}.singular_creative_id = '6460902469722' then 'ManWithHorse'
     when ${TABLE}.singular_creative_id = '6353426253122' then 'Punk Grandma 002'
     when ${TABLE}.singular_creative_id = '6302530845722' then 'Testimonial_EN'
     when ${TABLE}.singular_creative_id = '6353426254722' then 'Handsome Man w/Horse 001'
     when ${TABLE}.singular_creative_id = '6448215766322' then 'Yoga Girl 001'
     when ${TABLE}.singular_creative_id = '6448215766122' then 'Yoga Girl 002'
     when ${TABLE}.singular_creative_id = '6366321674322' then 'Handsome Man w/Horse 001'
     when ${TABLE}.singular_creative_id = '6334481546522' then 'Handsome Man 002'
     when ${TABLE}.singular_creative_id = '6366321674122' then 'Handsome Man 002'
     when ${TABLE}.singular_creative_id = '6350216316922' then 'Testimonial 001 (ES)'
     when ${TABLE}.singular_creative_id = '6442181207522' then 'Zen'
     when ${TABLE}.singular_creative_id = '6366321673522' then 'Punk Grandma 002'
     when ${TABLE}.singular_creative_id = '6448215768922' then 'Handsome Man 002'
     when ${TABLE}.singular_creative_id = '6366321673922' then 'Yoga Girl 002'
     when ${TABLE}.singular_creative_id = '6334481915922' then 'Handsome Man w/Horse 001'
     when ${TABLE}.singular_creative_id = '6451988227722' then 'Lady Boss 001'
     when ${TABLE}.singular_creative_id = '6451988226522' then 'Handsome Man 002'
     when ${TABLE}.singular_creative_id = '6448215768722' then 'Punk Grandma 002'
     when ${TABLE}.singular_creative_id = '6334482296722' then 'Spin Girl 001'
     when ${TABLE}.singular_creative_id = '6301194230722' then 'PlayableLeadInVideo_EN'
     when ${TABLE}.singular_creative_id = '6353426253522' then 'Lady Boss 002'
     when ${TABLE}.singular_creative_id = '6442177688522' then 'SpinWithSloth'
     when ${TABLE}.singular_creative_id = '6353426255722' then 'Handsome Man 002'
     when ${TABLE}.singular_creative_id = '6448215766522' then 'Handsome Man 001'
     when ${TABLE}.singular_creative_id = '6460902469122' then 'Zen'
     when ${TABLE}.singular_creative_id = '6289278673122' then 'EB_221104_PlayableLead-InVideo_5s_AL_1080x1350.mp4'
     when ${TABLE}.singular_creative_id = '6442177688722' then 'YogaWithSloth'
     when ${TABLE}.singular_creative_id = '6460902470722' then 'SpinWithKoala'
     when ${TABLE}.singular_creative_id = '6334481714722' then 'Lady Boss 003'
     when ${TABLE}.singular_creative_id = '6451988226922' then 'Yoga Girl 002'
     when ${TABLE}.singular_creative_id = '6460902470122' then 'LadyBossWithCats'
     when ${TABLE}.singular_creative_id = '6301581265322' then 'Testimonial_EN'
     when ${TABLE}.singular_creative_id = '6448215768522' then 'Spin Girl 001'
     when ${TABLE}.singular_creative_id = '6460902469322' then 'LadyBossWithDogs'
     when ${TABLE}.singular_creative_id = '6334482125722' then 'Punk Grandma 002'
     when ${TABLE}.singular_creative_id = '6350246649322' then 'Tilting Table - Dangerous 001 (ES)'
     when ${TABLE}.singular_creative_id = '6451988224722' then 'Punk Grandma 002'
     when ${TABLE}.singular_creative_id = '6294267211322' then 'TiltingTable_25s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6442177689122' then 'HandsomeMan 001'
     when ${TABLE}.singular_creative_id = '6301409044322' then 'ElevatorDangerous_EN'
     when ${TABLE}.singular_creative_id = '6444574033522' then 'TiltingTableDangerous'
     when ${TABLE}.singular_creative_id = '6334482342722' then 'Spin Girl 002'
     when ${TABLE}.singular_creative_id = '6451988224922' then 'Spin Girl 001'
     when ${TABLE}.singular_creative_id = '6294267212722' then 'EB_221104_PlayableLead-InVideo_5s_AL_1080x1350.mp4'
     when ${TABLE}.singular_creative_id = '6365784367122' then 'Spin Girl 001'
     when ${TABLE}.singular_creative_id = '6294267215722' then 'ASOTrailer_30s_3x4_EN.mp4'
     when ${TABLE}.singular_creative_id = '6451988228122' then 'Lady Boss 002'
     when ${TABLE}.singular_creative_id = '6460902469522' then 'ManOnHorse'
     when ${TABLE}.singular_creative_id = '6301194229922' then 'SimpleBlast_EN'
     when ${TABLE}.singular_creative_id = '6444529395722' then 'ManWithHorse'
     when ${TABLE}.singular_creative_id = '6444529395522' then 'LadyBossWithCats'
     when ${TABLE}.singular_creative_id = '6442180318122' then 'APVUpdate'
     when ${TABLE}.singular_creative_id = '6448215769322' then 'Handsome Man w/Horse 001'
     when ${TABLE}.singular_creative_id = '6301194231522' then 'Zen_EN'
     when ${TABLE}.singular_creative_id = '6353426255122' then 'Punk Grandma 001'
     when ${TABLE}.singular_creative_id = '6442177687722' then 'LadyBossWithCats'
     when ${TABLE}.singular_creative_id = '6334481675522' then 'Lady Boss 002'
     when ${TABLE}.singular_creative_id = '6350252548722' then 'Zen 001 (ES)'
     when ${TABLE}.singular_creative_id = '6444529396322' then 'LadyBossWithDogs'
     when ${TABLE}.singular_creative_id = '6460902470322' then 'YogaWithSloth'
     when ${TABLE}.singular_creative_id = '6302530847922' then 'PlayableLeadInVideo_EN'
     when ${TABLE}.singular_creative_id = '6442177688122' then 'LadyBossWithDogs'
     when ${TABLE}.singular_creative_id = '6302530847722' then 'Zen_EN'
     when ${TABLE}.singular_creative_id = '6460902471122' then 'Testimonial 001 (ES)'
     when ${TABLE}.singular_creative_id = '6448215766922' then 'Lady Boss 003'
     when ${TABLE}.singular_creative_id = '6288920745122' then 'ASOTrailer_30s_9x16_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6334482436322' then 'Yoga Girl 002'
     when ${TABLE}.singular_creative_id = '6451988227522' then 'Asian Baby 001'
     when ${TABLE}.singular_creative_id = '6294267210522' then 'Zen_1080_1350_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289278662922' then 'Elevator_30s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6301194231722' then 'TiltingTable_EN'
     when ${TABLE}.singular_creative_id = '6442177687922' then 'SpinWithKoala'
     when ${TABLE}.singular_creative_id = '6444529394522' then 'SpinWithKoala'
     when ${TABLE}.singular_creative_id = '6334477095122' then 'Asian Baby 001'
     when ${TABLE}.singular_creative_id = '6294267217522' then 'EB_Airtraffic_Chef_26s_16x9_EN.mp4'
     when ${TABLE}.singular_creative_id = '6334481838922' then 'Lady Boss 004'
     when ${TABLE}.singular_creative_id = '6442177688322' then 'ManOnHorse'
     when ${TABLE}.singular_creative_id = '6366321672922' then 'Lady Boss 003'
     when ${TABLE}.singular_creative_id = '6334482035922' then 'Punk Grandma 001'
     when ${TABLE}.singular_creative_id = '6448215767922' then 'Spin Girl 002'
     when ${TABLE}.singular_creative_id = '6444529394722' then 'HandsomeMan 002'
     when ${TABLE}.singular_creative_id = '6334482394722' then 'Yoga Girl 001'
     when ${TABLE}.singular_creative_id = '6289278675322' then 'Zen_1080_1920_EN.mp4'
     when ${TABLE}.singular_creative_id = '6444526679522' then 'APVUpdate'
     when ${TABLE}.singular_creative_id = '6444529395322' then 'HandsomeMan'
     when ${TABLE}.singular_creative_id = '6334481617522' then 'Lady Boss 001'
     when ${TABLE}.singular_creative_id = '6444529396122' then 'Zen'
     when ${TABLE}.singular_creative_id = '6365784366522' then 'Handsome Man w/Horse 001'
     when ${TABLE}.singular_creative_id = '6448215767522' then 'Lady Boss 001'
     when ${TABLE}.singular_creative_id = '6301194226922' then 'SimpleMatch_EN'
     when ${TABLE}.singular_creative_id = '6302530847522' then 'SimpleBlast_EN'
     when ${TABLE}.singular_creative_id = '6289278675722' then 'Zen_1080_1350_EN.mp4'
     when ${TABLE}.singular_creative_id = '6365784366922' then 'Handsome Man 002'
     when ${TABLE}.singular_creative_id = '6365784368122' then 'Lady Boss 003'
     when ${TABLE}.singular_creative_id = '6365784368322' then 'Punk Grandma 002'
     when ${TABLE}.singular_creative_id = '6289278666722' then 'EB_Airtraffic_SassyDog_30s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6334481952522' then 'Handsome Man w/Horse 002'
     when ${TABLE}.singular_creative_id = '6353426253722' then 'Lady Boss 003'
     when ${TABLE}.singular_creative_id = '6302530846122' then 'ElevatorDangerous_EN'
     when ${TABLE}.singular_creative_id = '6334481405522' then 'Handsome Man 001'
     when ${TABLE}.singular_creative_id = '6444529394122' then 'SpinWithSloth'
     when ${TABLE}.singular_creative_id = '6460902470522' then 'APVUpdate'
     when ${TABLE}.singular_creative_id = '6289494924122' then 'EB_221107_PlayableLead-InVideo_5s_AL_1080x1350_ES.mp4'
     when ${TABLE}.singular_creative_id = '6365784368922' then 'Yoga Girl 001'
     when ${TABLE}.singular_creative_id = '6294267214522' then 'Match3_1080_1920_EN.mp4'
     when ${TABLE}.singular_creative_id = '6366321675122' then 'Punk Grandma 001'
     when ${TABLE}.singular_creative_id = '6448215765922' then 'Lady Boss 002'
     when ${TABLE}.singular_creative_id = '6444529394322' then 'YogaWithSloth'
     when ${TABLE}.singular_creative_id = '6366321672322' then 'Handsome Man 001'
     when ${TABLE}.singular_creative_id = '6366321674522' then 'Yoga Girl 001'
     when ${TABLE}.singular_creative_id = '6288922442922' then 'Zen_1080_1920_ES.mp4'
     when ${TABLE}.singular_creative_id = '6294267217322' then 'Elevator_30s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6444529395122' then 'Testimonial 001'
     when ${TABLE}.singular_creative_id = '6366321673322' then 'Lady Boss 002'
     when ${TABLE}.singular_creative_id = '6451988225522' then 'Punk Grandma 001'
     when ${TABLE}.singular_creative_id = '6294267212322' then 'SimpleBlast_30s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6353426254322' then 'Yoga Girl 001'
     when ${TABLE}.singular_creative_id = '6360326687122' then 'App Store Trailer 001'
     when ${TABLE}.singular_creative_id = '6294267213522' then 'SimpleBlast_30s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6448215767122' then 'Asian Baby 001'
     when ${TABLE}.singular_creative_id = '6365784367522' then 'Lady Boss 002'
     when ${TABLE}.singular_creative_id = '6448215767722' then 'Punk Grandma 001'
     when ${TABLE}.singular_creative_id = '6360043117122' then 'Lady Boss 003'
     when ${TABLE}.singular_creative_id = '6365784368522' then 'Handsome Man 001'
     when ${TABLE}.singular_creative_id = '6451988226322' then 'Handsome Man 001'
     when ${TABLE}.singular_creative_id = '6353426252522' then 'Yoga Girl 002'
     when ${TABLE}.singular_creative_id = '6288920762122' then 'EB_221107_PlayableLead-InVideo_5s_AL_1080x1350_PT.mp4'
     when ${TABLE}.singular_creative_id = '6451988226122' then 'Lady Boss 003'
     when ${TABLE}.singular_creative_id = '6294267211122' then 'TiltingTable_25s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6365784367322' then 'Asian Baby 001'
     when ${TABLE}.singular_creative_id = '6294267215922' then 'ASOTrailer_30s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6301395801322' then 'TiltingTableDangerous_EN'
     when ${TABLE}.singular_creative_id = '6365784368722' then 'Yoga Girl 002'
     when ${TABLE}.singular_creative_id = '6289278658122' then 'ASOTrailer_30s_3x4_EN.mp4'
     when ${TABLE}.singular_creative_id = '6294267214722' then 'EB_Airtraffic_Chef_26s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6301446608522' then 'WeirdTeddyBear_EN'
     when ${TABLE}.singular_creative_id = '6288922447722' then 'EB_221107_PlayableLead-InVideo_5s_AL_1080x1350_ES.mp4'
     when ${TABLE}.singular_creative_id = '6451988227922' then 'Yoga Girl 001'
     when ${TABLE}.singular_creative_id = '6302530848322' then 'Match3_EN'
     when ${TABLE}.singular_creative_id = '6289494919122' then 'ASOTrailer_30s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6451988225322' then 'Lady Boss 004'
     when ${TABLE}.singular_creative_id = '6294267213322' then 'SimpleMatch_23s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6444529395922' then 'ManOnHorse'
     when ${TABLE}.singular_creative_id = '6366321674722' then 'Lady Boss 001'
     when ${TABLE}.singular_creative_id = '6353426255522' then 'Handsome Man w/Horse 002'
     when ${TABLE}.singular_creative_id = '6289278668322' then 'SimpleBlast_30s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6360043117522' then 'Punk Grandma 001'
     when ${TABLE}.singular_creative_id = '6288922443522' then 'EB_Airtraffic_SassyDog_30s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6302530846922' then 'SimpleMatch_EN'
     when ${TABLE}.singular_creative_id = '6366321672722' then 'Asian Baby 001'
     when ${TABLE}.singular_creative_id = '6360043118522' then 'Handsome Man 001'
     when ${TABLE}.singular_creative_id = '6294267210922' then 'Zen_1080_1080_EN.mp4'
     when ${TABLE}.singular_creative_id = '6353426254122' then 'Asian Baby 001'
     when ${TABLE}.singular_creative_id = '6451988226722' then 'Handsome Man w/Horse 002'
     when ${TABLE}.singular_creative_id = '6360043119122' then 'Yoga Girl 002'
     when ${TABLE}.singular_creative_id = '6294267213922' then 'Match3_1080_1350_EN.mp4'
     when ${TABLE}.singular_creative_id = '6301194228322' then 'Elevator_EN.mp4'
     when ${TABLE}.singular_creative_id = '6302530848122' then 'TiltingTable_EN'
     when ${TABLE}.singular_creative_id = '6289278666922' then 'EB_Airtraffic_SassyDog_30s_1x1_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288920747922' then 'Elevator_30s_9x16_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6342654069122' then 'Spin Girl 001'
     when ${TABLE}.singular_creative_id = '6294267211522' then 'SimpleMatch_23s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289278673722' then 'Zen_1080_1080_EN.mp4'
     when ${TABLE}.singular_creative_id = '6342654068522' then 'Punk Grandma 001'
     when ${TABLE}.singular_creative_id = '6365784367922' then 'Punk Grandma 001'
     when ${TABLE}.singular_creative_id = '6366321675522' then 'Lady Boss 004'
     when ${TABLE}.singular_creative_id = '6342654068922' then 'Handsome Man w/Horse 001'
     when ${TABLE}.singular_creative_id = '6294267210122' then 'Zen_1080_1920_EN.mp4'
     when ${TABLE}.singular_creative_id = '6301194230122' then 'Match3_EN'
     when ${TABLE}.singular_creative_id = '6294267216322' then 'Match3_1080_1080_EN.mp4'
     when ${TABLE}.singular_creative_id = '6294267215322' then 'Elevator_30s_1x1_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289278668922' then 'SimpleBlast_30s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6342654070322' then 'Lady Boss 002'
     when ${TABLE}.singular_creative_id = '6448215768322' then 'Lady Boss 004'
     when ${TABLE}.singular_creative_id = '6360043118122' then 'Punk Grandma 002'
     when ${TABLE}.singular_creative_id = '6451988227322' then 'Spin Girl 002'
     when ${TABLE}.singular_creative_id = '6342654068722' then 'Lady Boss 004'
     when ${TABLE}.singular_creative_id = '6289278666522' then 'Match3_1080_1350_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289494917922' then 'SimpleBlast_30s_1x1_ES.mp4'
     when ${TABLE}.singular_creative_id = '6294267216122' then 'EB_Airtraffic_Chef_26s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289278662722' then 'Match3_1080_1080_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289278673322' then 'TiltingTable_25s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6294267210722' then 'Zen_1920_1080_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289278659922' then 'EB_Airtraffic_Chef_26s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6448215767322' then 'Handsome Man w/Horse 002'
     when ${TABLE}.singular_creative_id = '6366321674922' then 'Handsome Man w/Horse 002'
     when ${TABLE}.singular_creative_id = '6365784369322' then 'Spin Girl 002'
     when ${TABLE}.singular_creative_id = '6294267214922' then 'EB_Airtraffic_SassyDog_30s_16x9_EN.mp4'
     when ${TABLE}.singular_creative_id = '6366321675322' then 'Spin Girl 002'
     when ${TABLE}.singular_creative_id = '6342654068322' then 'Handsome Man w/Horse 002'
     when ${TABLE}.singular_creative_id = '6365784367722' then 'Lady Boss 001'
     when ${TABLE}.singular_creative_id = '6365784366322' then 'Lady Boss 004'
     when ${TABLE}.singular_creative_id = '6288922452922' then 'TiltingTable_25s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494923722' then 'TiltingTable_25s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920744922' then 'ASOTrailer_30s_9x19-5_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6342654069522' then 'Yoga Girl 001'
     when ${TABLE}.singular_creative_id = '6288920764122' then 'Zen_1080_1920_BR.mp4'
     when ${TABLE}.singular_creative_id = '6360043119322' then 'Spin Girl 001'
     when ${TABLE}.singular_creative_id = '6288920761922' then 'TiltingTable_25s_4x5_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6294267213722' then 'EB_Airtraffic_SassyDog_30s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288922440922' then 'EB_Airtraffic_Chef_26s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6342654071122' then 'Yoga Girl 002'
     when ${TABLE}.singular_creative_id = '6342654070722' then 'Punk Grandma 002'
     when ${TABLE}.singular_creative_id = '6288920751922' then 'Match3_1920_1080_BR.mp4'
     when ${TABLE}.singular_creative_id = '6342654068122' then 'Handsome Man 002'
     when ${TABLE}.singular_creative_id = '6342654069722' then 'Asian Baby 001'
     when ${TABLE}.singular_creative_id = '6294267216722' then 'SimpleMatch_23s_1x1_EN.mp4'
     when ${TABLE}.singular_creative_id = '6342654070122' then 'Lady Boss 003'
     when ${TABLE}.singular_creative_id = '6342654067922' then 'Handsome Man 001'
     when ${TABLE}.singular_creative_id = '6289494922322' then 'EB_Airtraffic_Chef_26s_16x9_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920762522' then 'Zen_1080_1350_BR.mp4'
     when ${TABLE}.singular_creative_id = '6288920749722' then 'Match3_1080_1920_BR.mp4'
     when ${TABLE}.singular_creative_id = '6288922448122' then 'TiltingTable_25s_16x9_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494921722' then 'EB_Airtraffic_SassyDog_30s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920747322' then 'EB_Airtraffic_Chef_26s_9x16_PTBR.mp4'
     when ${TABLE}.singular_creative_id = '6288922448322' then 'TiltingTable_25s_1x1_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289278671522' then 'SimpleMatch_23s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289278657322' then 'ASOTrailer_30s_16x9_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289278671322' then 'SimpleMatch_23s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289278657722' then 'ASOTrailer_30s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288920746522' then 'ASOTrailer_30s_3x4_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6289494920922' then 'Zen_1080_1080_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920758522' then 'SimpleBlast_30s_9x16_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6288922452322' then 'SimpleMatch_23s_1x1_ES.mp4'
     when ${TABLE}.singular_creative_id = '6294267215522' then 'Elevator_30s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288920749522' then 'Match3_1080_1350_BR.mp4'
     when ${TABLE}.singular_creative_id = '6289278663122' then 'Match3_1080_1920_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288922446322' then 'Match3_1080_1080_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288922458322' then 'SimpleBlast_30s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289278659522' then 'EB_Airtraffic_Chef_26s_4x5_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288920762322' then 'TiltingTable_25s_16x9_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6302530845922' then 'TiltingTableDangerous_EN'
     when ${TABLE}.singular_creative_id = '6302530847322' then 'Elevator_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289494921922' then 'Zen_1080_1350_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288922455522' then 'ASOTrailer_30s_9x19-5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920747722' then 'EB_Airtraffic_Chef_26s_16x9_PTBR.mp4'
     when ${TABLE}.singular_creative_id = '6288920759722' then 'SimpleMatch_23s_9x16_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6289278657522' then 'EB_Airtraffic_Chef_26s_16x9_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289494924922' then 'Zen_1080_1920_ES.mp4'
     when ${TABLE}.singular_creative_id = '6353426254922' then 'Lady Boss 004'
     when ${TABLE}.singular_creative_id = '6288920749922' then 'Elevator_30s_1x1_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6289278666322' then 'EB_Airtraffic_SassyDog_30s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289494924322' then 'Match3_1080_1080_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494923522' then 'TiltingTable_25s_16x9_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288922456922' then 'Elevator_30s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494923122' then 'EB_Airtraffic_Chef_26s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920759922' then 'SimpleMatch_23s_1x1_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6289278670922' then 'TiltingTable_25s_16x9_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288920745322' then 'ASOTrailer_30s_16x9_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6288922446122' then 'Match3_1080_1350_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920745522' then 'EB_Airtraffic_Chef_26s_4x5_PTBR.mp4'
     when ${TABLE}.singular_creative_id = '6288922456322' then 'Elevator_30s_16x9_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920747522' then 'Elevator_30s_16x9_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6353426253322' then 'Spin Girl 002'
     when ${TABLE}.singular_creative_id = '6288922443122' then 'EB_Airtraffic_SassyDog_30s_1x1_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288922445922' then 'Zen_1920_1080_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494918322' then 'Elevator_30s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494917522' then 'SimpleBlast_30s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6302530846722' then 'WeirdTeddyBear_EN'
     when ${TABLE}.singular_creative_id = '6289278662522' then 'Elevator_30s_16x9_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288920749322' then 'Match3_1080_1080_BR.mp4'
     when ${TABLE}.singular_creative_id = '6288922443322' then 'Zen_1080_1350_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920762722' then 'Zen_1080_1080_BR.mp4'
     when ${TABLE}.singular_creative_id = '6289278659722' then 'Elevator_30s_1x1_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288922447922' then 'TiltingTable_25s_4x5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494923922' then 'TiltingTable_25s_4x5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288922454722' then 'ASOTrailer_30s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494920522' then 'TiltingTable_25s_1x1_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288922458722' then 'SimpleBlast_30s_1x1_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920747122' then 'EB_Airtraffic_Chef_26s_1x1_PTBR.mp4'
     when ${TABLE}.singular_creative_id = '6360043117322' then 'Lady Boss 002'
     when ${TABLE}.singular_creative_id = '6288920760322' then 'TiltingTable_25s_9x16_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6289494918722' then 'Elevator_30s_4x5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288922456522' then 'Elevator_30s_4x5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920754922' then 'SimpleBlast_30s_1x1_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6288920752122' then 'EB_Airtraffic_SassyDog_30s_4x5_PTBR.mp4'
     when ${TABLE}.singular_creative_id = '6289494919522' then 'SimpleMatch_23s_9x16_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920751722' then 'EB_Airtraffic_SassyDog_30s_1x1_PTBR.mp4'
     when ${TABLE}.singular_creative_id = '6289278671122' then 'TiltingTable_25s_1x1_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288922441122' then 'EB_Airtraffic_Chef_26s_4x5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494923322' then 'Elevator_30s_1x1_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289278659322' then 'EB_Airtraffic_Chef_26s_1x1_EN.mp4'
     when ${TABLE}.singular_creative_id = '6360043119722' then 'Testimonial 001'
     when ${TABLE}.singular_creative_id = '6288920760122' then 'TiltingTable_25s_1x1_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6289494921122' then 'Match3_1080_1350_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289278666122' then 'EB_Airtraffic_SassyDog_30s_16x9_EN.mp4'
     when ${TABLE}.singular_creative_id = '6288920750122' then 'Elevator_30s_4x5_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6289494919922' then 'SimpleMatch_23s_4x5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6342654070522' then 'Spin Girl 002'
     when ${TABLE}.singular_creative_id = '6288922448522' then 'Zen_1080_1080_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920754722' then 'SimpleBlast_30s_16x9_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6289494920722' then 'SimpleMatch_23s_1x1_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494919722' then 'ASOTrailer_30s_9x19-5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920754522' then 'SimpleMatch_23s_4x5_ptBR.mp4'
     when ${TABLE}.singular_creative_id = '6288922447122' then 'Match3_1080_1920_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288922455722' then 'ASOTrailer_30s_16x9_ES.mp4'
     when ${TABLE}.singular_creative_id = '6360043117922' then 'Handsome Man 002'
     when ${TABLE}.singular_creative_id = '6288922456722' then 'SimpleBlast_30s_4x5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289278672922' then 'TiltingTable_25s_9x16_EN.mp4'
     when ${TABLE}.singular_creative_id = '6289494921522' then 'EB_Airtraffic_SassyDog_30s_4x5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6289494918522' then 'SimpleBlast_30s_4x5_ES.mp4'
     when ${TABLE}.singular_creative_id = '6288920753322' then 'EB_Airtraffic_SassyDog_30s_9x16_PTBR.mp4'
     when ${TABLE}.singular_creative_id = '6288922441722' then 'EB_Airtraffic_Chef_26s_16x9_ES.mp4'

    else 'Unmapped'

  end
  "
}

constant: singular_simple_ad_name {
  value: "
  case

     when ${TABLE}.full_ad_name like '%AppStoreTrailer%' then 'App Store Trailer'
     when ${TABLE}.full_ad_name like '%APVUpdate%' then 'App Store Trailer'
     when ${TABLE}.full_ad_name like '%Asian Baby%' then 'Asian Baby'
     when ${TABLE}.full_ad_name like '%ASOTrailer%' then 'App Store Trailer'
     when ${TABLE}.full_ad_name like '%Chef%' then 'Chef'
     when ${TABLE}.full_ad_name like '%Elevator%' then 'Elevator'
     when ${TABLE}.full_ad_name like '%HandsomeMan%' then 'Handsome Man'
     when ${TABLE}.full_ad_name like '%Handsome Man%' then 'Handsome Man'
     when ${TABLE}.full_ad_name like '%Lady Boss%' then 'Lady Boss'
     when ${TABLE}.full_ad_name like '%LadyBoss%' then 'Lady Boss'
     when ${TABLE}.full_ad_name like '%ManOnHorse%' then 'Man With Horse'
     when ${TABLE}.full_ad_name like '%ManWithHorse%' then 'Man With Horse'
     when ${TABLE}.full_ad_name like '%Match3%' then 'Match3'
     when ${TABLE}.full_ad_name like '%Playable%' then 'Playable'
     when ${TABLE}.full_ad_name like '%Punk Grandma%' then 'Punk Grandma'
     when ${TABLE}.full_ad_name like '%Simple Blast%' then 'Simple Blast'
     when ${TABLE}.full_ad_name like '%SimpleBlast%' then 'Simple Blast'
     when ${TABLE}.full_ad_name like '%Spin Girl%' then 'Spin Girl'
     when ${TABLE}.full_ad_name like '%SpinWithKoala%' then 'Spin With Koala'
     when ${TABLE}.full_ad_name like '%SpinWithSloth%' then 'Spin With Sloth'
     when ${TABLE}.full_ad_name like '%Tilting Table%' then 'Tilting Table'
     when ${TABLE}.full_ad_name like '%TiltingTable%' then 'Tilting Table'
     when ${TABLE}.full_ad_name like '%WeirdTeddyBear%' then 'WeirdTeddyBear'
     when ${TABLE}.full_ad_name like '%Yoga Girl%' then 'Yoga Girl'
     when ${TABLE}.full_ad_name like '%YogaWithSloth%' then 'YogaWithSloth'
     when ${TABLE}.full_ad_name like '%Zen%' then 'Zen'
     when ${TABLE}.full_ad_name like '%App Store Trailer%' then 'App Store Trailer'
     when ${TABLE}.full_ad_name like '%SimpleMatch%' then 'SimpleMatch'
     when ${TABLE}.full_ad_name like '%SassyDog%' then 'Sassy Dog'
     when ${TABLE}.full_ad_name like '%WeirdTreats%' then 'WeirdTreats'
     when ${TABLE}.full_ad_name like '%WeirdTeddy%' then 'WeirdTeddyBear'
     when ${TABLE}.full_ad_name like '%TTC%' then 'Tilting Table'

     when ${TABLE}.full_ad_name like '%GirlWithCats%' then 'Girl With Cats'
     when ${TABLE}.full_ad_name like '%AsianBaby%' then 'Asian Baby'
     when ${TABLE}.full_ad_name like '%PunkAsianGrandma%' then 'Punk Asian Grandma'
     when ${TABLE}.full_ad_name like '%LoungingWithCats%' then 'Lounging With Cats'
     when ${TABLE}.full_ad_name like '%LoungingWithSheep%' then 'Lounging With Sheep'
     when ${TABLE}.full_ad_name like '%TestimonialAI%' then 'Testimonial (Unmapped AI)'
     when ${TABLE}.full_ad_name like '%Testimonial%' then 'Testimonial'


     when ${TABLE}.singular_creative_id = '6301194227322' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6350278560322' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6353426254522' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6289278657922' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6442181207722' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6294267214122' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6460902469922' then 'Spin With Sloth'
     when ${TABLE}.singular_creative_id = '6444529394922' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6442222790122' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6334482486722' then 'Testimonial'
     when ${TABLE}.singular_creative_id = '6442174775522' then 'Testimonial'
     when ${TABLE}.singular_creative_id = '6350253635722' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6442177688922' then 'Man With Horse'
     when ${TABLE}.singular_creative_id = '6366321673122' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6460902468722' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6302530847122' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6460902470922' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6350258071722' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6451988225122' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6460902468522' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6460902469722' then 'Man With Horse'
     when ${TABLE}.singular_creative_id = '6353426253122' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6302530845722' then 'Testimonial'
     when ${TABLE}.singular_creative_id = '6353426254722' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6448215766322' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6448215766122' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6366321674322' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6334481546522' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6366321674122' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6350216316922' then 'Testimonial'
     when ${TABLE}.singular_creative_id = '6442181207522' then 'Zen'
     when ${TABLE}.singular_creative_id = '6366321673522' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6448215768922' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6366321673922' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6334481915922' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6451988227722' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6451988226522' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6448215768722' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6334482296722' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6301194230722' then 'Playable'
     when ${TABLE}.singular_creative_id = '6353426253522' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6442177688522' then 'Spin With Sloth'
     when ${TABLE}.singular_creative_id = '6353426255722' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6448215766522' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6460902469122' then 'Zen'
     when ${TABLE}.singular_creative_id = '6289278673122' then 'Playable'
     when ${TABLE}.singular_creative_id = '6442177688722' then 'YogaWithSloth'
     when ${TABLE}.singular_creative_id = '6460902470722' then 'Spin With Koala'
     when ${TABLE}.singular_creative_id = '6334481714722' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6451988226922' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6460902470122' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6301581265322' then 'Testimonial'
     when ${TABLE}.singular_creative_id = '6448215768522' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6460902469322' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6334482125722' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6350246649322' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6451988224722' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6294267211322' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6442177689122' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6301409044322' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6444574033522' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6334482342722' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6451988224922' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6294267212722' then 'Playable'
     when ${TABLE}.singular_creative_id = '6365784367122' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6294267215722' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6451988228122' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6460902469522' then 'Man With Horse'
     when ${TABLE}.singular_creative_id = '6301194229922' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6444529395722' then 'Man With Horse'
     when ${TABLE}.singular_creative_id = '6444529395522' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6442180318122' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6448215769322' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6301194231522' then 'Zen'
     when ${TABLE}.singular_creative_id = '6353426255122' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6442177687722' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6334481675522' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6350252548722' then 'Zen'
     when ${TABLE}.singular_creative_id = '6444529396322' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6460902470322' then 'YogaWithSloth'
     when ${TABLE}.singular_creative_id = '6302530847922' then 'Playable'
     when ${TABLE}.singular_creative_id = '6442177688122' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6302530847722' then 'Zen'
     when ${TABLE}.singular_creative_id = '6460902471122' then 'Testimonial'
     when ${TABLE}.singular_creative_id = '6448215766922' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6288920745122' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6334482436322' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6451988227522' then 'Asian Baby'
     when ${TABLE}.singular_creative_id = '6294267210522' then 'Zen'
     when ${TABLE}.singular_creative_id = '6289278662922' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6301194231722' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6442177687922' then 'Spin With Koala'
     when ${TABLE}.singular_creative_id = '6444529394522' then 'Spin With Koala'
     when ${TABLE}.singular_creative_id = '6334477095122' then 'Asian Baby'
     when ${TABLE}.singular_creative_id = '6294267217522' then 'Chef'
     when ${TABLE}.singular_creative_id = '6334481838922' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6442177688322' then 'Man With Horse'
     when ${TABLE}.singular_creative_id = '6366321672922' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6334482035922' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6448215767922' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6444529394722' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6334482394722' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6289278675322' then 'Zen'
     when ${TABLE}.singular_creative_id = '6444526679522' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6444529395322' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6334481617522' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6444529396122' then 'Zen'
     when ${TABLE}.singular_creative_id = '6365784366522' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6448215767522' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6301194226922' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6302530847522' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6289278675722' then 'Zen'
     when ${TABLE}.singular_creative_id = '6365784366922' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6365784368122' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6365784368322' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6289278666722' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6334481952522' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6353426253722' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6302530846122' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6334481405522' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6444529394122' then 'Spin With Sloth'
     when ${TABLE}.singular_creative_id = '6460902470522' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6289494924122' then 'Playable'
     when ${TABLE}.singular_creative_id = '6365784368922' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6294267214522' then 'Match3'
     when ${TABLE}.singular_creative_id = '6366321675122' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6448215765922' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6444529394322' then 'YogaWithSloth'
     when ${TABLE}.singular_creative_id = '6366321672322' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6366321674522' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6288922442922' then 'Zen'
     when ${TABLE}.singular_creative_id = '6294267217322' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6444529395122' then 'Testimonial'
     when ${TABLE}.singular_creative_id = '6366321673322' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6451988225522' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6294267212322' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6353426254322' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6360326687122' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6294267213522' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6448215767122' then 'Asian Baby'
     when ${TABLE}.singular_creative_id = '6365784367522' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6448215767722' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6360043117122' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6365784368522' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6451988226322' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6353426252522' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6288920762122' then 'Playable'
     when ${TABLE}.singular_creative_id = '6451988226122' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6294267211122' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6365784367322' then 'Asian Baby'
     when ${TABLE}.singular_creative_id = '6294267215922' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6301395801322' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6365784368722' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6289278658122' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6294267214722' then 'Chef'
     when ${TABLE}.singular_creative_id = '6301446608522' then 'WeirdTeddyBear'
     when ${TABLE}.singular_creative_id = '6288922447722' then 'Playable'
     when ${TABLE}.singular_creative_id = '6451988227922' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6302530848322' then 'Match3'
     when ${TABLE}.singular_creative_id = '6289494919122' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6451988225322' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6294267213322' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6444529395922' then 'Man With Horse'
     when ${TABLE}.singular_creative_id = '6366321674722' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6353426255522' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6289278668322' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6360043117522' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6288922443522' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6302530846922' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6366321672722' then 'Asian Baby'
     when ${TABLE}.singular_creative_id = '6360043118522' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6294267210922' then 'Zen'
     when ${TABLE}.singular_creative_id = '6353426254122' then 'Asian Baby'
     when ${TABLE}.singular_creative_id = '6451988226722' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6360043119122' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6294267213922' then 'Match3'
     when ${TABLE}.singular_creative_id = '6301194228322' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6302530848122' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6289278666922' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6288920747922' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6342654069122' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6294267211522' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6289278673722' then 'Zen'
     when ${TABLE}.singular_creative_id = '6342654068522' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6365784367922' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6366321675522' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6342654068922' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6294267210122' then 'Zen'
     when ${TABLE}.singular_creative_id = '6301194230122' then 'Match3'
     when ${TABLE}.singular_creative_id = '6294267216322' then 'Match3'
     when ${TABLE}.singular_creative_id = '6294267215322' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6289278668922' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6342654070322' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6448215768322' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6360043118122' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6451988227322' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6342654068722' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6289278666522' then 'Match3'
     when ${TABLE}.singular_creative_id = '6289494917922' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6294267216122' then 'Chef'
     when ${TABLE}.singular_creative_id = '6289278662722' then 'Match3'
     when ${TABLE}.singular_creative_id = '6289278673322' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6294267210722' then 'Zen'
     when ${TABLE}.singular_creative_id = '6289278659922' then 'Chef'
     when ${TABLE}.singular_creative_id = '6448215767322' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6366321674922' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6365784369322' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6294267214922' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6366321675322' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6342654068322' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6365784367722' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6365784366322' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6288922452922' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6289494923722' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6288920744922' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6342654069522' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6288920764122' then 'Zen'
     when ${TABLE}.singular_creative_id = '6360043119322' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6288920761922' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6294267213722' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6288922440922' then 'Chef'
     when ${TABLE}.singular_creative_id = '6342654071122' then 'Yoga Girl'
     when ${TABLE}.singular_creative_id = '6342654070722' then 'Punk Grandma'
     when ${TABLE}.singular_creative_id = '6288920751922' then 'Match3'
     when ${TABLE}.singular_creative_id = '6342654068122' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6342654069722' then 'Asian Baby'
     when ${TABLE}.singular_creative_id = '6294267216722' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6342654070122' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6342654067922' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6289494922322' then 'Chef'
     when ${TABLE}.singular_creative_id = '6288920762522' then 'Zen'
     when ${TABLE}.singular_creative_id = '6288920749722' then 'Match3'
     when ${TABLE}.singular_creative_id = '6288922448122' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6289494921722' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6288920747322' then 'Chef'
     when ${TABLE}.singular_creative_id = '6288922448322' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6289278671522' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6289278657322' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6289278671322' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6289278657722' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6288920746522' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6289494920922' then 'Zen'
     when ${TABLE}.singular_creative_id = '6288920758522' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6288922452322' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6294267215522' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6288920749522' then 'Match3'
     when ${TABLE}.singular_creative_id = '6289278663122' then 'Match3'
     when ${TABLE}.singular_creative_id = '6288922446322' then 'Match3'
     when ${TABLE}.singular_creative_id = '6288922458322' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6289278659522' then 'Chef'
     when ${TABLE}.singular_creative_id = '6288920762322' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6302530845922' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6302530847322' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6289494921922' then 'Zen'
     when ${TABLE}.singular_creative_id = '6288922455522' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6288920747722' then 'Chef'
     when ${TABLE}.singular_creative_id = '6288920759722' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6289278657522' then 'Chef'
     when ${TABLE}.singular_creative_id = '6289494924922' then 'Zen'
     when ${TABLE}.singular_creative_id = '6353426254922' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6288920749922' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6289278666322' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6289494924322' then 'Match3'
     when ${TABLE}.singular_creative_id = '6289494923522' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6288922456922' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6289494923122' then 'Chef'
     when ${TABLE}.singular_creative_id = '6288920759922' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6289278670922' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6288920745322' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6288922446122' then 'Match3'
     when ${TABLE}.singular_creative_id = '6288920745522' then 'Chef'
     when ${TABLE}.singular_creative_id = '6288922456322' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6288920747522' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6353426253322' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6288922443122' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6288922445922' then 'Zen'
     when ${TABLE}.singular_creative_id = '6289494918322' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6289494917522' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6302530846722' then 'WeirdTeddyBear'
     when ${TABLE}.singular_creative_id = '6289278662522' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6288920749322' then 'Match3'
     when ${TABLE}.singular_creative_id = '6288922443322' then 'Zen'
     when ${TABLE}.singular_creative_id = '6288920762722' then 'Zen'
     when ${TABLE}.singular_creative_id = '6289278659722' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6288922447922' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6289494923922' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6288922454722' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6289494920522' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6288922458722' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6288920747122' then 'Chef'
     when ${TABLE}.singular_creative_id = '6360043117322' then 'Lady Boss'
     when ${TABLE}.singular_creative_id = '6288920760322' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6289494918722' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6288922456522' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6288920754922' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6288920752122' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6289494919522' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6288920751722' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6289278671122' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6288922441122' then 'Chef'
     when ${TABLE}.singular_creative_id = '6289494923322' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6289278659322' then 'Chef'
     when ${TABLE}.singular_creative_id = '6360043119722' then 'Testimonial'
     when ${TABLE}.singular_creative_id = '6288920760122' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6289494921122' then 'Match3'
     when ${TABLE}.singular_creative_id = '6289278666122' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6288920750122' then 'Elevator'
     when ${TABLE}.singular_creative_id = '6289494919922' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6342654070522' then 'Spin Girl'
     when ${TABLE}.singular_creative_id = '6288922448522' then 'Zen'
     when ${TABLE}.singular_creative_id = '6288920754722' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6289494920722' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6289494919722' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6288920754522' then 'SimpleMatch'
     when ${TABLE}.singular_creative_id = '6288922447122' then 'Match3'
     when ${TABLE}.singular_creative_id = '6288922455722' then 'App Store Trailer'
     when ${TABLE}.singular_creative_id = '6360043117922' then 'Handsome Man'
     when ${TABLE}.singular_creative_id = '6288922456722' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6289278672922' then 'Tilting Table'
     when ${TABLE}.singular_creative_id = '6289494921522' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6289494918522' then 'Simple Blast'
     when ${TABLE}.singular_creative_id = '6288920753322' then 'Sassy Dog'
     when ${TABLE}.singular_creative_id = '6288922441722' then 'Chef'

  else 'Unmapped'

  end
  "
}

constant: singular_grouped_ad_name {
  value: "
  case

 when ${TABLE}.full_ad_name like '%AppStoreTrailer%' then 'App Store Trailer'
 when ${TABLE}.full_ad_name like '%APVUpdate%' then 'App Store Trailer'
 when ${TABLE}.full_ad_name like '%Asian Baby%' then 'AI'
 when ${TABLE}.full_ad_name like '%ASOTrailer%' then 'App Store Trailer'
 when ${TABLE}.full_ad_name like '%Chef%' then 'AirTraffic'
 when ${TABLE}.full_ad_name like '%Elevator%' then 'AirTraffic'
 when ${TABLE}.full_ad_name like '%HandsomeMan%' then 'AI'
 when ${TABLE}.full_ad_name like '%Handsome Man%' then 'AI'
 when ${TABLE}.full_ad_name like '%Lady Boss%' then 'AI'
 when ${TABLE}.full_ad_name like '%LadyBoss%' then 'AI'
 when ${TABLE}.full_ad_name like '%ManOnHorse%' then 'AI'
 when ${TABLE}.full_ad_name like '%ManWithHorse%' then 'AI'
 when ${TABLE}.full_ad_name like '%Match3%' then 'Match3'
 when ${TABLE}.full_ad_name like '%Playable%' then 'Playable'
 when ${TABLE}.full_ad_name like '%Punk Grandma%' then 'AI'
 when ${TABLE}.full_ad_name like '%Simple Blast%' then 'Simple Blast'
 when ${TABLE}.full_ad_name like '%SimpleBlast%' then 'Simple Blast'
 when ${TABLE}.full_ad_name like '%Spin Girl%' then 'AI'
 when ${TABLE}.full_ad_name like '%SpinWithKoala%' then 'AI'
 when ${TABLE}.full_ad_name like '%SpinWithSloth%' then 'AI'
 when ${TABLE}.full_ad_name like '%Tilting Table%' then 'Tilting Table'
 when ${TABLE}.full_ad_name like '%TiltingTable%' then 'Tilting Table'
 when ${TABLE}.full_ad_name like '%WeirdTeddyBear%' then 'AI'
 when ${TABLE}.full_ad_name like '%Yoga Girl%' then 'AI'
 when ${TABLE}.full_ad_name like '%YogaWithSloth%' then 'AI'
 when ${TABLE}.full_ad_name like '%Zen%' then 'Zen'
 when ${TABLE}.full_ad_name like '%App Store Trailer%' then 'App Store Trailer'
 when ${TABLE}.full_ad_name like '%SimpleMatch%' then 'SimpleMatch'
 when ${TABLE}.full_ad_name like '%SassyDog%' then 'AirTraffic'
 when ${TABLE}.full_ad_name like '%WeirdTreats%' then 'AI'
 when ${TABLE}.full_ad_name like '%WeirdTeddy%' then 'AI'
 when ${TABLE}.full_ad_name like '%TTC%' then 'Tilting Table'

 when ${TABLE}.full_ad_name like '%GirlWithCats%' then 'AI'
 when ${TABLE}.full_ad_name like '%AsianBaby%' then 'AI'
 when ${TABLE}.full_ad_name like '%PunkAsianGrandma%' then 'AI'
 when ${TABLE}.full_ad_name like '%LoungingWithCats%' then 'AI'
 when ${TABLE}.full_ad_name like '%LoungingWithSheep%' then 'AI'
 when ${TABLE}.full_ad_name like '%TestimonialAI%' then 'AI'
 when ${TABLE}.full_ad_name like '%Testimonial%' then 'Testimonial'

 when ${TABLE}.singular_creative_id = '6301194227322' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6350278560322' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6353426254522' then 'AI'
 when ${TABLE}.singular_creative_id = '6289278657922' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6442181207722' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6294267214122' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6460902469922' then 'AI'
 when ${TABLE}.singular_creative_id = '6444529394922' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6442222790122' then 'AI'
 when ${TABLE}.singular_creative_id = '6334482486722' then 'Testimonial'
 when ${TABLE}.singular_creative_id = '6442174775522' then 'Testimonial'
 when ${TABLE}.singular_creative_id = '6350253635722' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6442177688922' then 'AI'
 when ${TABLE}.singular_creative_id = '6366321673122' then 'AI'
 when ${TABLE}.singular_creative_id = '6460902468722' then 'AI'
 when ${TABLE}.singular_creative_id = '6302530847122' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6460902470922' then 'AI'
 when ${TABLE}.singular_creative_id = '6350258071722' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6451988225122' then 'AI'
 when ${TABLE}.singular_creative_id = '6460902468522' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6460902469722' then 'AI'
 when ${TABLE}.singular_creative_id = '6353426253122' then 'AI'
 when ${TABLE}.singular_creative_id = '6302530845722' then 'Testimonial'
 when ${TABLE}.singular_creative_id = '6353426254722' then 'AI'
 when ${TABLE}.singular_creative_id = '6448215766322' then 'AI'
 when ${TABLE}.singular_creative_id = '6448215766122' then 'AI'
 when ${TABLE}.singular_creative_id = '6366321674322' then 'AI'
 when ${TABLE}.singular_creative_id = '6334481546522' then 'AI'
 when ${TABLE}.singular_creative_id = '6366321674122' then 'AI'
 when ${TABLE}.singular_creative_id = '6350216316922' then 'Testimonial'
 when ${TABLE}.singular_creative_id = '6442181207522' then 'Zen'
 when ${TABLE}.singular_creative_id = '6366321673522' then 'AI'
 when ${TABLE}.singular_creative_id = '6448215768922' then 'AI'
 when ${TABLE}.singular_creative_id = '6366321673922' then 'AI'
 when ${TABLE}.singular_creative_id = '6334481915922' then 'AI'
 when ${TABLE}.singular_creative_id = '6451988227722' then 'AI'
 when ${TABLE}.singular_creative_id = '6451988226522' then 'AI'
 when ${TABLE}.singular_creative_id = '6448215768722' then 'AI'
 when ${TABLE}.singular_creative_id = '6334482296722' then 'AI'
 when ${TABLE}.singular_creative_id = '6301194230722' then 'Playable'
 when ${TABLE}.singular_creative_id = '6353426253522' then 'AI'
 when ${TABLE}.singular_creative_id = '6442177688522' then 'AI'
 when ${TABLE}.singular_creative_id = '6353426255722' then 'AI'
 when ${TABLE}.singular_creative_id = '6448215766522' then 'AI'
 when ${TABLE}.singular_creative_id = '6460902469122' then 'Zen'
 when ${TABLE}.singular_creative_id = '6289278673122' then 'Playable'
 when ${TABLE}.singular_creative_id = '6442177688722' then 'AI'
 when ${TABLE}.singular_creative_id = '6460902470722' then 'AI'
 when ${TABLE}.singular_creative_id = '6334481714722' then 'AI'
 when ${TABLE}.singular_creative_id = '6451988226922' then 'AI'
 when ${TABLE}.singular_creative_id = '6460902470122' then 'AI'
 when ${TABLE}.singular_creative_id = '6301581265322' then 'Testimonial'
 when ${TABLE}.singular_creative_id = '6448215768522' then 'AI'
 when ${TABLE}.singular_creative_id = '6460902469322' then 'AI'
 when ${TABLE}.singular_creative_id = '6334482125722' then 'AI'
 when ${TABLE}.singular_creative_id = '6350246649322' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6451988224722' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267211322' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6442177689122' then 'AI'
 when ${TABLE}.singular_creative_id = '6301409044322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6444574033522' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6334482342722' then 'AI'
 when ${TABLE}.singular_creative_id = '6451988224922' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267212722' then 'Playable'
 when ${TABLE}.singular_creative_id = '6365784367122' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267215722' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6451988228122' then 'AI'
 when ${TABLE}.singular_creative_id = '6460902469522' then 'AI'
 when ${TABLE}.singular_creative_id = '6301194229922' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6444529395722' then 'AI'
 when ${TABLE}.singular_creative_id = '6444529395522' then 'AI'
 when ${TABLE}.singular_creative_id = '6442180318122' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6448215769322' then 'AI'
 when ${TABLE}.singular_creative_id = '6301194231522' then 'Zen'
 when ${TABLE}.singular_creative_id = '6353426255122' then 'AI'
 when ${TABLE}.singular_creative_id = '6442177687722' then 'AI'
 when ${TABLE}.singular_creative_id = '6334481675522' then 'AI'
 when ${TABLE}.singular_creative_id = '6350252548722' then 'Zen'
 when ${TABLE}.singular_creative_id = '6444529396322' then 'AI'
 when ${TABLE}.singular_creative_id = '6460902470322' then 'AI'
 when ${TABLE}.singular_creative_id = '6302530847922' then 'Playable'
 when ${TABLE}.singular_creative_id = '6442177688122' then 'AI'
 when ${TABLE}.singular_creative_id = '6302530847722' then 'Zen'
 when ${TABLE}.singular_creative_id = '6460902471122' then 'Testimonial'
 when ${TABLE}.singular_creative_id = '6448215766922' then 'AI'
 when ${TABLE}.singular_creative_id = '6288920745122' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6334482436322' then 'AI'
 when ${TABLE}.singular_creative_id = '6451988227522' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267210522' then 'Zen'
 when ${TABLE}.singular_creative_id = '6289278662922' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6301194231722' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6442177687922' then 'AI'
 when ${TABLE}.singular_creative_id = '6444529394522' then 'AI'
 when ${TABLE}.singular_creative_id = '6334477095122' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267217522' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6334481838922' then 'AI'
 when ${TABLE}.singular_creative_id = '6442177688322' then 'AI'
 when ${TABLE}.singular_creative_id = '6366321672922' then 'AI'
 when ${TABLE}.singular_creative_id = '6334482035922' then 'AI'
 when ${TABLE}.singular_creative_id = '6448215767922' then 'AI'
 when ${TABLE}.singular_creative_id = '6444529394722' then 'AI'
 when ${TABLE}.singular_creative_id = '6334482394722' then 'AI'
 when ${TABLE}.singular_creative_id = '6289278675322' then 'Zen'
 when ${TABLE}.singular_creative_id = '6444526679522' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6444529395322' then 'AI'
 when ${TABLE}.singular_creative_id = '6334481617522' then 'AI'
 when ${TABLE}.singular_creative_id = '6444529396122' then 'Zen'
 when ${TABLE}.singular_creative_id = '6365784366522' then 'AI'
 when ${TABLE}.singular_creative_id = '6448215767522' then 'AI'
 when ${TABLE}.singular_creative_id = '6301194226922' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6302530847522' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6289278675722' then 'Zen'
 when ${TABLE}.singular_creative_id = '6365784366922' then 'AI'
 when ${TABLE}.singular_creative_id = '6365784368122' then 'AI'
 when ${TABLE}.singular_creative_id = '6365784368322' then 'AI'
 when ${TABLE}.singular_creative_id = '6289278666722' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6334481952522' then 'AI'
 when ${TABLE}.singular_creative_id = '6353426253722' then 'AI'
 when ${TABLE}.singular_creative_id = '6302530846122' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6334481405522' then 'AI'
 when ${TABLE}.singular_creative_id = '6444529394122' then 'AI'
 when ${TABLE}.singular_creative_id = '6460902470522' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6289494924122' then 'Playable'
 when ${TABLE}.singular_creative_id = '6365784368922' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267214522' then 'Match3'
 when ${TABLE}.singular_creative_id = '6366321675122' then 'AI'
 when ${TABLE}.singular_creative_id = '6448215765922' then 'AI'
 when ${TABLE}.singular_creative_id = '6444529394322' then 'AI'
 when ${TABLE}.singular_creative_id = '6366321672322' then 'AI'
 when ${TABLE}.singular_creative_id = '6366321674522' then 'AI'
 when ${TABLE}.singular_creative_id = '6288922442922' then 'Zen'
 when ${TABLE}.singular_creative_id = '6294267217322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6444529395122' then 'Testimonial'
 when ${TABLE}.singular_creative_id = '6366321673322' then 'AI'
 when ${TABLE}.singular_creative_id = '6451988225522' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267212322' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6353426254322' then 'AI'
 when ${TABLE}.singular_creative_id = '6360326687122' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6294267213522' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6448215767122' then 'AI'
 when ${TABLE}.singular_creative_id = '6365784367522' then 'AI'
 when ${TABLE}.singular_creative_id = '6448215767722' then 'AI'
 when ${TABLE}.singular_creative_id = '6360043117122' then 'AI'
 when ${TABLE}.singular_creative_id = '6365784368522' then 'AI'
 when ${TABLE}.singular_creative_id = '6451988226322' then 'AI'
 when ${TABLE}.singular_creative_id = '6353426252522' then 'AI'
 when ${TABLE}.singular_creative_id = '6288920762122' then 'Playable'
 when ${TABLE}.singular_creative_id = '6451988226122' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267211122' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6365784367322' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267215922' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6301395801322' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6365784368722' then 'AI'
 when ${TABLE}.singular_creative_id = '6289278658122' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6294267214722' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6301446608522' then 'WeirdTeddyBear'
 when ${TABLE}.singular_creative_id = '6288922447722' then 'Playable'
 when ${TABLE}.singular_creative_id = '6451988227922' then 'AI'
 when ${TABLE}.singular_creative_id = '6302530848322' then 'Match3'
 when ${TABLE}.singular_creative_id = '6289494919122' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6451988225322' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267213322' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6444529395922' then 'AI'
 when ${TABLE}.singular_creative_id = '6366321674722' then 'AI'
 when ${TABLE}.singular_creative_id = '6353426255522' then 'AI'
 when ${TABLE}.singular_creative_id = '6289278668322' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6360043117522' then 'AI'
 when ${TABLE}.singular_creative_id = '6288922443522' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6302530846922' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6366321672722' then 'AI'
 when ${TABLE}.singular_creative_id = '6360043118522' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267210922' then 'Zen'
 when ${TABLE}.singular_creative_id = '6353426254122' then 'AI'
 when ${TABLE}.singular_creative_id = '6451988226722' then 'AI'
 when ${TABLE}.singular_creative_id = '6360043119122' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267213922' then 'Match3'
 when ${TABLE}.singular_creative_id = '6301194228322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6302530848122' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6289278666922' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920747922' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6342654069122' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267211522' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6289278673722' then 'Zen'
 when ${TABLE}.singular_creative_id = '6342654068522' then 'AI'
 when ${TABLE}.singular_creative_id = '6365784367922' then 'AI'
 when ${TABLE}.singular_creative_id = '6366321675522' then 'AI'
 when ${TABLE}.singular_creative_id = '6342654068922' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267210122' then 'Zen'
 when ${TABLE}.singular_creative_id = '6301194230122' then 'Match3'
 when ${TABLE}.singular_creative_id = '6294267216322' then 'Match3'
 when ${TABLE}.singular_creative_id = '6294267215322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289278668922' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6342654070322' then 'AI'
 when ${TABLE}.singular_creative_id = '6448215768322' then 'AI'
 when ${TABLE}.singular_creative_id = '6360043118122' then 'AI'
 when ${TABLE}.singular_creative_id = '6451988227322' then 'AI'
 when ${TABLE}.singular_creative_id = '6342654068722' then 'AI'
 when ${TABLE}.singular_creative_id = '6289278666522' then 'Match3'
 when ${TABLE}.singular_creative_id = '6289494917922' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6294267216122' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289278662722' then 'Match3'
 when ${TABLE}.singular_creative_id = '6289278673322' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6294267210722' then 'Zen'
 when ${TABLE}.singular_creative_id = '6289278659922' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6448215767322' then 'AI'
 when ${TABLE}.singular_creative_id = '6366321674922' then 'AI'
 when ${TABLE}.singular_creative_id = '6365784369322' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267214922' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6366321675322' then 'AI'
 when ${TABLE}.singular_creative_id = '6342654068322' then 'AI'
 when ${TABLE}.singular_creative_id = '6365784367722' then 'AI'
 when ${TABLE}.singular_creative_id = '6365784366322' then 'AI'
 when ${TABLE}.singular_creative_id = '6288922452922' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6289494923722' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6288920744922' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6342654069522' then 'AI'
 when ${TABLE}.singular_creative_id = '6288920764122' then 'Zen'
 when ${TABLE}.singular_creative_id = '6360043119322' then 'AI'
 when ${TABLE}.singular_creative_id = '6288920761922' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6294267213722' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288922440922' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6342654071122' then 'AI'
 when ${TABLE}.singular_creative_id = '6342654070722' then 'AI'
 when ${TABLE}.singular_creative_id = '6288920751922' then 'Match3'
 when ${TABLE}.singular_creative_id = '6342654068122' then 'AI'
 when ${TABLE}.singular_creative_id = '6342654069722' then 'AI'
 when ${TABLE}.singular_creative_id = '6294267216722' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6342654070122' then 'AI'
 when ${TABLE}.singular_creative_id = '6342654067922' then 'AI'
 when ${TABLE}.singular_creative_id = '6289494922322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920762522' then 'Zen'
 when ${TABLE}.singular_creative_id = '6288920749722' then 'Match3'
 when ${TABLE}.singular_creative_id = '6288922448122' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6289494921722' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920747322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288922448322' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6289278671522' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6289278657322' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6289278671322' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6289278657722' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6288920746522' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6289494920922' then 'Zen'
 when ${TABLE}.singular_creative_id = '6288920758522' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6288922452322' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6294267215522' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920749522' then 'Match3'
 when ${TABLE}.singular_creative_id = '6289278663122' then 'Match3'
 when ${TABLE}.singular_creative_id = '6288922446322' then 'Match3'
 when ${TABLE}.singular_creative_id = '6288922458322' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6289278659522' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920762322' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6302530845922' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6302530847322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289494921922' then 'Zen'
 when ${TABLE}.singular_creative_id = '6288922455522' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6288920747722' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920759722' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6289278657522' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289494924922' then 'Zen'
 when ${TABLE}.singular_creative_id = '6353426254922' then 'AI'
 when ${TABLE}.singular_creative_id = '6288920749922' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289278666322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289494924322' then 'Match3'
 when ${TABLE}.singular_creative_id = '6289494923522' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6288922456922' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289494923122' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920759922' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6289278670922' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6288920745322' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6288922446122' then 'Match3'
 when ${TABLE}.singular_creative_id = '6288920745522' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288922456322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920747522' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6353426253322' then 'AI'
 when ${TABLE}.singular_creative_id = '6288922443122' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288922445922' then 'Zen'
 when ${TABLE}.singular_creative_id = '6289494918322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289494917522' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6302530846722' then 'WeirdTeddyBear'
 when ${TABLE}.singular_creative_id = '6289278662522' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920749322' then 'Match3'
 when ${TABLE}.singular_creative_id = '6288922443322' then 'Zen'
 when ${TABLE}.singular_creative_id = '6288920762722' then 'Zen'
 when ${TABLE}.singular_creative_id = '6289278659722' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288922447922' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6289494923922' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6288922454722' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6289494920522' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6288922458722' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6288920747122' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6360043117322' then 'AI'
 when ${TABLE}.singular_creative_id = '6288920760322' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6289494918722' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288922456522' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920754922' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6288920752122' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289494919522' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6288920751722' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289278671122' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6288922441122' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289494923322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289278659322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6360043119722' then 'Testimonial'
 when ${TABLE}.singular_creative_id = '6288920760122' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6289494921122' then 'Match3'
 when ${TABLE}.singular_creative_id = '6289278666122' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288920750122' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289494919922' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6342654070522' then 'AI'
 when ${TABLE}.singular_creative_id = '6288922448522' then 'Zen'
 when ${TABLE}.singular_creative_id = '6288920754722' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6289494920722' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6289494919722' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6288920754522' then 'SimpleMatch'
 when ${TABLE}.singular_creative_id = '6288922447122' then 'Match3'
 when ${TABLE}.singular_creative_id = '6288922455722' then 'App Store Trailer'
 when ${TABLE}.singular_creative_id = '6360043117922' then 'AI'
 when ${TABLE}.singular_creative_id = '6288922456722' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6289278672922' then 'Tilting Table'
 when ${TABLE}.singular_creative_id = '6289494921522' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6289494918522' then 'Simple Blast'
 when ${TABLE}.singular_creative_id = '6288920753322' then 'AirTraffic'
 when ${TABLE}.singular_creative_id = '6288922441722' then 'AirTraffic'

  else 'Unmapped'

  end
  "
}

###################################################################
## Map Alfa 3 (3 Digit) Country Code to 2 Digit Country Code
## Mapping table Link:
## https://docs.google.com/spreadsheets/d/1bo2YEoElScnqyX4TzVOtf8jJjWlJhcmDTx6eGqfT_5Q/edit?usp=sharing
## Ask Tal Kreuch For Access
###################################################################

constant: map_3_digit_country_code_to_3_digit_country_code {
  value: "
  case
    when ${TABLE}.alfa_3_country_code = 'AFG' then 'AF'
    when ${TABLE}.alfa_3_country_code = 'ALA' then 'AX'
    when ${TABLE}.alfa_3_country_code = 'ALB' then 'AL'
    when ${TABLE}.alfa_3_country_code = 'DZA' then 'DZ'
    when ${TABLE}.alfa_3_country_code = 'ASM' then 'AS'
    when ${TABLE}.alfa_3_country_code = 'AND' then 'AD'
    when ${TABLE}.alfa_3_country_code = 'AGO' then 'AO'
    when ${TABLE}.alfa_3_country_code = 'AIA' then 'AI'
    when ${TABLE}.alfa_3_country_code = 'ATA' then 'AQ'
    when ${TABLE}.alfa_3_country_code = 'ATG' then 'AG'
    when ${TABLE}.alfa_3_country_code = 'ARG' then 'AR'
    when ${TABLE}.alfa_3_country_code = 'ARM' then 'AM'
    when ${TABLE}.alfa_3_country_code = 'ABW' then 'AW'
    when ${TABLE}.alfa_3_country_code = 'AUS' then 'AU'
    when ${TABLE}.alfa_3_country_code = 'AUT' then 'AT'
    when ${TABLE}.alfa_3_country_code = 'AZE' then 'AZ'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'BHS' then 'BS'
    when ${TABLE}.alfa_3_country_code = 'BHR' then 'BH'
    when ${TABLE}.alfa_3_country_code = 'BGD' then 'BD'
    when ${TABLE}.alfa_3_country_code = 'BRB' then 'BB'
    when ${TABLE}.alfa_3_country_code = 'BLR' then 'BY'
    when ${TABLE}.alfa_3_country_code = 'BEL' then 'BE'
    when ${TABLE}.alfa_3_country_code = 'BLZ' then 'BZ'
    when ${TABLE}.alfa_3_country_code = 'BEN' then 'BJ'
    when ${TABLE}.alfa_3_country_code = 'BMU' then 'BM'
    when ${TABLE}.alfa_3_country_code = 'BTN' then 'BT'
    when ${TABLE}.alfa_3_country_code = 'BOL' then 'BO'
    when ${TABLE}.alfa_3_country_code = 'BIH' then 'BA'
    when ${TABLE}.alfa_3_country_code = 'BWA' then 'BW'
    when ${TABLE}.alfa_3_country_code = 'BVT' then 'BV'
    when ${TABLE}.alfa_3_country_code = 'BRA' then 'BR'
    when ${TABLE}.alfa_3_country_code = 'VGB' then 'VG'
    when ${TABLE}.alfa_3_country_code = 'IOT' then 'IO'
    when ${TABLE}.alfa_3_country_code = 'BRN' then 'BN'
    when ${TABLE}.alfa_3_country_code = 'BGR' then 'BG'
    when ${TABLE}.alfa_3_country_code = 'BFA' then 'BF'
    when ${TABLE}.alfa_3_country_code = 'BDI' then 'BI'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'KHM' then 'KH'
    when ${TABLE}.alfa_3_country_code = 'CMR' then 'CM'
    when ${TABLE}.alfa_3_country_code = 'CAN' then 'CA'
    when ${TABLE}.alfa_3_country_code = 'CPV' then 'CV'
    when ${TABLE}.alfa_3_country_code = 'CYM' then 'KY'
    when ${TABLE}.alfa_3_country_code = 'CAF' then 'CF'
    when ${TABLE}.alfa_3_country_code = 'TCD' then 'TD'
    when ${TABLE}.alfa_3_country_code = 'CHL' then 'CL'
    when ${TABLE}.alfa_3_country_code = 'CHN' then 'CN'
    when ${TABLE}.alfa_3_country_code = 'HKG' then 'HK'
    when ${TABLE}.alfa_3_country_code = 'MAC' then 'MO'
    when ${TABLE}.alfa_3_country_code = 'CXR' then 'CX'
    when ${TABLE}.alfa_3_country_code = 'CCK' then 'CC'
    when ${TABLE}.alfa_3_country_code = 'COL' then 'CO'
    when ${TABLE}.alfa_3_country_code = 'COM' then 'KM'
    when ${TABLE}.alfa_3_country_code = 'COG' then 'CG'
    when ${TABLE}.alfa_3_country_code = 'COD' then 'CD'
    when ${TABLE}.alfa_3_country_code = 'COK' then 'CK'
    when ${TABLE}.alfa_3_country_code = 'CRI' then 'CR'
    when ${TABLE}.alfa_3_country_code = 'CIV' then 'CI'
    when ${TABLE}.alfa_3_country_code = 'HRV' then 'HR'
    when ${TABLE}.alfa_3_country_code = 'CUB' then 'CU'
    when ${TABLE}.alfa_3_country_code = 'CYP' then 'CY'
    when ${TABLE}.alfa_3_country_code = 'CZE' then 'CZ'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'DNK' then 'DK'
    when ${TABLE}.alfa_3_country_code = 'DJI' then 'DJ'
    when ${TABLE}.alfa_3_country_code = 'DMA' then 'DM'
    when ${TABLE}.alfa_3_country_code = 'DOM' then 'DO'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'ECU' then 'EC'
    when ${TABLE}.alfa_3_country_code = 'EGY' then 'EG'
    when ${TABLE}.alfa_3_country_code = 'SLV' then 'SV'
    when ${TABLE}.alfa_3_country_code = 'GNQ' then 'GQ'
    when ${TABLE}.alfa_3_country_code = 'ERI' then 'ER'
    when ${TABLE}.alfa_3_country_code = 'EST' then 'EE'
    when ${TABLE}.alfa_3_country_code = 'ETH' then 'ET'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'FLK' then 'FK'
    when ${TABLE}.alfa_3_country_code = 'FRO' then 'FO'
    when ${TABLE}.alfa_3_country_code = 'FJI' then 'FJ'
    when ${TABLE}.alfa_3_country_code = 'FIN' then 'FI'
    when ${TABLE}.alfa_3_country_code = 'FRA' then 'FR'
    when ${TABLE}.alfa_3_country_code = 'GUF' then 'GF'
    when ${TABLE}.alfa_3_country_code = 'PYF' then 'PF'
    when ${TABLE}.alfa_3_country_code = 'ATF' then 'TF'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'GAB' then 'GA'
    when ${TABLE}.alfa_3_country_code = 'GMB' then 'GM'
    when ${TABLE}.alfa_3_country_code = 'GEO' then 'GE'
    when ${TABLE}.alfa_3_country_code = 'DEU' then 'DE'
    when ${TABLE}.alfa_3_country_code = 'GHA' then 'GH'
    when ${TABLE}.alfa_3_country_code = 'GIB' then 'GI'
    when ${TABLE}.alfa_3_country_code = 'GRC' then 'GR'
    when ${TABLE}.alfa_3_country_code = 'GRL' then 'GL'
    when ${TABLE}.alfa_3_country_code = 'GRD' then 'GD'
    when ${TABLE}.alfa_3_country_code = 'GLP' then 'GP'
    when ${TABLE}.alfa_3_country_code = 'GUM' then 'GU'
    when ${TABLE}.alfa_3_country_code = 'GTM' then 'GT'
    when ${TABLE}.alfa_3_country_code = 'GGY' then 'GG'
    when ${TABLE}.alfa_3_country_code = 'GIN' then 'GN'
    when ${TABLE}.alfa_3_country_code = 'GNB' then 'GW'
    when ${TABLE}.alfa_3_country_code = 'GUY' then 'GY'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'HTI' then 'HT'
    when ${TABLE}.alfa_3_country_code = 'HMD' then 'HM'
    when ${TABLE}.alfa_3_country_code = 'VAT' then 'VA'
    when ${TABLE}.alfa_3_country_code = 'HND' then 'HN'
    when ${TABLE}.alfa_3_country_code = 'HUN' then 'HU'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'ISL' then 'IS'
    when ${TABLE}.alfa_3_country_code = 'IND' then 'IN'
    when ${TABLE}.alfa_3_country_code = 'IDN' then 'ID'
    when ${TABLE}.alfa_3_country_code = 'IRN' then 'IR'
    when ${TABLE}.alfa_3_country_code = 'IRQ' then 'IQ'
    when ${TABLE}.alfa_3_country_code = 'IRL' then 'IE'
    when ${TABLE}.alfa_3_country_code = 'IMN' then 'IM'
    when ${TABLE}.alfa_3_country_code = 'ISR' then 'IL'
    when ${TABLE}.alfa_3_country_code = 'ITA' then 'IT'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'JAM' then 'JM'
    when ${TABLE}.alfa_3_country_code = 'JPN' then 'JP'
    when ${TABLE}.alfa_3_country_code = 'JEY' then 'JE'
    when ${TABLE}.alfa_3_country_code = 'JOR' then 'JO'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'KAZ' then 'KZ'
    when ${TABLE}.alfa_3_country_code = 'KEN' then 'KE'
    when ${TABLE}.alfa_3_country_code = 'KIR' then 'KI'
    when ${TABLE}.alfa_3_country_code = 'PRK' then 'KP'
    when ${TABLE}.alfa_3_country_code = 'KOR' then 'KR'
    when ${TABLE}.alfa_3_country_code = 'KWT' then 'KW'
    when ${TABLE}.alfa_3_country_code = 'KGZ' then 'KG'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'LAO' then 'LA'
    when ${TABLE}.alfa_3_country_code = 'LVA' then 'LV'
    when ${TABLE}.alfa_3_country_code = 'LBN' then 'LB'
    when ${TABLE}.alfa_3_country_code = 'LSO' then 'LS'
    when ${TABLE}.alfa_3_country_code = 'LBR' then 'LR'
    when ${TABLE}.alfa_3_country_code = 'LBY' then 'LY'
    when ${TABLE}.alfa_3_country_code = 'LIE' then 'LI'
    when ${TABLE}.alfa_3_country_code = 'LTU' then 'LT'
    when ${TABLE}.alfa_3_country_code = 'LUX' then 'LU'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'MKD' then 'MK'
    when ${TABLE}.alfa_3_country_code = 'MDG' then 'MG'
    when ${TABLE}.alfa_3_country_code = 'MWI' then 'MW'
    when ${TABLE}.alfa_3_country_code = 'MYS' then 'MY'
    when ${TABLE}.alfa_3_country_code = 'MDV' then 'MV'
    when ${TABLE}.alfa_3_country_code = 'MLI' then 'ML'
    when ${TABLE}.alfa_3_country_code = 'MLT' then 'MT'
    when ${TABLE}.alfa_3_country_code = 'MHL' then 'MH'
    when ${TABLE}.alfa_3_country_code = 'MTQ' then 'MQ'
    when ${TABLE}.alfa_3_country_code = 'MRT' then 'MR'
    when ${TABLE}.alfa_3_country_code = 'MUS' then 'MU'
    when ${TABLE}.alfa_3_country_code = 'MYT' then 'YT'
    when ${TABLE}.alfa_3_country_code = 'MEX' then 'MX'
    when ${TABLE}.alfa_3_country_code = 'FSM' then 'FM'
    when ${TABLE}.alfa_3_country_code = 'MDA' then 'MD'
    when ${TABLE}.alfa_3_country_code = 'MCO' then 'MC'
    when ${TABLE}.alfa_3_country_code = 'MNG' then 'MN'
    when ${TABLE}.alfa_3_country_code = 'MNE' then 'ME'
    when ${TABLE}.alfa_3_country_code = 'MSR' then 'MS'
    when ${TABLE}.alfa_3_country_code = 'MAR' then 'MA'
    when ${TABLE}.alfa_3_country_code = 'MOZ' then 'MZ'
    when ${TABLE}.alfa_3_country_code = 'MMR' then 'MM'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'NAM' then 'NA'
    when ${TABLE}.alfa_3_country_code = 'NRU' then 'NR'
    when ${TABLE}.alfa_3_country_code = 'NPL' then 'NP'
    when ${TABLE}.alfa_3_country_code = 'NLD' then 'NL'
    when ${TABLE}.alfa_3_country_code = 'ANT' then 'AN'
    when ${TABLE}.alfa_3_country_code = 'NCL' then 'NC'
    when ${TABLE}.alfa_3_country_code = 'NZL' then 'NZ'
    when ${TABLE}.alfa_3_country_code = 'NIC' then 'NI'
    when ${TABLE}.alfa_3_country_code = 'NER' then 'NE'
    when ${TABLE}.alfa_3_country_code = 'NGA' then 'NG'
    when ${TABLE}.alfa_3_country_code = 'NIU' then 'NU'
    when ${TABLE}.alfa_3_country_code = 'NFK' then 'NF'
    when ${TABLE}.alfa_3_country_code = 'MNP' then 'MP'
    when ${TABLE}.alfa_3_country_code = 'NOR' then 'NO'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'OMN' then 'OM'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'PAK' then 'PK'
    when ${TABLE}.alfa_3_country_code = 'PLW' then 'PW'
    when ${TABLE}.alfa_3_country_code = 'PSE' then 'PS'
    when ${TABLE}.alfa_3_country_code = 'PAN' then 'PA'
    when ${TABLE}.alfa_3_country_code = 'PNG' then 'PG'
    when ${TABLE}.alfa_3_country_code = 'PRY' then 'PY'
    when ${TABLE}.alfa_3_country_code = 'PER' then 'PE'
    when ${TABLE}.alfa_3_country_code = 'PHL' then 'PH'
    when ${TABLE}.alfa_3_country_code = 'PCN' then 'PN'
    when ${TABLE}.alfa_3_country_code = 'POL' then 'PL'
    when ${TABLE}.alfa_3_country_code = 'PRT' then 'PT'
    when ${TABLE}.alfa_3_country_code = 'PRI' then 'PR'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'QAT' then 'QA'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'REU' then 'RE'
    when ${TABLE}.alfa_3_country_code = 'ROU' then 'RO'
    when ${TABLE}.alfa_3_country_code = 'RUS' then 'RU'
    when ${TABLE}.alfa_3_country_code = 'RWA' then 'RW'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'BLM' then 'BL'
    when ${TABLE}.alfa_3_country_code = 'SHN' then 'SH'
    when ${TABLE}.alfa_3_country_code = 'KNA' then 'KN'
    when ${TABLE}.alfa_3_country_code = 'LCA' then 'LC'
    when ${TABLE}.alfa_3_country_code = 'MAF' then 'MF'
    when ${TABLE}.alfa_3_country_code = 'SPM' then 'PM'
    when ${TABLE}.alfa_3_country_code = 'VCT' then 'VC'
    when ${TABLE}.alfa_3_country_code = 'WSM' then 'WS'
    when ${TABLE}.alfa_3_country_code = 'SMR' then 'SM'
    when ${TABLE}.alfa_3_country_code = 'STP' then 'ST'
    when ${TABLE}.alfa_3_country_code = 'SAU' then 'SA'
    when ${TABLE}.alfa_3_country_code = 'SEN' then 'SN'
    when ${TABLE}.alfa_3_country_code = 'SRB' then 'RS'
    when ${TABLE}.alfa_3_country_code = 'SYC' then 'SC'
    when ${TABLE}.alfa_3_country_code = 'SLE' then 'SL'
    when ${TABLE}.alfa_3_country_code = 'SGP' then 'SG'
    when ${TABLE}.alfa_3_country_code = 'SVK' then 'SK'
    when ${TABLE}.alfa_3_country_code = 'SVN' then 'SI'
    when ${TABLE}.alfa_3_country_code = 'SLB' then 'SB'
    when ${TABLE}.alfa_3_country_code = 'SOM' then 'SO'
    when ${TABLE}.alfa_3_country_code = 'ZAF' then 'ZA'
    when ${TABLE}.alfa_3_country_code = 'SGS' then 'GS'
    when ${TABLE}.alfa_3_country_code = 'SSD' then 'SS'
    when ${TABLE}.alfa_3_country_code = 'ESP' then 'ES'
    when ${TABLE}.alfa_3_country_code = 'LKA' then 'LK'
    when ${TABLE}.alfa_3_country_code = 'SDN' then 'SD'
    when ${TABLE}.alfa_3_country_code = 'SUR' then 'SR'
    when ${TABLE}.alfa_3_country_code = 'SJM' then 'SJ'
    when ${TABLE}.alfa_3_country_code = 'SWZ' then 'SZ'
    when ${TABLE}.alfa_3_country_code = 'SWE' then 'SE'
    when ${TABLE}.alfa_3_country_code = 'CHE' then 'CH'
    when ${TABLE}.alfa_3_country_code = 'SYR' then 'SY'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'TWN' then 'TW'
    when ${TABLE}.alfa_3_country_code = 'TJK' then 'TJ'
    when ${TABLE}.alfa_3_country_code = 'TZA' then 'TZ'
    when ${TABLE}.alfa_3_country_code = 'THA' then 'TH'
    when ${TABLE}.alfa_3_country_code = 'TLS' then 'TL'
    when ${TABLE}.alfa_3_country_code = 'TGO' then 'TG'
    when ${TABLE}.alfa_3_country_code = 'TKL' then 'TK'
    when ${TABLE}.alfa_3_country_code = 'TON' then 'TO'
    when ${TABLE}.alfa_3_country_code = 'TTO' then 'TT'
    when ${TABLE}.alfa_3_country_code = 'TUN' then 'TN'
    when ${TABLE}.alfa_3_country_code = 'TUR' then 'TR'
    when ${TABLE}.alfa_3_country_code = 'TKM' then 'TM'
    when ${TABLE}.alfa_3_country_code = 'TCA' then 'TC'
    when ${TABLE}.alfa_3_country_code = 'TUV' then 'TV'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'UGA' then 'UG'
    when ${TABLE}.alfa_3_country_code = 'UKR' then 'UA'
    when ${TABLE}.alfa_3_country_code = 'ARE' then 'AE'
    when ${TABLE}.alfa_3_country_code = 'GBR' then 'GB'
    when ${TABLE}.alfa_3_country_code = 'USA' then 'US'
    when ${TABLE}.alfa_3_country_code = 'UMI' then 'UM'
    when ${TABLE}.alfa_3_country_code = 'URY' then 'UY'
    when ${TABLE}.alfa_3_country_code = 'UZB' then 'UZ'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'VUT' then 'VU'
    when ${TABLE}.alfa_3_country_code = 'VEN' then 'VE'
    when ${TABLE}.alfa_3_country_code = 'VNM' then 'VN'
    when ${TABLE}.alfa_3_country_code = 'VIR' then 'VI'
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = '' then ''
    when ${TABLE}.alfa_3_country_code = 'WLF' then 'WF'
    when ${TABLE}.alfa_3_country_code = 'ESH' then 'EH'


  else ${TABLE}.alfa_3_country_code

  end
  "
}

###################################################################
## Adhoc - Map Level Serial To a Level Bucket
## 2024/01/01
##    - This is part of a churn analysis by level bucket
##    - Mapping levels into buckets to estimate what the churn should be in each bucket
##    - https://docs.google.com/spreadsheets/d/1mAFJMFrugs1DgPvwS1T_byTCAGHMXlVNliqLQSekn60/edit?usp=drive_link
###################################################################

constant: adhoc_level_buckets_for_churn_analysis {
  value: "
  case

when ${TABLE}.level_serial between 1 and 10 then 'bucket_0001_0010'
when ${TABLE}.level_serial between 10 and 43 then 'bucket_0010_0043'
when ${TABLE}.level_serial between 43 and 65 then 'bucket_0043_0065'
when ${TABLE}.level_serial between 65 and 83 then 'bucket_0065_0083'
when ${TABLE}.level_serial between 83 and 103 then 'bucket_0083_0103'
when ${TABLE}.level_serial between 103 and 121 then 'bucket_0103_0121'
when ${TABLE}.level_serial between 121 and 133 then 'bucket_0121_0133'
when ${TABLE}.level_serial between 133 and 150 then 'bucket_0133_0150'
when ${TABLE}.level_serial between 150 and 161 then 'bucket_0150_0161'
when ${TABLE}.level_serial between 161 and 176 then 'bucket_0161_0176'
when ${TABLE}.level_serial between 176 and 188 then 'bucket_0176_0188'
when ${TABLE}.level_serial between 188 and 203 then 'bucket_0188_0203'
when ${TABLE}.level_serial between 203 and 217 then 'bucket_0203_0217'
when ${TABLE}.level_serial between 217 and 221 then 'bucket_0217_0221'
when ${TABLE}.level_serial between 221 and 234 then 'bucket_0221_0234'
when ${TABLE}.level_serial between 234 and 255 then 'bucket_0234_0255'
when ${TABLE}.level_serial between 255 and 265 then 'bucket_0255_0265'
when ${TABLE}.level_serial between 265 and 276 then 'bucket_0265_0276'
when ${TABLE}.level_serial between 276 and 280 then 'bucket_0276_0280'
when ${TABLE}.level_serial between 280 and 290 then 'bucket_0280_0290'
when ${TABLE}.level_serial between 290 and 296 then 'bucket_0290_0296'
when ${TABLE}.level_serial between 296 and 298 then 'bucket_0296_0298'
when ${TABLE}.level_serial between 298 and 309 then 'bucket_0298_0309'
when ${TABLE}.level_serial between 309 and 316 then 'bucket_0309_0316'
when ${TABLE}.level_serial between 316 and 333 then 'bucket_0316_0333'
when ${TABLE}.level_serial between 333 and 340 then 'bucket_0333_0340'
when ${TABLE}.level_serial between 340 and 342 then 'bucket_0340_0342'
when ${TABLE}.level_serial between 342 and 355 then 'bucket_0342_0355'
when ${TABLE}.level_serial between 355 and 371 then 'bucket_0355_0371'
when ${TABLE}.level_serial between 371 and 378 then 'bucket_0371_0378'

  else 'other'

  end
  "
}

constant: adhoc_target_churn_by_level_buckets_for_churn_analysis {
  value: "
  case

    when ${TABLE}.level_serial between 1 and 10 then 0.55
when ${TABLE}.level_serial between 10 and 43 then 0.229
when ${TABLE}.level_serial between 43 and 65 then 0.133
when ${TABLE}.level_serial between 65 and 83 then 0.116
when ${TABLE}.level_serial between 83 and 103 then 0.06
when ${TABLE}.level_serial between 103 and 121 then 0.076
when ${TABLE}.level_serial between 121 and 133 then 0.048
when ${TABLE}.level_serial between 133 and 150 then 0.077
when ${TABLE}.level_serial between 150 and 161 then 0.059
when ${TABLE}.level_serial between 161 and 176 then 0.047
when ${TABLE}.level_serial between 176 and 188 then 0.044
when ${TABLE}.level_serial between 188 and 203 then 0.029
when ${TABLE}.level_serial between 203 and 217 then 0.03
when ${TABLE}.level_serial between 217 and 221 then 0.024
when ${TABLE}.level_serial between 221 and 234 then 0.025
when ${TABLE}.level_serial between 234 and 255 then 0.026
when ${TABLE}.level_serial between 255 and 265 then 0.026
when ${TABLE}.level_serial between 265 and 276 then 0.02
when ${TABLE}.level_serial between 276 and 280 then 0.021
when ${TABLE}.level_serial between 280 and 290 then 0.021
when ${TABLE}.level_serial between 290 and 296 then 0.022
when ${TABLE}.level_serial between 296 and 298 then 0.015
when ${TABLE}.level_serial between 298 and 309 then 0.015
when ${TABLE}.level_serial between 309 and 316 then 0.023
when ${TABLE}.level_serial between 316 and 333 then 0.016
when ${TABLE}.level_serial between 333 and 340 then 0.016
when ${TABLE}.level_serial between 340 and 342 then 0.016
when ${TABLE}.level_serial between 342 and 355 then 0.008
when ${TABLE}.level_serial between 355 and 371 then 0
when ${TABLE}.level_serial between 371 and 378 then 0.016

  else 0

  end
  "
}

###################################################################
# Visualization JS...KEEP AT THE BOTTOM
###################################################################

visualization: {
  id: "pivoted_boxplot"
  label: "Pivoted Boxplot"
  dependencies: ["https://code.highcharts.com/highcharts.js", "https://code.highcharts.com/highcharts-more.js"]
  file: "visualizations/pivoted_boxplot.js"
}

visualization: {
  id: "2d_boxplot"
  label: "2D Boxplot"
  dependencies: ["https://code.highcharts.com/highcharts.js", "https://code.highcharts.com/highcharts-more.js"]
  file: "visualizations/2d_boxplot.js"
}

visualization: {
  id: "2d_line"
  label: "2D Line"
  dependencies: ["https://code.highcharts.com/highcharts.js"]
  file: "visualizations/2d_line.js"
}

visualization: {
  id: "2d_column"
  label: "2D Column"
  dependencies: ["https://code.highcharts.com/highcharts.js"]
  file: "visualizations/2d_column.js"
}

visualization: {
  id: "scatter"
  label: "Scatter"
  dependencies: ["https://code.highcharts.com/highcharts.js"]
  file: "visualizations/scatter.js"
}
